{"version":3,"sources":["webpack://BaseControllers/webpack/bootstrap","webpack://BaseControllers/external \"@babel/runtime/regenerator\"","webpack://BaseControllers/external \"@babel/runtime/helpers/defineProperty\"","webpack://BaseControllers/./src/enums.ts","webpack://BaseControllers/external \"@babel/runtime/helpers/asyncToGenerator\"","webpack://BaseControllers/external \"@babel/runtime/helpers/getPrototypeOf\"","webpack://BaseControllers/external \"loglevel\"","webpack://BaseControllers/external \"@babel/runtime/helpers/classCallCheck\"","webpack://BaseControllers/external \"@babel/runtime/helpers/assertThisInitialized\"","webpack://BaseControllers/external \"@babel/runtime/helpers/createClass\"","webpack://BaseControllers/./src/utils/txUtils.ts","webpack://BaseControllers/./src/utils/index.ts","webpack://BaseControllers/external \"@babel/runtime/helpers/inherits\"","webpack://BaseControllers/external \"@babel/runtime/helpers/possibleConstructorReturn\"","webpack://BaseControllers/./src/Transaction/ITransactionController.ts","webpack://BaseControllers/external \"@toruslabs/http-helpers\"","webpack://BaseControllers/./src/BaseController.ts","webpack://BaseControllers/external \"@toruslabs/openlogin-jrpc\"","webpack://BaseControllers/external \"broadcast-channel\"","webpack://BaseControllers/external \"ethereumjs-util\"","webpack://BaseControllers/external \"bignumber.js\"","webpack://BaseControllers/./src/utils/utils.ts","webpack://BaseControllers/external \"eth-rpc-errors\"","webpack://BaseControllers/external \"lodash\"","webpack://BaseControllers/./src/createSwappableProxy.ts","webpack://BaseControllers/./src/Network/INetworkController.ts","webpack://BaseControllers/./src/Embed/CommunicationMethodMiddleware.ts","webpack://BaseControllers/./src/interfaces.ts","webpack://BaseControllers/./src/Preferences/IPreferencesController.ts","webpack://BaseControllers/external \"@babel/runtime/helpers/get\"","webpack://BaseControllers/external \"@babel/runtime/helpers/toConsumableArray\"","webpack://BaseControllers/./src/Block/BaseBlockTracker.ts","webpack://BaseControllers/./src/createEventEmitterProxy.ts","webpack://BaseControllers/./src/Currency/BaseCurrencyController.ts","webpack://BaseControllers/./src/Embed/BaseEmbedController.ts","webpack://BaseControllers/./src/Embed/CommunicationWindowManager.ts","webpack://BaseControllers/./src/Keyring/BaseKeyringController.ts","webpack://BaseControllers/./src/Network/createFetchMiddleware.ts","webpack://BaseControllers/./src/Network/createLoggerMiddleware.ts","webpack://BaseControllers/./src/Network/createOriginMiddleware.ts","webpack://BaseControllers/./src/Preferences/BasePreferencesController.ts","webpack://BaseControllers/./src/Transaction/BaseTransactionStateController.ts","webpack://BaseControllers/./src/Popup/BroadcastChannelHandler.ts","webpack://BaseControllers/./src/Popup/StreamWindow.ts","webpack://BaseControllers/./src/Popup/PopupHandler.ts","webpack://BaseControllers/./src/Popup/PopupStoreChannel.ts","webpack://BaseControllers/./src/Popup/PopupWithBcHandler.ts","webpack://BaseControllers/./src/Popup/RedirectHandler.ts","webpack://BaseControllers/./src/Popup/index.ts","webpack://BaseControllers/external \"@babel/runtime/helpers/wrapNativeSuper\"","webpack://BaseControllers/external \"bowser\"","webpack://BaseControllers/./src/index.ts","webpack://BaseControllers//Users/labstorus/Documents/github/torus/controllers/node_modules/buffer/index.js","webpack://BaseControllers/(webpack)/buildin/global.js","webpack://BaseControllers//Users/labstorus/Documents/github/torus/controllers/node_modules/base64-js/index.js","webpack://BaseControllers//Users/labstorus/Documents/github/torus/controllers/node_modules/ieee754/index.js","webpack://BaseControllers//Users/labstorus/Documents/github/torus/controllers/node_modules/isarray/index.js"],"names":["FEATURES_PROVIDER_CHANGE_WINDOW","height","width","FEATURES_DEFAULT_WALLET_WINDOW","FEATURES_DEFAULT_POPUP_WINDOW","FEATURES_CONFIRM_WINDOW","POPUP_LOADED","POPUP_RESULT","SETUP_COMPLETE","ACTIVITY_ACTION_ALL","ACTIVITY_ACTION_SEND","ACTIVITY_ACTION_RECEIVE","ACTIVITY_ACTION_TOPUP","ACTIVITY_PERIOD_ALL","ACTIVITY_PERIOD_WEEK_ONE","ACTIVITY_PERIOD_MONTH_ONE","ACTIVITY_PERIOD_MONTH_SIX","ACTIVITY_STATUS_SUCCESSFUL","ACTIVITY_STATUS_UNSUCCESSFUL","ACTIVITY_STATUS_PENDING","ACTIVITY_STATUS_CANCELLED","ACTIVITY_STATUS_CANCELLING","COMMUNICATION_NOTIFICATIONS","IFRAME_STATUS","CREATE_WINDOW","CLOSE_WINDOW","USER_LOGGED_IN","USER_LOGGED_OUT","COMMUNICATION_JRPC_METHODS","LOGOUT","WALLET_INSTANCE_ID","USER_INFO","SET_PROVIDER","TOPUP","OPENED_WINDOW","CLOSED_WINDOW","GET_PROVIDER_STATE","PROVIDER_JRPC_METHODS","PROVIDER_NOTIFICATIONS","ACCOUNTS_CHANGED","CHAIN_CHANGED","UNLOCK_STATE_CHANGED","BROADCAST_CHANNELS","REDIRECT_CHANNEL","PROVIDER_CHANGE_CHANNEL","TRANSACTION_CHANNEL","WALLET_LOGOUT_CHANNEL","WALLET_SELECTED_ADDRESS_CHANNEL","WALLET_NETWORK_CHANGE_CHANNEL","WALLET_ACCOUNT_IMPORT_CHANNEL","BROADCAST_CHANNELS_MSGS","ACCOUNT_IMPORTED","SELECTED_ADDRESS_CHANGE","NETWORK_CHANGE","getTxStatusText","txStatus","TransactionStatus","TRANSACTION_TYPES","CONTRACT_INTERACTION","DEPLOY_CONTRACT","STANDARD_TRANSACTION","STANDARD_PAYMENT_TRANSACTION","TX_EVENTS","TX_WARNING","TX_ERROR","TX_FAILED","TX_CONFIRMED","TX_DROPPED","TX_EXPIRED","TX_STATUS_UPDATE","TX_UNAPPROVED","BaseController","config","state","defaultConfig","defaultState","initialState","initialConfig","internalConfig","internalState","overwrite","fullUpdate","Object","assign","key","emit","configure","update","SafeEventEmitter","intToHex","i","hex","toString","randomId","Math","random","slice","padWithZeroes","hexString","targetLength","test","Error","String","prototype","padStart","call","concatSig","v","r","s","rSig","fromSigned","sSig","vSig","bufferToInt","rStr","toUnsigned","sStr","vStr","stripHexPrefix","addHexPrefix","concat","timeout","duration","Promise","resolve","timeoutRef","window","setTimeout","clearTimeout","formatSmallNumbers","number","currency","noTilde","finalNumber","BigNumber","isBigNumber","toNumber","Number","isFinite","value","toLowerCase","parseFloat","toFixed","tilde","toUpperCase","addressSlicer","address","length","significantDigits","perc","length_","input","isZero","times","depth","gte","ceil","log10","div","shift","pow","roundedNumber","round","formatDate","inputDate","monthList","date","Date","day","getDate","month","getMonth","year","getFullYear","formatTime","time","toTimeString","transactionMatchesNetwork","transaction","chainId","hashMessage","message","bufferedMessage","Buffer","from","el","hashPersonalMessage","signMessage","privateKey","data","privKey","msgSig","ecsign","rawMsgSig","intToBuffer","getPopupFeatures","w","h","dualScreenLeft","screenLeft","undefined","screenX","dualScreenTop","screenTop","screenY","innerWidth","document","documentElement","clientWidth","screen","innerHeight","clientHeight","systemZoom","left","abs","top","features","broadcastChannelOptions","webWorkerSupport","getCustomDeviceInfo","navigator","brave","browser","UserError","handleRedirectParameters","hash","queryParameters","hashParameters","hashUrl","URL","location","origin","searchParams","forEach","instanceParameters","error","windowId","keys","JSON","parse","atob","decodeURIComponent","error_description","createSwappableProxy","initialTarget","target","setTarget","newTarget","proxy","Proxy","get","_","name","set","providerFromEngine","engine","provider","sendAsync","req","handle","res","result","send","callback","on","providerFromMiddleware","middleware","JRPCEngine","push","providerAsMiddleware","_next","end","providerRes","createChangeProviderMiddlewareMiddleware","changeProvider","createAsyncMiddleware","request","response","next","method","createTopupMiddleware","topup","createCommunicationMiddleware","providerHandlers","getUserInfo","getWalletInstanceId","logout","setIFrameStatus","handleWindowRpc","getProviderState","mergeMiddleware","createScaffoldMiddleware","LOGIN_PROVIDER","GOOGLE","FACEBOOK","REDDIT","DISCORD","TWITCH","APPLE","LINE","GITHUB","KAKAO","LINKEDIN","TWITTER","WEIBO","WECHAT","EMAIL_PASSWORDLESS","PAYMENT_PROVIDER","MOONPAY","WYRE","RAMPNETWORK","XANPOOL","MERCURYO","TRANSAK","ACTIVITY_ACTION","ACCOUNT_CATEGORY","NORMAL","THRESHOLD","IMPORTED","sec","calculateSum","accumulator","currentValue","blockTrackerEvents","BaseBlockTracker","_currentBlock","idempotencyKey","_isRunning","blockResetDuration","initialize","_onNewListener","bind","_onRemoveListener","_resetCurrentBlock","_setupInternalEvents","once","newState","latestBlock","eventName","newBlock","currentBlock","_setCurrentBlock","removeListener","_maybeStart","_getBlockTrackerEventCount","_maybeEnd","_cancelBlockResetTimeout","_start","_setupBlockResetTimeout","_end","map","listenerCount","reduce","oldBlock","_blockResetTimeout","unref","filterNoop","internalEvents","externalEventFilter","includes","getRawListeners","eventEmitter","rawListeners","createEventEmitterProxy","opts","finalOpts","eventFilter","oldTarget","eventNames","filter","handler","removeAllListeners","POLLING_INTERVAL","BaseCurrencyController","currentCurrency","conversionRate","conversionDate","nativeCurrency","pollInterval","ticker","BaseEmbedController","buttonPosition","isIFrameFullScreen","apiKey","oauthModalVisibility","loginInProgress","dappMetadata","icon","handlers","communicationMiddleware","communicationProvider","setCommunicationProvider","_communicationProviderProxy","CommunicationWindowManager","params","BaseKeyringController","wallets","keyring","find","x","hashedMessage","rawMessageSig","RETRIABLE_ERRORS","checkForHttpErrors","fetchRes","status","ethErrors","rpc","methodNotFound","internal","parseResponse","body","createFetchConfigFromReq","rpcTarget","originHttpHeaderKey","parsedUrl","payload","id","jsonrpc","originDomain","serializedPayload","stringify","fetchParams","headers","Accept","fetchUrl","href","createFetchMiddleware","maxAttempts","retryInterval","attempt","fetch","json","fetchBody","errMsg","isRetriable","some","phrase","createLoggerMiddleware","options","loggerMiddleware","log","warn","isTorusInternal","info","createOriginMiddleware","originMiddleware","DEFAULT_INTERVAL","DEFAULT_PREFERENCES","selectedCurrency","theme","locale","accountType","contacts","jwtToken","fetchedPastTx","pastTransactions","paymentTx","defaultPublicAddress","customTokens","customNfts","crashReport","userInfo","aggregateVerifier","email","profileImage","typeOfLogin","verifier","verifierId","BasePreferencesController","defaultPreferences","signAuthMessage","api","identities","selectedAddress","lastErrorMessage","lastSuccessMessage","iframeOrigin","useAPIKey","user","userPayload","default_currency","verifier_id","post","updateState","rehydrate","bowser","getParser","userAgent","specialBrowser","recordLoginPayload","os","getOSName","os_version","getOSVersion","getBrowserName","browser_version","getBrowserVersion","platform","getPlatform","type","hostname","isEnabled","getAddressState","patch","enable_crash_reporter","contact","contactId","remove","finalContacts","idToken","token","resp","tx","success","commonApiHost","publicAddress","public_address","nick","emailObject","getMessageForSigning","messageToSign","startsWith","signInPrefix","signedMessage","signed_message","preferences","currentState","cloneDeep","mergedState","Authorization","BaseTransactionStateManager","getCurrentChainId","txHistoryLimit","transactions","unapprovedTxs","currentNetworkTxsList","pickBy","unapproved","txId","txMeta","updated_at","toISOString","_setTransactionStatus","rejected","_deleteTransaction","approved","signed","submitted","dropped","expired","confirmed","error_","getTransaction","updateTransaction","failed","cancelled","omitBy","newTx","targetTransactionId","targetTransactionIds","transactionId","isFinalState","BroadcastChannelHandler","channelPrefix","URLSearchParams","search","instanceId","channel","bc","BroadcastChannel","reject","addEventListener","ev","close","postMessage","StreamWindow","communicationEngine","communicationWindowManager","closed","url","writeInterval","clearInterval","setInterval","PopupHandler","dappStorageKey","windowTimer","iClosedWindow","_setupTimer","urlHashParams","append","localWindow","open","timer","PopupStoreChannel","handleLogout","handleAccountImport","handleNetworkChange","handleSelectedAddressChange","logoutChannel","importAccountChannel","networkChangeChannel","selectedAddressChangeChannel","walletAccountImportChannel","network","PopupWithBcHandler","successExtraFn","closeListener","then","err","RedirectHandler","finalQueryParams","instanceParams","hashParams","queryParams"],"mappings":"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AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACxBA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEY;;AAEZ,aAAa,mBAAO,CAAC,EAAW;AAChC,cAAc,mBAAO,CAAC,EAAS;AAC/B,cAAc,mBAAO,CAAC,EAAS;;AAE/B;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,qBAAqB,mDAAmD;AACxE;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,mBAAmB,UAAU;AAC7B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,iBAAiB,YAAY;AAC7B;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,0BAA0B;AAC1B;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA,uCAAuC,SAAS;AAChD;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,eAAe,iBAAiB;AAChC;AACA;AACA;;AAEA;AACA;AACA,aAAa,iBAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,iBAAiB,SAAS;AAC1B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,iBAAiB,SAAS;AAC1B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,iBAAiB,SAAS;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,gDAAgD,EAAE;AAClD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA,iBAAiB,SAAS;AAC1B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC;AACzC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA,wBAAwB,eAAe;AACvC;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,wBAAwB,QAAQ;AAChC;AACA,qBAAqB,eAAe;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,iBAAiB,YAAY;AAC7B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA,SAAS;AACT;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,qBAAqB,SAAS;AAC9B;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,qBAAqB,SAAS;AAC9B;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA,qBAAqB,SAAS;AAC9B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,iBAAiB,kBAAkB;AACnC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,mBAAmB,cAAc;AACjC;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,uDAAuD,OAAO;AAC9D;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA,uDAAuD,OAAO;AAC9D;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,kBAAkB;AAClB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,qBAAqB,QAAQ;AAC7B;AACA;AACA,GAAG;AACH;AACA,eAAe,SAAS;AACxB;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA,mBAAmB,SAAS;AAC5B;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,eAAe,iBAAiB;AAChC;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,iBAAiB,YAAY;AAC7B;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,iBAAiB,gBAAgB;AACjC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,iBAAiB,gBAAgB;AACjC;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,iBAAiB,YAAY;AAC7B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;;;;;;AC5vDA;;AAEA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;;AAEA;AACA;AACA,4CAA4C;;AAE5C;;;;;;;;ACnBY;;AAEZ;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,kCAAkC,SAAS;AAC3C;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,aAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,qBAAqB,SAAS;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,0CAA0C,UAAU;AACpD;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;;;;;ACrJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,QAAQ,WAAW;;AAEnB;AACA;AACA;AACA,QAAQ,WAAW;;AAEnB;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA,QAAQ,WAAW;;AAEnB;AACA;AACA,QAAQ,UAAU;;AAElB;AACA;;;;;;;ACpFA,iBAAiB;;AAEjB;AACA;AACA","file":"baseControllers.cjs.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 48);\n","module.exports = require(\"@babel/runtime/regenerator\");","module.exports = require(\"@babel/runtime/helpers/defineProperty\");","export const FEATURES_PROVIDER_CHANGE_WINDOW = { height: 660, width: 375 };\nexport const FEATURES_DEFAULT_WALLET_WINDOW = { height: 740, width: 1315 };\nexport const FEATURES_DEFAULT_POPUP_WINDOW = { height: 700, width: 1200 };\nexport const FEATURES_CONFIRM_WINDOW = { height: 700, width: 450 };\n\nexport const POPUP_LOADED = \"popup_loaded\";\nexport const POPUP_RESULT = \"popup_result\";\n\nexport const SETUP_COMPLETE = \"setup_complete\";\n\nexport const ACTIVITY_ACTION_ALL = \"walletActivity.allTransactions\";\nexport const ACTIVITY_ACTION_SEND = \"walletActivity.send\";\nexport const ACTIVITY_ACTION_RECEIVE = \"walletActivity.receive\";\nexport const ACTIVITY_ACTION_TOPUP = \"walletActivity.topup\";\n\nexport const ACTIVITY_PERIOD_ALL = \"walletActivity.all\";\nexport const ACTIVITY_PERIOD_WEEK_ONE = \"walletActivity.lastOneWeek\";\nexport const ACTIVITY_PERIOD_MONTH_ONE = \"walletActivity.lastOneMonth\";\nexport const ACTIVITY_PERIOD_MONTH_SIX = \"walletActivity.lastSixMonts\";\n\nexport const ACTIVITY_STATUS_SUCCESSFUL = \"walletActivity.successful\";\nexport const ACTIVITY_STATUS_UNSUCCESSFUL = \"walletActivity.unsuccessful\";\nexport const ACTIVITY_STATUS_PENDING = \"walletActivity.pending\";\nexport const ACTIVITY_STATUS_CANCELLED = \"walletActivity.cancelled\";\nexport const ACTIVITY_STATUS_CANCELLING = \"walletActivity.cancelling\";\n\nexport const COMMUNICATION_NOTIFICATIONS = {\n  IFRAME_STATUS: \"iframe_status\",\n\n  // Tell embed to create the window\n  CREATE_WINDOW: \"create_window\",\n  // Tell embed to close the window\n  CLOSE_WINDOW: \"close_window\",\n\n  USER_LOGGED_IN: \"user_logged_in\",\n  USER_LOGGED_OUT: \"user_logged_out\",\n};\n\nexport const COMMUNICATION_JRPC_METHODS = {\n  LOGOUT: \"logout\",\n  WALLET_INSTANCE_ID: \"wallet_instance_id\",\n  USER_INFO: \"user_info\",\n  SET_PROVIDER: \"set_provider\",\n  TOPUP: \"topup\",\n  IFRAME_STATUS: \"iframe_status\",\n  // embed has opened the window as requested\n  OPENED_WINDOW: \"opened_window\",\n  // user has closed the window from embed's side\n  CLOSED_WINDOW: \"closed_window\",\n  GET_PROVIDER_STATE: \"get_provider_state\",\n};\n\nexport const PROVIDER_JRPC_METHODS = {\n  GET_PROVIDER_STATE: \"wallet_get_provider_state\",\n};\n\nexport const PROVIDER_NOTIFICATIONS = {\n  ACCOUNTS_CHANGED: \"wallet_accounts_changed\",\n  CHAIN_CHANGED: \"wallet_chain_changed\",\n  UNLOCK_STATE_CHANGED: \"wallet_unlock_state_changed\",\n};\n\nexport const BROADCAST_CHANNELS = {\n  REDIRECT_CHANNEL: \"redirect_channel\",\n  PROVIDER_CHANGE_CHANNEL: \"torus_provider_change_channel\",\n  TRANSACTION_CHANNEL: \"torus_channel\",\n  WALLET_LOGOUT_CHANNEL: \"wallet_logout_channel\",\n  WALLET_SELECTED_ADDRESS_CHANNEL: \"wallet_selected_address_channel\",\n  WALLET_NETWORK_CHANGE_CHANNEL: \"wallet_network_change_channel\",\n  WALLET_ACCOUNT_IMPORT_CHANNEL: \"wallet_account_import_channel\",\n};\nexport const BROADCAST_CHANNELS_MSGS = {\n  LOGOUT: \"logout\",\n  ACCOUNT_IMPORTED: \"account_imported\",\n  SELECTED_ADDRESS_CHANGE: \"selected_address_change\",\n  NETWORK_CHANGE: \"network_change\",\n};\n\nexport type BROADCAST_CHANNELS_MSGS_TYPE = typeof BROADCAST_CHANNELS_MSGS[keyof typeof BROADCAST_CHANNELS_MSGS];\n","module.exports = require(\"@babel/runtime/helpers/asyncToGenerator\");","module.exports = require(\"@babel/runtime/helpers/getPrototypeOf\");","module.exports = require(\"loglevel\");","module.exports = require(\"@babel/runtime/helpers/classCallCheck\");","module.exports = require(\"@babel/runtime/helpers/assertThisInitialized\");","module.exports = require(\"@babel/runtime/helpers/createClass\");","import { ACTIVITY_STATUS_CANCELLED, ACTIVITY_STATUS_PENDING, ACTIVITY_STATUS_SUCCESSFUL, ACTIVITY_STATUS_UNSUCCESSFUL } from \"../enums\";\nimport { TransactionStatus } from \"../Transaction/ITransactionController\";\n\nexport const getTxStatusText = (txStatus: TransactionStatus): string => {\n  switch (txStatus) {\n    case \"rejected\":\n    case \"unapproved\":\n    case \"failed\":\n      return ACTIVITY_STATUS_UNSUCCESSFUL;\n    case \"confirmed\":\n      return ACTIVITY_STATUS_SUCCESSFUL;\n    case \"submitted\":\n      return ACTIVITY_STATUS_PENDING;\n    case \"cancelled\":\n      return ACTIVITY_STATUS_CANCELLED;\n    default:\n      return \"\";\n  }\n};\n","export * from \"./txUtils\";\nexport * from \"./utils\";\n","module.exports = require(\"@babel/runtime/helpers/inherits\");","module.exports = require(\"@babel/runtime/helpers/possibleConstructorReturn\");","import { JRPCRequest } from \"@toruslabs/openlogin-jrpc\";\n\nimport { BaseConfig, BaseState } from \"../interfaces\";\n\n/**\n * The status of the transaction. Each status represents the state of the transaction internally\n * in the wallet. Some of these correspond with the state of the transaction on the network, but\n * some are wallet-specific.\n */\n\nexport enum TransactionStatus {\n  approved = \"approved\",\n  cancelled = \"cancelled\",\n  confirmed = \"confirmed\",\n  failed = \"failed\",\n  finalized = \"finalized\",\n  processed = \"processed\",\n  rejected = \"rejected\",\n  signed = \"signed\",\n  submitted = \"submitted\",\n  unapproved = \"unapproved\",\n  dropped = \"dropped\",\n  expired = \"expired\",\n}\n\nexport const TRANSACTION_TYPES = {\n  CONTRACT_INTERACTION: \"contractInteraction\",\n  DEPLOY_CONTRACT: \"contractDeployment\",\n  STANDARD_TRANSACTION: \"transaction\",\n  STANDARD_PAYMENT_TRANSACTION: \"payment_transaction\", // specific to chains like solana and casper\n};\n\nexport type TRANSACTION_TYPE = typeof TRANSACTION_TYPES[keyof typeof TRANSACTION_TYPES];\n\nexport const TX_EVENTS = {\n  TX_WARNING: \"tx:warning\",\n  TX_ERROR: \"tx:error\",\n  TX_FAILED: \"tx:failed\",\n  TX_CONFIRMED: \"tx:confirmed\",\n  TX_DROPPED: \"tx:dropped\",\n  TX_EXPIRED: \"tx:expired\",\n  TX_STATUS_UPDATE: \"tx:status_update\",\n  TX_UNAPPROVED: \"tx:unapproved\",\n};\n\nexport interface TransactionMeta<T> {\n  id: string;\n  transaction: T;\n  transactionType: TRANSACTION_TYPE;\n  dappSuggestedTransaction: Partial<T>;\n  chainId: string;\n  origin: string;\n  time: number;\n  status: TransactionStatus;\n  updated_at?: string; // iso date string\n  transactionHash?: string;\n  rawTransaction?: string;\n  txReceipt?: unknown;\n  error?: Error;\n  warning?: {\n    error?: string;\n    message?: string;\n  };\n}\n\nexport type BASE_TX_EVENT_TYPE = {\n  txId: string;\n};\n\nexport type TX_ERROR_EVENT_TYPE = BASE_TX_EVENT_TYPE & {\n  error: Error;\n};\n\nexport type TX_FAILED_EVENT_TYPE = BASE_TX_EVENT_TYPE & {\n  error: Error;\n};\n\nexport type TX_EXPIRED_EVENT_TYPE = BASE_TX_EVENT_TYPE;\n\nexport type TX_WARNING_EVENT_TYPE<T> = BASE_TX_EVENT_TYPE & {\n  txMeta: TransactionMeta<T>;\n};\n\nexport type TX_CONFIRMED_EVENT_TYPE = BASE_TX_EVENT_TYPE & {\n  txReceipt: unknown;\n};\n\nexport type TX_DROPPED_EVENT_TYPE = BASE_TX_EVENT_TYPE;\n\nexport type TX_STATUS_UPDATE_EVENT_TYPE = BASE_TX_EVENT_TYPE & {\n  status: TransactionStatus;\n};\n\nexport type TX_FINISHED_EVENT_TYPE<T> = BASE_TX_EVENT_TYPE & {\n  txMeta: TransactionMeta<T>;\n};\n\n/**\n * Transaction controller configuration\n */\nexport interface TransactionConfig extends BaseConfig {\n  txHistoryLimit: number;\n}\n\n/**\n * Transaction controller state\n */\nexport interface TransactionState<T> extends BaseState {\n  /**\n   * Transactions by key (id) value (TxMeta)\n   */\n  transactions: Record<string, TransactionMeta<T>>; // all transactions (unapprroved and all others)\n  unapprovedTxs?: Record<string, TransactionMeta<T>>; // only unapproved\n  currentNetworkTxsList?: TransactionMeta<T>[];\n}\n\n/**\n * Result\n *\n * result - Promise resolving to a new transaction hash\n * transactionMeta - Meta information about this new transaction\n */\nexport interface Result<T> {\n  result: Promise<string>;\n  transactionMeta: TransactionMeta<T>;\n}\n\nexport interface ITransactionController<T> {\n  /**\n   * Add a new unapproved transaction to state.\n   * @param transaction - Transaction object to add\n   * @returns - Object containing a promise resolving to the transaction hash if approved\n   */\n  addTransaction(transaction: T, req: JRPCRequest<T & { windowId?: string }> & { origin: string }): Promise<Result<T>>;\n\n  /**\n   * Approves a transaction and updates it's status in state.\n   *\n   * @param transactionID - ID of the transaction to approve\n   * @returns - Promise resolving when this operation completes\n   */\n  approveTransaction(transactionID: string): Promise<void>;\n\n  /**\n   * Cancels a transaction based on its ID by setting its status to \"rejected\"\n   *\n   * @param transactionID - ID of the transaction to cancel\n   */\n  cancelTransaction?(transactionID: string): Promise<void>;\n}\n\nexport interface ITransactionStateManager<T> {\n  addTransactionToState(txMeta: TransactionMeta<T>): TransactionMeta<T>;\n\n  wipeTransactions(address: string): void;\n\n  getTransactions(args: {\n    searchCriteria?: Record<string, (val: unknown) => boolean> | Record<string, unknown>;\n    initialList?: TransactionMeta<T>[];\n    filterToCurrentNetwork?: boolean;\n  }): TransactionMeta<T>[];\n  getApprovedTransactions(address?: string): TransactionMeta<T>[];\n  getPendingTransactions(address?: string): TransactionMeta<T>[];\n  getConfirmedTransactions(address?: string): TransactionMeta<T>[];\n}\n","module.exports = require(\"@toruslabs/http-helpers\");","import { SafeEventEmitter } from \"@toruslabs/openlogin-jrpc\";\n\nimport { BaseConfig, BaseState, IController } from \"./interfaces\";\n\n/**\n * Controller class that provides configuration, state management, and subscriptions\n */\nclass BaseController<C extends BaseConfig, S extends BaseState> extends SafeEventEmitter implements IController<C, S> {\n  /**\n   * Default options used to configure this controller\n   */\n  defaultConfig: C = {} as C;\n\n  /**\n   * Default state set on this controller\n   */\n  defaultState: S = {} as S;\n\n  /**\n   * Determines if listeners are notified of state changes\n   */\n  disabled = false;\n\n  /**\n   * Name of this controller used during composition\n   */\n  name = \"BaseController\";\n\n  private readonly initialConfig: C;\n\n  private readonly initialState: S;\n\n  private internalConfig: C = this.defaultConfig;\n\n  private internalState: S = this.defaultState;\n\n  /**\n   * Creates a BaseController instance. Both initial state and initial\n   * configuration options are merged with defaults upon initialization.\n   *\n   * @param config - Initial options used to configure this controller\n   * @param state - Initial state to set on this controller\n   */\n  constructor({ config = {} as C, state = {} as S }: { config?: Partial<C>; state?: Partial<S> }) {\n    super();\n    // Use assign since generics can't be spread: https://git.io/vpRhY\n    this.initialState = state as S;\n    this.initialConfig = config as C;\n  }\n\n  /**\n   * Retrieves current controller configuration options\n   *\n   * @returns - Current configuration\n   */\n  get config(): C {\n    return this.internalConfig;\n  }\n\n  /**\n   * Retrieves current controller state\n   *\n   * @returns - Current state\n   */\n  get state(): S {\n    return this.internalState;\n  }\n\n  /**\n   * Updates controller configuration\n   *\n   * @param config - New configuration options\n   * @param overwrite - Overwrite config instead of merging\n   * @param fullUpdate - Boolean that defines if the update is partial or not\n   */\n  configure(config: Partial<C>, overwrite = false, fullUpdate = true): void {\n    if (fullUpdate) {\n      this.internalConfig = overwrite ? (config as C) : Object.assign(this.internalConfig, config);\n\n      for (const key in this.internalConfig) {\n        if (typeof this.internalConfig[key] !== \"undefined\") {\n          this[key as string] = this.internalConfig[key];\n        }\n      }\n    } else {\n      for (const key in config) {\n        /* istanbul ignore else */\n        if (typeof this.internalConfig[key] !== \"undefined\") {\n          this.internalConfig[key] = config[key];\n          this[key as string] = config[key];\n        }\n      }\n    }\n  }\n\n  /**\n   * Updates controller state\n   *\n   * @param state - New state\n   * @param overwrite - Overwrite state instead of merging\n   */\n  update(state: Partial<S>, overwrite = false): void {\n    this.internalState = overwrite ? { ...(state as S) } : { ...this.internalState, ...state };\n    this.emit(\"store\", this.internalState);\n  }\n\n  /**\n   * Enables the controller. This sets each config option as a member\n   * variable on this instance and triggers any defined setters. This\n   * also sets initial state and triggers any listeners.\n   *\n   * @returns - This controller instance\n   */\n  protected initialize(): this {\n    this.internalState = this.defaultState;\n    this.internalConfig = this.defaultConfig;\n    this.configure(this.initialConfig);\n    this.update(this.initialState);\n    return this;\n  }\n}\n\nexport default BaseController;\n","module.exports = require(\"@toruslabs/openlogin-jrpc\");","module.exports = require(\"broadcast-channel\");","module.exports = require(\"ethereumjs-util\");","module.exports = require(\"bignumber.js\");","import { BigNumber } from \"bignumber.js\";\nimport { addHexPrefix, bufferToInt, ecsign, fromSigned, hashPersonalMessage, intToBuffer, stripHexPrefix, toUnsigned } from \"ethereumjs-util\";\n\nimport { TransactionMeta } from \"../Transaction/ITransactionController\";\n\n/**\n * General utility functions\n */\n\nexport function intToHex(i: number): string {\n  const hex = i.toString(16);\n  return `0x${hex}`;\n}\n\n/**\n * Returns a random number. Don't use for cryptographic purposes.\n * @returns a random number\n */\nexport const randomId = (): string => Math.random().toString(36).slice(2);\n\n/**\n * Pads the front of the given hex string with zeroes until it reaches the\n * target length. If the input string is already longer than or equal to the\n * target length, it is returned unmodified.\n *\n * If the input string is \"0x\"-prefixed or not a hex string, an error will be\n * thrown.\n *\n * @param hexString - The hexadecimal string to pad with zeroes.\n * @param targetLength - The target length of the hexadecimal string.\n * @returns The input string front-padded with zeroes, or the original string\n * if it was already greater than or equal to to the target length.\n */\nexport function padWithZeroes(hexString: string, targetLength: number): string {\n  if (hexString !== \"\" && !/^[a-f0-9]+$/iu.test(hexString)) {\n    throw new Error(`Expected an unprefixed hex string. Received: ${hexString}`);\n  }\n\n  if (targetLength < 0) {\n    throw new Error(`Expected a non-negative integer target length. Received: ${targetLength}`);\n  }\n\n  return String.prototype.padStart.call(hexString, targetLength, \"0\");\n}\n/**\n * Concatenate an extended ECDSA signature into a hex string.\n *\n * @param v - The 'v' portion of the signature.\n * @param r - The 'r' portion of the signature.\n * @param s - The 's' portion of the signature.\n * @returns The concatenated ECDSA signature.\n */\nexport function concatSig(v: Buffer, r: Buffer, s: Buffer): string {\n  const rSig = fromSigned(r);\n  const sSig = fromSigned(s);\n  const vSig = bufferToInt(v);\n  const rStr = padWithZeroes(toUnsigned(rSig).toString(\"hex\"), 64);\n  const sStr = padWithZeroes(toUnsigned(sSig).toString(\"hex\"), 64);\n  const vStr = stripHexPrefix(intToHex(vSig));\n  return addHexPrefix(rStr.concat(sStr, vStr));\n}\n\nexport function timeout(duration: number): Promise<void> {\n  return new Promise((resolve) => {\n    const timeoutRef = window.setTimeout(() => {\n      resolve();\n      window.clearTimeout(timeoutRef);\n    }, duration);\n  });\n}\n\n/**\n * Text/number formatting utilities\n */\nexport const formatSmallNumbers = (number: number, currency = \"usd\", noTilde = false): string => {\n  const finalNumber = BigNumber.isBigNumber(number) ? number.toNumber() : number;\n  if (!Number.isFinite(finalNumber)) return \"\";\n  const value = currency.toLowerCase() === \"usd\" ? parseFloat(Number(finalNumber).toFixed(2)) : parseFloat(Number(finalNumber).toFixed(5));\n  const tilde = value > 0 ? \"~ \" : \"\";\n  return `${currency.toLowerCase() === \"usd\" || noTilde ? \"\" : tilde}${Number(value)} ${currency.toUpperCase()}`;\n};\n\nexport const addressSlicer = (address: string): string => {\n  if (address.length < 11) {\n    return address;\n  }\n  if (typeof address !== \"string\") return \"\";\n  return `${address.slice(0, 5)}...${address.slice(-5)}`;\n};\n\nexport const significantDigits = (number: number | BigNumber, perc = false, length_ = 2): number | BigNumber => {\n  let input = !BigNumber.isBigNumber(number) ? new BigNumber(number) : number;\n  if (input.isZero()) return input;\n  if (perc) {\n    input = input.times(new BigNumber(100));\n  }\n  let depth;\n  if (input.gte(new BigNumber(1))) {\n    depth = length_;\n  } else {\n    depth = length_ - 1 + Math.ceil(Math.log10(new BigNumber(\"1\").div(input).toNumber()));\n  }\n  const shift = new BigNumber(10).pow(new BigNumber(depth));\n  const roundedNumber = Math.round(shift.times(input).toNumber()) / shift.toNumber();\n  return roundedNumber;\n};\nexport const formatDate = (inputDate: string): string => {\n  const monthList = [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"];\n  const date = new Date(inputDate);\n  const day = date.getDate();\n  const month = monthList[date.getMonth()];\n  const year = date.getFullYear();\n  return `${day} ${month} ${year}`;\n};\n\nexport const formatTime = (time: string): string => {\n  return new Date(time).toTimeString().slice(0, 8);\n};\n\n/**\n * Network utilities\n */\nexport const transactionMatchesNetwork = <T>(transaction: TransactionMeta<T>, chainId: string): boolean => {\n  if (typeof transaction.chainId !== \"undefined\") {\n    return transaction.chainId === chainId;\n  }\n  return false;\n};\n\n/**\n * Signing utils\n */\nexport const hashMessage = (message: string): Buffer => {\n  const bufferedMessage = Buffer.from(message, \"utf8\");\n  const el = hashPersonalMessage(bufferedMessage);\n  return el;\n};\n\nexport const signMessage = (privateKey: string, data: string): string => {\n  const privKey = Buffer.from(privateKey, \"hex\");\n  const message = stripHexPrefix(data);\n  const msgSig = ecsign(Buffer.from(message, \"hex\"), privKey);\n  const rawMsgSig = concatSig(intToBuffer(msgSig.v), msgSig.r, msgSig.s);\n  return rawMsgSig;\n};\n\n/**\n * popup handler utils\n */\nexport function getPopupFeatures({ width: w, height: h }: { width: number; height: number }): string {\n  // Fixes dual-screen position                             Most browsers      Firefox\n  const dualScreenLeft = window.screenLeft !== undefined ? window.screenLeft : window.screenX;\n  const dualScreenTop = window.screenTop !== undefined ? window.screenTop : window.screenY;\n\n  const width = window.innerWidth\n    ? window.innerWidth\n    : document.documentElement.clientWidth\n    ? document.documentElement.clientWidth\n    : window.screen.width;\n\n  const height = window.innerHeight\n    ? window.innerHeight\n    : document.documentElement.clientHeight\n    ? document.documentElement.clientHeight\n    : window.screen.height;\n\n  const systemZoom = 1; // No reliable estimate\n\n  const left = Math.abs((width - w) / 2 / systemZoom + dualScreenLeft);\n  const top = Math.abs((height - h) / 2 / systemZoom + dualScreenTop);\n  const features = `titlebar=0,toolbar=0,status=0,location=0,menubar=0,height=${h / systemZoom},width=${w / systemZoom},top=${top},left=${left}`;\n  return features;\n}\n\nexport const broadcastChannelOptions = {\n  // type: 'localstorage', // (optional) enforce a type, oneOf['native', 'idb', 'localstorage', 'node']\n  webWorkerSupport: false, // (optional) set this to false if you know that your channel will never be used in a WebWorker (increases performance)\n};\n\nexport function getCustomDeviceInfo(): Record<string, string> | undefined {\n  if ((navigator as any)?.brave) {\n    return {\n      browser: \"Brave\",\n    };\n  }\n}\nexport class UserError extends Error {}\n\nexport const handleRedirectParameters = (\n  hash: string,\n  queryParameters: Record<string, string>\n): { error: string; instanceParameters: Record<string, string>; hashParameters: Record<string, string> } => {\n  const hashParameters: Record<string, string> = {};\n  const hashUrl = new URL(`${window.location.origin}/?${hash.slice(1)}`);\n  hashUrl.searchParams.forEach((value, key) => {\n    hashParameters[key] = value;\n  });\n  let instanceParameters = {};\n  let error = \"\";\n  if (!queryParameters.windowId) {\n    if (Object.keys(hashParameters).length > 0 && hashParameters.state) {\n      instanceParameters = JSON.parse(window.atob(decodeURIComponent(decodeURIComponent(hashParameters.state)))) || {};\n      error = hashParameters.error_description || hashParameters.error || error;\n    } else if (Object.keys(queryParameters).length > 0 && queryParameters.state) {\n      instanceParameters = JSON.parse(window.atob(decodeURIComponent(decodeURIComponent(queryParameters.state)))) || {};\n      if (queryParameters.error) error = queryParameters.error;\n    }\n  }\n  return { error, instanceParameters, hashParameters };\n};\n","module.exports = require(\"eth-rpc-errors\");","module.exports = require(\"lodash\");","export default function createSwappableProxy<T extends object>(initialTarget: T): T {\n  let target = initialTarget;\n\n  let setTarget = (newTarget: T) => {\n    target = newTarget;\n  };\n\n  const proxy = new Proxy<T>({} as T, {\n    get: (_, name) => {\n      // override `setTarget` access\n      if (name === \"setTarget\") return setTarget;\n      return target[name];\n    },\n    set: (_, name, value) => {\n      // allow `setTarget` overrides\n      if (name === \"setTarget\") {\n        setTarget = value;\n        return true;\n      }\n      target[name] = value;\n      return true;\n    },\n  });\n\n  return proxy;\n}\n","import { JRPCEngine, JRPCMiddleware, JRPCRequest, JRPCResponse, SafeEventEmitter } from \"@toruslabs/openlogin-jrpc\";\n\nimport { BaseConfig, BaseState, IController } from \"../interfaces\";\n\nexport interface ProviderConfig {\n  /**\n   * Block explorer url for the chain\n   * @example https://ropsten.etherscan.io\n   */\n  blockExplorerUrl: string;\n  /**\n   * Logo url for the base token\n   */\n  logo: string;\n  /**\n   * Name for ticker\n   * @example 'Binance Token', 'Ethereum', 'Matic Network Token'\n   */\n  tickerName: string;\n  /**\n   * Symbol for ticker\n   * @example BNB, ETH\n   */\n  ticker: string;\n  /**\n   * RPC target Url for the chain\n   * @example https://ropsten.infura.io/v3/YOUR_API_KEY\n   */\n  rpcTarget: string;\n  /**\n   * Chain Id parameter(hex with 0x prefix) for the network. Mandatory for all networks. (assign one with a map to network identifier for platforms)\n   * @example 0x1 for mainnet, 'loading' if not connected to anything yet or connection fails\n   * @defaultValue 'loading'\n   */\n  chainId: string;\n  /**\n   * Display name for the network\n   */\n  displayName: string;\n}\n\n/**\n * Custom network properties\n * @example isEIP1559Compatible: true etc.\n */\nexport interface NetworkProperties {\n  [key: string]: number | string | boolean;\n}\n\n/**\n *\n */\nexport interface NetworkState extends BaseState {\n  /**\n   * Chain Id for the current network\n   */\n  chainId: string;\n  providerConfig: ProviderConfig;\n  properties: NetworkProperties;\n}\n\nexport interface NetworkConfig extends BaseConfig {\n  providerConfig: ProviderConfig;\n}\n\nexport interface INetworkController<C, S> extends IController<C, S> {\n  /**\n   * Gets the chainId of the network\n   */\n  getNetworkIdentifier(): string;\n\n  /**\n   * Sets provider for the current network controller\n   * @param providerConfig - Provider config object\n   */\n  setProviderConfig(providerConfig: ProviderConfig): void;\n  /**\n   * Connects to the rpcUrl for the current selected provider\n   */\n  lookupNetwork(): Promise<void>;\n}\n\nexport type BlockData = string | string[];\n\nexport type Block = Record<string, BlockData>;\n\nexport type SendAsyncCallBack = (err: Error, providerRes: JRPCResponse<Block>) => void;\n\nexport type SendCallBack<U> = (err: any, providerRes: U) => void;\n\nexport type Payload = Partial<JRPCRequest<string[]>>;\nexport interface SafeEventEmitterProvider extends SafeEventEmitter {\n  sendAsync: <T, U>(req: JRPCRequest<T>) => Promise<U>;\n  send: <T, U>(req: JRPCRequest<T>, callback: SendCallBack<U>) => void;\n}\n\nexport interface ExtendedJsonRpcRequest<T> extends JRPCRequest<T> {\n  skipCache?: boolean;\n}\n\nexport function providerFromEngine(engine: JRPCEngine): SafeEventEmitterProvider {\n  const provider: SafeEventEmitterProvider = new SafeEventEmitter() as SafeEventEmitterProvider;\n  // handle both rpc send methods\n  provider.sendAsync = async <T, U>(req: JRPCRequest<T>) => {\n    const res = await engine.handle(req);\n    if (res.error) {\n      throw new Error(res.error);\n    }\n    return res.result as U;\n  };\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  provider.send = <T, U>(req: JRPCRequest<T>, callback: (error: any, providerRes: U) => void) => {\n    if (typeof callback !== \"function\") {\n      throw new Error('Must provide callback to \"send\" method.');\n    }\n    engine.handle(req, callback);\n  };\n  // forward notifications\n  if (engine.on) {\n    engine.on(\"notification\", (message: string) => {\n      provider.emit(\"data\", null, message);\n    });\n  }\n  return provider;\n}\n\nexport function providerFromMiddleware(middleware: JRPCMiddleware<string[], unknown>): SafeEventEmitterProvider {\n  const engine = new JRPCEngine();\n  engine.push(middleware);\n  const provider: SafeEventEmitterProvider = providerFromEngine(engine);\n  return provider;\n}\n\nexport function providerAsMiddleware(provider: SafeEventEmitterProvider): JRPCMiddleware<unknown, unknown> {\n  return async (req, res, _next, end) => {\n    // send request to provider\n    try {\n      const providerRes: unknown = await provider.sendAsync<unknown, unknown>(req);\n      res.result = providerRes;\n      return end();\n    } catch (error) {\n      return end(error.message);\n    }\n  };\n}\n","import { createAsyncMiddleware, createScaffoldMiddleware, JRPCMiddleware, mergeMiddleware } from \"@toruslabs/openlogin-jrpc\";\n\nimport { COMMUNICATION_JRPC_METHODS } from \"../enums\";\nimport type { ProviderConfig } from \"../Network/INetworkController\";\nimport { ICommunicationProviderHandlers, TopupInput } from \"./IEmbedController\";\n\nexport function createChangeProviderMiddlewareMiddleware({\n  changeProvider,\n}: {\n  changeProvider: ICommunicationProviderHandlers[\"changeProvider\"];\n}): JRPCMiddleware<unknown, unknown> {\n  return createAsyncMiddleware<ProviderConfig & { windowId: string }, boolean>(async (request, response, next) => {\n    const { method } = request;\n    if (method !== COMMUNICATION_JRPC_METHODS.SET_PROVIDER) return next();\n\n    if (!changeProvider) throw new Error(\"CommunicationMiddleware - opts.changeProvider not provided\");\n    response.result = await changeProvider(request);\n  });\n}\n\nexport function createTopupMiddleware({ topup }: { topup: ICommunicationProviderHandlers[\"topup\"] }): JRPCMiddleware<unknown, unknown> {\n  return createAsyncMiddleware<TopupInput, boolean>(async (request, response, next) => {\n    const { method } = request;\n    if (method !== COMMUNICATION_JRPC_METHODS.TOPUP) return next();\n\n    if (!topup) throw new Error(\"CommunicationMiddleware - opts.topup not provided\");\n    response.result = await topup(request);\n  });\n}\n\nexport function createCommunicationMiddleware(providerHandlers: ICommunicationProviderHandlers): JRPCMiddleware<unknown, unknown> {\n  const { getUserInfo, getWalletInstanceId, topup, logout, changeProvider, setIFrameStatus, handleWindowRpc, getProviderState } = providerHandlers;\n  return mergeMiddleware([\n    createChangeProviderMiddlewareMiddleware({ changeProvider }),\n    createTopupMiddleware({ topup }),\n    createScaffoldMiddleware({\n      [COMMUNICATION_JRPC_METHODS.LOGOUT]: logout,\n      [COMMUNICATION_JRPC_METHODS.WALLET_INSTANCE_ID]: getWalletInstanceId,\n      [COMMUNICATION_JRPC_METHODS.USER_INFO]: getUserInfo,\n      [COMMUNICATION_JRPC_METHODS.IFRAME_STATUS]: setIFrameStatus,\n      // Do this in the orchestrator because communicationWindowManager needs to be passed into PopupHandlers\n      [COMMUNICATION_JRPC_METHODS.OPENED_WINDOW]: handleWindowRpc,\n      [COMMUNICATION_JRPC_METHODS.CLOSED_WINDOW]: handleWindowRpc,\n      [COMMUNICATION_JRPC_METHODS.GET_PROVIDER_STATE]: getProviderState,\n    }),\n  ]);\n}\n","import type { EventEmitter } from \"events\";\n\nimport { THEME } from \"./Preferences/IPreferencesController\";\n\n/**\n * State change callbacks\n */\nexport type Listener<T> = (state: T) => void;\n\n/**\n * Base controller configuration\n */\nexport interface BaseConfig {\n  /**\n   *  Determines if this controller is enabled\n   */\n  disabled?: boolean;\n}\n\n/**\n * Base state representation\n */\nexport interface BaseState {\n  /**\n   * Unique name for this controller\n   */\n  name?: string;\n}\n\nexport interface IController<C, S> {\n  defaultConfig: C;\n\n  defaultState: S;\n\n  name: string;\n\n  get state(): S;\n\n  get config(): C;\n\n  update(state: Partial<S>, overwrite?: boolean): void;\n\n  configure(config: Partial<C>, overwrite?: boolean, fullUpdate?: boolean): void;\n}\n\nexport type generic<T> = () => T;\n\nexport type EmailObject = {\n  link: string;\n  from_name: string;\n  to_email: string;\n  total_amount: string;\n  token: string;\n  currency: string;\n  currency_amount: number;\n};\n\nexport interface IWindow {\n  closed: boolean;\n  open(): IWindow | Promise<IWindow>;\n  close(): void;\n}\n\nexport interface IStreamWindow extends IWindow, EventEmitter {}\n\nexport const LOGIN_PROVIDER = {\n  GOOGLE: \"google\",\n  FACEBOOK: \"facebook\",\n  REDDIT: \"reddit\",\n  DISCORD: \"discord\",\n  TWITCH: \"twitch\",\n  APPLE: \"apple\",\n  LINE: \"line\",\n  GITHUB: \"github\",\n  KAKAO: \"kakao\",\n  LINKEDIN: \"linkedin\",\n  TWITTER: \"twitter\",\n  WEIBO: \"weibo\",\n  WECHAT: \"wechat\",\n  EMAIL_PASSWORDLESS: \"email_passwordless\",\n};\n/**\n * {@label loginProviderType}\n */\nexport type LOGIN_PROVIDER_TYPE = typeof LOGIN_PROVIDER[keyof typeof LOGIN_PROVIDER];\n\nexport interface UserInfo {\n  /**\n   * Email of the logged in user\n   */\n  email: string;\n  /**\n   * Full name of the logged in user\n   */\n  name: string;\n  /**\n   * Profile image of the logged in user\n   */\n  profileImage: string;\n  /**\n   * aggregate verifier of the logged in user (google, facebook etc)\n   */\n  aggregateVerifier?: string;\n  /**\n   * verifier of the logged in user (google, facebook etc)\n   */\n  verifier: string;\n  /**\n   * Verifier Id of the logged in user\n   *\n   * email for google,\n   * id for facebook,\n   * username for reddit,\n   * id for twitch,\n   * id for discord\n   */\n  verifierId: string;\n\n  typeOfLogin: LOGIN_PROVIDER_TYPE;\n}\n\nexport interface PaymentParams {\n  /**\n   * Address to send the funds to\n   */\n  selectedAddress?: string;\n  /**\n   * Default fiat currency for the user to make the payment in\n   */\n  selectedCurrency?: string;\n  /**\n   * Amount to buy in the selectedCurrency\n   */\n  fiatValue?: number;\n  /**\n   * Cryptocurrency to buy\n   */\n  selectedCryptoCurrency?: string;\n  /**\n   * Amount Cryptocurrency to buy\n   */\n  cryptoAmount?: number;\n}\n\nexport const PAYMENT_PROVIDER = {\n  MOONPAY: \"moonpay\",\n  WYRE: \"wyre\",\n  RAMPNETWORK: \"rampnetwork\",\n  XANPOOL: \"xanpool\",\n  MERCURYO: \"mercuryo\",\n  TRANSAK: \"transak\",\n} as const;\n\nexport type PAYMENT_PROVIDER_TYPE = typeof PAYMENT_PROVIDER[keyof typeof PAYMENT_PROVIDER];\n\nexport type InPageWalletProviderState = {\n  accounts: string[];\n  chainId: string;\n  isUnlocked: boolean;\n};\n\nexport type CommunicationWalletProviderState = {\n  isLoggedIn: boolean;\n  currentLoginProvider: LOGIN_PROVIDER_TYPE;\n};\n\nexport interface PopupWhitelabelData {\n  theme: THEME;\n}\n","import { BaseConfig, BaseState, IController, UserInfo } from \"../interfaces\";\n\nexport const ACTIVITY_ACTION = {\n  ACTIVITY_ACTION_ALL: \"walletActivity.allTransactions\",\n  ACTIVITY_ACTION_SEND: \"walletActivity.send\",\n  ACTIVITY_ACTION_RECEIVE: \"walletActivity.receive\",\n  ACTIVITY_ACTION_TOPUP: \"walletActivity.topup\",\n};\n\nexport type ACTIVITY_ACTION_TYPE = typeof ACTIVITY_ACTION[keyof typeof ACTIVITY_ACTION];\n\nexport const ACCOUNT_CATEGORY = {\n  NORMAL: \"normal\",\n  THRESHOLD: \"threshold\",\n  IMPORTED: \"imported\",\n};\n\nexport type ACCOUNT_TYPE = typeof ACCOUNT_CATEGORY[keyof typeof ACCOUNT_CATEGORY];\n\nexport type THEME = \"light\" | \"dark\";\n\nexport type CustomNft = {\n  id: number;\n  created_at: string;\n  nft_address: string;\n  public_address: string;\n  network: string;\n  nft_contract_standard: string;\n  nft_id: string;\n};\n\nexport type CustomToken = {\n  id: number;\n  created_at: string;\n  token_address: string;\n  public_address: string;\n  network: string;\n  token_symbol: string;\n  token_name: string;\n  decimals: string;\n};\n\nexport type UserVerifierInfo = {\n  verifier: string;\n  verifierId: string;\n};\n\nexport type PaymentTransaction = {\n  id: string;\n  date: string;\n  from: string;\n  slicedFrom: string;\n  action: string;\n  to: string;\n  slicedTo: string;\n  totalAmount: number;\n  totalAmountString: string;\n  currencyAmount: number;\n  currencyAmountString: string;\n  amount: number;\n  ethRate: number;\n  status: string;\n  blockExplorerLink: string;\n  currencyUsed: string;\n};\n\nexport interface RecordLoginPayload {\n  browser: string;\n  os: string;\n  os_version: string;\n  browser_version: string;\n  platform: string;\n  hostname: string;\n  verifier: string;\n  verifier_id: string;\n  metadata?: string;\n}\n\nexport interface UserPayload {\n  verifier: string;\n  verifier_id: string;\n  theme: string;\n  locale: string;\n  default_currency: string;\n}\nexport interface ContactPayload {\n  contact_verifier: string; // This is the verifier of the contact\n  contact_verifier_id: string; // This is the verifier id of the contact\n  display_name: string;\n}\n\nexport type Contact = {\n  id: number;\n  created_at: string;\n  updated_at: string;\n  contact_verifier: string;\n  contact_verifier_id: string;\n  display_name: string;\n  public_address: string;\n};\n\nexport interface AddressPreferences {\n  selectedCurrency: string;\n  theme: THEME;\n  locale: string;\n  accountType: ACCOUNT_TYPE;\n  contacts: Contact[];\n  crashReport: boolean;\n  userInfo: UserInfo;\n  jwtToken?: string;\n  paymentTx?: PaymentTransaction[];\n  defaultPublicAddress?: string;\n  customTokens?: CustomToken[];\n  customNfts?: CustomNft[];\n}\n\nexport interface User {\n  id: number;\n  public_address: string;\n  default_currency: string;\n  created_at: string;\n  theme: THEME;\n  locale: string;\n  verifier: string;\n  verifier_id: string;\n  account_type: string;\n  default_public_address: string;\n  contacts?: Contact[];\n  customTokens?: CustomToken[];\n  customNfts?: CustomNft[];\n}\n\nexport interface BillboardEvent {\n  eventName: string;\n  imageUrl: string;\n  imageDarkUrl: string;\n  description: string;\n  callToActionLinkTwo: string;\n  callToActionLink: string;\n  callToActionText: string;\n  locale: string;\n}\n\n/**\n * Preferences controller state\n */\nexport interface PreferencesState<P> extends BaseState {\n  /**\n   * Map of addresses to ContactEntry objects\n   */\n  identities: { [address: string]: P };\n  /**\n   * Current coinbase account\n   */\n  selectedAddress: string;\n\n  lastErrorMessage?: string;\n\n  lastSuccessMessage?: string;\n}\n\nexport interface PreferencesConfig extends BaseConfig {\n  pollInterval?: number;\n  api: string;\n  commonApiHost: string;\n  signInPrefix: string;\n}\n\nexport interface IPreferencesController<P, C, S> extends IController<C, S> {\n  /**\n   * Init will sync the preferences of specified address with backend and also add the identity in state\n   * the store.\n   * @param address - address of the user\n   * @param jwtToken - if jwt token already exists, it will be used instead of fetching from backend\n   * @param calledFromEmbed - if called from embed\n   * @param userInfo - optional user info\n   * @param rehydrate - Rehydrate the preferences from the local storage\n   *\n   */\n  initPreferences(params: {\n    address: string;\n    jwtToken?: string;\n    calledFromEmbed?: boolean;\n    userInfo?: { verifier: string; verifierId: string };\n    rehydrate?: boolean;\n    locale?: string;\n  }): Promise<void>;\n\n  /**\n   * Gets the preferences state of specified address\n   * @defaultValue - By default it will return selected address preferences\n   */\n  getAddressState(address?: string): P;\n\n  /**\n   * Sets the selected address in state\n   * @param selectedAddress - Sets the provided address as currently selected address\n   */\n  setSelectedAddress(selectedAddress: string): void;\n}\n","module.exports = require(\"@babel/runtime/helpers/get\");","module.exports = require(\"@babel/runtime/helpers/toConsumableArray\");","import BaseController from \"../BaseController\";\nimport { BaseBlockTrackerConfig, BaseBlockTrackerState } from \"./IBlockTrackerController\";\n\nconst sec = 1000;\n\nconst calculateSum = (accumulator: number, currentValue: number) => accumulator + currentValue;\nconst blockTrackerEvents: string[] = [\"sync\", \"latest\"];\n\nexport class BaseBlockTracker<\n  T extends { idempotencyKey: string },\n  C extends BaseBlockTrackerConfig,\n  S extends BaseBlockTrackerState<T>\n> extends BaseController<C, S> {\n  name = \"BaseBlockTracker\";\n\n  private _blockResetTimeout?: ReturnType<typeof setTimeout>;\n\n  constructor({ config = {}, state = {} }: { config: Partial<C>; state: Partial<S> }) {\n    super({ config, state });\n\n    // config\n\n    this.defaultState = {\n      _currentBlock: { idempotencyKey: \"\" },\n      _isRunning: false,\n    } as S;\n\n    this.defaultConfig = {\n      blockResetDuration: 20 * sec,\n    } as C;\n\n    this.initialize();\n\n    // bind functions for internal use\n    this._onNewListener = this._onNewListener.bind(this);\n    this._onRemoveListener = this._onRemoveListener.bind(this);\n    this._resetCurrentBlock = this._resetCurrentBlock.bind(this);\n\n    // listen for handler changes\n    this._setupInternalEvents();\n  }\n\n  isRunning(): boolean {\n    return this.state._isRunning;\n  }\n\n  getCurrentBlock(): T {\n    return this.state._currentBlock;\n  }\n\n  async getLatestBlock(): Promise<T> {\n    // return if available\n    if (this.state._currentBlock) {\n      return this.state._currentBlock;\n    }\n    // wait for a new latest block\n    const latestBlock = await new Promise((resolve: (state: T) => void) =>\n      this.once(\"latest\", (newState: BaseBlockTrackerState<T>) => {\n        if (newState._currentBlock) {\n          resolve(newState._currentBlock);\n        }\n      })\n    );\n    // return newly set current block\n    return latestBlock;\n  }\n\n  // dont allow module consumer to remove our internal event listeners\n  removeAllListeners(eventName?: string): this {\n    if (eventName) {\n      super.removeAllListeners(eventName);\n    } else {\n      super.removeAllListeners();\n    }\n    // re-add internal events\n    this._setupInternalEvents();\n    // trigger stop check just in case\n    this._onRemoveListener();\n    return this;\n  }\n\n  /**\n   * To be implemented in subclass.\n   */\n  protected _start(): void {\n    // default behavior is noop\n  }\n\n  /**\n   * To be implemented in subclass.\n   */\n  protected _end(): void {\n    // default behavior is noop\n  }\n\n  protected _newPotentialLatest(newBlock: T): void {\n    const currentBlock = this.state._currentBlock;\n    // only update if blok number is higher\n    if (currentBlock && newBlock.idempotencyKey === currentBlock.idempotencyKey) {\n      return;\n    }\n    this._setCurrentBlock(newBlock);\n  }\n\n  private _setupInternalEvents(): void {\n    // first remove listeners for idempotency\n    this.removeListener(\"newListener\", this._onNewListener);\n    this.removeListener(\"removeListener\", this._onRemoveListener);\n    // then add them\n    this.on(\"removeListener\", this._onRemoveListener);\n    this.on(\"newListener\", this._onNewListener);\n  }\n\n  private _onNewListener(): void {\n    this._maybeStart();\n  }\n\n  private _onRemoveListener(): void {\n    // `removeListener` is called *after* the listener is removed\n    if (this._getBlockTrackerEventCount() > 0) {\n      return;\n    }\n    this._maybeEnd();\n  }\n\n  private _maybeStart(): void {\n    if (this.state._isRunning) {\n      return;\n    }\n    this.state._isRunning = true;\n    // cancel setting latest block to stale\n    this._cancelBlockResetTimeout();\n    this._start();\n  }\n\n  private _maybeEnd(): void {\n    if (!this.state._isRunning) {\n      return;\n    }\n    this.state._isRunning = false;\n    this._setupBlockResetTimeout();\n    this._end();\n  }\n\n  private _getBlockTrackerEventCount(): number {\n    return blockTrackerEvents.map((eventName) => this.listenerCount(eventName)).reduce(calculateSum);\n  }\n\n  private _setCurrentBlock(newBlock: T): void {\n    const oldBlock = this.state._currentBlock;\n    this.update({\n      _currentBlock: newBlock,\n    } as S);\n    this.emit(\"latest\", newBlock);\n    this.emit(\"sync\", { oldBlock, newBlock });\n  }\n\n  private _setupBlockResetTimeout(): void {\n    // clear any existing timeout\n    this._cancelBlockResetTimeout();\n    // clear latest block when stale\n    this._blockResetTimeout = setTimeout(this._resetCurrentBlock, this.config.blockResetDuration);\n\n    // nodejs - dont hold process open\n    if (this._blockResetTimeout.unref) {\n      this._blockResetTimeout.unref();\n    }\n  }\n\n  private _cancelBlockResetTimeout(): void {\n    if (this._blockResetTimeout) {\n      clearTimeout(this._blockResetTimeout);\n    }\n  }\n\n  private _resetCurrentBlock(): void {\n    this.update({ _currentBlock: { idempotencyKey: \"\" } } as Partial<S>);\n  }\n}\n","import BaseController from \"./BaseController\";\n\nconst filterNoop = () => true;\nconst internalEvents = [\"newListener\", \"removeListener\"];\nconst externalEventFilter = (name: string) => !internalEvents.includes(name);\n\ninterface EventEmitterProxyOpts {\n  eventFilter?: ((name: string) => boolean) | string;\n}\n\nfunction getRawListeners<C, S, T extends BaseController<C, S>>(eventEmitter: T, name: string) {\n  // prefer native\n  return eventEmitter.rawListeners(name);\n}\n\nexport default function createEventEmitterProxy<C, S, T extends BaseController<C, S>>(initialTarget: T, opts?: EventEmitterProxyOpts): T {\n  // parse options\n  const finalOpts = opts || {};\n  let eventFilter = finalOpts.eventFilter || filterNoop;\n  if (typeof eventFilter === \"string\" && eventFilter === \"skipInternal\") eventFilter = externalEventFilter;\n  if (typeof eventFilter !== \"function\") throw new Error(\"createEventEmitterProxy - Invalid eventFilter\");\n\n  let target = initialTarget;\n\n  let setTarget = (newTarget: T) => {\n    const oldTarget = target;\n    target = newTarget;\n\n    oldTarget\n      .eventNames()\n      .filter(eventFilter as (name: string) => boolean)\n      .forEach((name: string) => {\n        getRawListeners(oldTarget, name).forEach((handler: (...args: any[]) => void) => newTarget.on(name, handler));\n      });\n\n    // remove old listeners\n    oldTarget.removeAllListeners();\n  };\n\n  const proxy = new Proxy<T>({} as T, {\n    get: (_, name) => {\n      // override `setTarget` access\n      if (name === \"setTarget\") return setTarget;\n      return target[name];\n    },\n    set: (_, name, value) => {\n      // allow `setTarget` overrides\n      if (name === \"setTarget\") {\n        setTarget = value;\n        return true;\n      }\n      target[name] = value;\n      return true;\n    },\n  });\n\n  return proxy;\n}\n","import BaseController from \"../BaseController\";\nimport { BaseCurrencyControllerConfig, BaseCurrencyControllerState } from \"./ICurrencyController\";\n\n// every ten minutes\nconst POLLING_INTERVAL = 600_000;\n\nexport class BaseCurrencyController<C extends BaseCurrencyControllerConfig, S extends BaseCurrencyControllerState> extends BaseController<C, S> {\n  constructor({ config = {}, state }: { config: Partial<C>; state?: Partial<S> }) {\n    super({ config, state });\n    this.defaultState = {\n      currentCurrency: \"usd\",\n      conversionRate: 0,\n      conversionDate: \"N/A\",\n      nativeCurrency: \"ETH\",\n    } as S;\n\n    this.defaultConfig = {\n      pollInterval: POLLING_INTERVAL,\n    } as C;\n    this.initialize();\n  }\n\n  //\n  // PUBLIC METHODS\n  //\n\n  public getNativeCurrency(): string {\n    return this.state.nativeCurrency;\n  }\n\n  public setNativeCurrency(nativeCurrency: string): void {\n    this.update({\n      nativeCurrency,\n      ticker: nativeCurrency,\n    } as S);\n  }\n\n  public getCurrentCurrency(): string {\n    return this.state.currentCurrency;\n  }\n\n  public setCurrentCurrency(currentCurrency: string): void {\n    this.update({ currentCurrency } as S);\n  }\n\n  /**\n   * A getter for the conversionRate property\n   *\n   * @returns The conversion rate from ETH to the selected currency.\n   *\n   */\n  public getConversionRate(): number {\n    return this.state.conversionRate;\n  }\n\n  public setConversionRate(conversionRate: number): void {\n    this.update({ conversionRate } as S);\n  }\n\n  /**\n   * A getter for the conversionDate property\n   *\n   * @returns The date at which the conversion rate was set. Expressed in milliseconds since midnight of\n   * January 1, 1970\n   *\n   */\n  public getConversionDate(): string {\n    return this.state.conversionDate;\n  }\n\n  public setConversionDate(conversionDate: string): void {\n    this.update({ conversionDate } as S);\n  }\n}\n","import { JRPCEngine } from \"@toruslabs/openlogin-jrpc\";\n\nimport BaseController from \"../BaseController\";\nimport createSwappableProxy from \"../createSwappableProxy\";\nimport type { BaseConfig } from \"../interfaces\";\nimport { providerFromEngine, SafeEventEmitterProvider } from \"../Network/INetworkController\";\nimport { createCommunicationMiddleware } from \"./CommunicationMethodMiddleware\";\nimport { BaseEmbedControllerState, ICommunicationProviderHandlers } from \"./IEmbedController\";\n\nexport class BaseEmbedController<C extends BaseConfig, S extends BaseEmbedControllerState> extends BaseController<C, S> {\n  public _communicationProviderProxy: SafeEventEmitterProvider;\n\n  constructor({ config = {}, state }: { config: Partial<C>; state?: Partial<S> }) {\n    super({ config, state });\n    this.defaultState = {\n      buttonPosition: \"bottom-right\",\n      isIFrameFullScreen: true,\n      apiKey: \"torus-default\",\n      oauthModalVisibility: false,\n      loginInProgress: false,\n      dappMetadata: {\n        name: \"\",\n        icon: \"\",\n      },\n    } as S;\n    this.initialize();\n  }\n\n  /**\n   * Called by orchestrator once while initializing the class\n   * @param handlers - JRPC handlers for provider\n   * @returns - provider - Returns the providerProxy\n   */\n  public initializeProvider(handlers: ICommunicationProviderHandlers): void {\n    const engine = new JRPCEngine();\n    const communicationMiddleware = createCommunicationMiddleware(handlers);\n    engine.push(communicationMiddleware);\n    const communicationProvider = providerFromEngine(engine);\n    this.setCommunicationProvider(communicationProvider);\n  }\n\n  private setCommunicationProvider(communicationProvider: SafeEventEmitterProvider): void {\n    if (this._communicationProviderProxy) {\n      // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n      // @ts-ignore\n      this._communicationProviderProxy.setTarget(communicationProvider);\n    } else {\n      this._communicationProviderProxy = createSwappableProxy<SafeEventEmitterProvider>(communicationProvider);\n    }\n  }\n}\n","import { JRPCEngineEndCallback, JRPCEngineNextCallback, JRPCRequest, JRPCResponse, SafeEventEmitter } from \"@toruslabs/openlogin-jrpc\";\n\nimport { COMMUNICATION_JRPC_METHODS } from \"../enums\";\n\nclass CommunicationWindowManager extends SafeEventEmitter {\n  handleWindowRpc = (\n    request: JRPCRequest<{ windowId: string }>,\n    response: JRPCResponse<boolean>,\n    next: JRPCEngineNextCallback,\n    end: JRPCEngineEndCallback\n  ): void => {\n    const { method, params } = request;\n    if (method === COMMUNICATION_JRPC_METHODS.OPENED_WINDOW) {\n      const { windowId } = params;\n      // I've been informed that a window has been opened\n      this.emit(`${windowId}:opened`);\n      response.result = true;\n      end();\n    } else if (method === COMMUNICATION_JRPC_METHODS.CLOSED_WINDOW) {\n      const { windowId } = params;\n      // I've been informed that a window has been closed\n      this.emit(`${windowId}:closed`);\n      response.result = true;\n      end();\n    } else {\n      next();\n    }\n  };\n}\n\nexport default CommunicationWindowManager;\n","import BaseController from \"../BaseController\";\nimport { BaseConfig } from \"../interfaces\";\nimport { hashMessage, signMessage } from \"../utils\";\nimport { KeyringControllerState } from \"./IKeyringController\";\nexport class BaseKeyringController<C extends BaseConfig, S extends KeyringControllerState> extends BaseController<C, S> {\n  constructor({ config = {}, state }: { config: Partial<C>; state?: Partial<S> }) {\n    super({ config, state });\n    this.defaultState = {\n      wallets: state.wallets ?? [],\n    } as S;\n    this.initialize();\n  }\n\n  // for signing auth message\n  signAuthMessage(address: string, message: string): string {\n    const keyring = this.state.wallets.find((x) => x.address === address);\n    if (!keyring) {\n      throw new Error(\"key does not exist\");\n    }\n    const hashedMessage = hashMessage(message).toString(\"hex\");\n    const rawMessageSig = signMessage(keyring.privateKey, hashedMessage);\n    return rawMessageSig;\n  }\n}\n","import { createAsyncMiddleware, JRPCEngineNextCallback, JRPCMiddleware, JRPCRequest, JRPCResponse } from \"@toruslabs/openlogin-jrpc\";\nimport { ethErrors } from \"eth-rpc-errors\";\n\nimport { Block, Payload } from \"./INetworkController\";\n\nexport interface FetchMiddlewareOptions {\n  rpcTarget: string;\n  originHttpHeaderKey?: string;\n}\n\nexport interface PayloadwithOrgin extends Payload {\n  origin?: string;\n}\nexport interface FetchMiddlewareFromReqOptions extends FetchMiddlewareOptions {\n  req: PayloadwithOrgin;\n}\n\nexport interface FetchConfig {\n  fetchUrl: string;\n  fetchParams: Record<string, unknown>;\n}\n\nconst RETRIABLE_ERRORS: string[] = [\n  // ignore server overload errors\n  \"Gateway timeout\",\n  \"ETIMEDOUT\",\n  // ignore server sent html error pages\n  // or truncated json responses\n  \"failed to parse response body\",\n  // ignore errors where http req failed to establish\n  \"Failed to fetch\",\n];\n\nfunction checkForHttpErrors(fetchRes: Response): void {\n  // check for errors\n  switch (fetchRes.status) {\n    case 405:\n      throw ethErrors.rpc.methodNotFound();\n\n    case 418:\n      throw ethErrors.rpc.internal({ message: `Request is being rate limited.` });\n\n    case 503:\n    case 504:\n      throw ethErrors.rpc.internal({\n        message: `Gateway timeout. The request took too long to process.` + `This can happen when querying over too wide a block range.`,\n      });\n\n    default:\n      break;\n  }\n}\n\nfunction timeout(duration: number): Promise<number> {\n  return new Promise((resolve) => setTimeout(resolve, duration));\n}\n\nfunction parseResponse(fetchRes: Response, body: Record<string, Block>): Block {\n  // check for error code\n  if (fetchRes.status !== 200) {\n    throw ethErrors.rpc.internal({\n      message: `Non-200 status code: '${fetchRes.status}'`,\n      data: body,\n    });\n  }\n  // check for rpc error\n  if (body.error) {\n    throw ethErrors.rpc.internal({\n      data: body.error,\n    });\n  }\n  // return successful result\n  return body.result;\n}\n\nexport function createFetchConfigFromReq({ req, rpcTarget, originHttpHeaderKey }: FetchMiddlewareFromReqOptions): FetchConfig {\n  const parsedUrl: URL = new URL(rpcTarget);\n\n  // prepare payload\n  // copy only canonical json rpc properties\n  const payload: Payload = {\n    id: req.id,\n    jsonrpc: req.jsonrpc,\n    method: req.method,\n    params: req.params,\n  };\n\n  // extract 'origin' parameter from request\n  const originDomain: string | undefined = req.origin;\n\n  // serialize request body\n  const serializedPayload: string = JSON.stringify(payload);\n\n  // configure fetch params\n  const fetchParams = {\n    method: \"POST\",\n    headers: {\n      Accept: \"application/json\",\n      \"Content-Type\": \"application/json\",\n    },\n    body: serializedPayload,\n  };\n\n  // optional: add request origin as header\n  if (originHttpHeaderKey && originDomain) {\n    fetchParams.headers[originHttpHeaderKey] = originDomain;\n  }\n\n  return { fetchUrl: parsedUrl.href, fetchParams };\n}\n\nexport function createFetchMiddleware({ rpcTarget, originHttpHeaderKey }: FetchMiddlewareOptions): JRPCMiddleware<string[], Block> {\n  return createAsyncMiddleware(async (req: JRPCRequest<string[]>, res: JRPCResponse<unknown>, _next: JRPCEngineNextCallback) => {\n    const { fetchUrl, fetchParams } = createFetchConfigFromReq({\n      req,\n      rpcTarget,\n      originHttpHeaderKey,\n    });\n\n    // attempt request multiple times\n    const maxAttempts = 5;\n    const retryInterval = 1000;\n    for (let attempt = 0; attempt < maxAttempts; attempt++) {\n      try {\n        const fetchRes: Response = await fetch(fetchUrl, fetchParams);\n        // check for http errrors\n        checkForHttpErrors(fetchRes);\n        // parse response body\n        const fetchBody: Record<string, Block> = await fetchRes.json();\n        const result: Block = parseResponse(fetchRes, fetchBody);\n        // set result and exit retry loop\n        res.result = result;\n        return;\n      } catch (err) {\n        const errMsg: string = err.toString();\n        const isRetriable: boolean = RETRIABLE_ERRORS.some((phrase) => errMsg.includes(phrase));\n        // re-throw error if not retriable\n        if (!isRetriable) {\n          throw err;\n        }\n      }\n      // delay before retrying\n      await timeout(retryInterval);\n    }\n  });\n}\n","import { JRPCEngineNextCallback, JRPCRequest, JRPCResponse } from \"@toruslabs/openlogin-jrpc\";\nimport log from \"loglevel\";\n\nexport interface LoggerMiddlewareOptions {\n  origin: string;\n}\n\nexport function createLoggerMiddleware(options: LoggerMiddlewareOptions) {\n  return function loggerMiddleware(request: JRPCRequest<unknown>, response: JRPCResponse<unknown>, next: JRPCEngineNextCallback): void {\n    next((callback) => {\n      if (response.error) {\n        log.warn(\"Error in RPC response:\\n\", response);\n      }\n      if ((request as unknown as { isTorusInternal: boolean }).isTorusInternal) return;\n      log.info(`RPC (${options.origin}):`, request, \"->\", response);\n      callback();\n    });\n  };\n}\n","import { JRPCEngineNextCallback, JRPCRequest, JRPCResponse } from \"@toruslabs/openlogin-jrpc\";\n\nexport interface OriginMiddlewareOptions {\n  origin: string;\n}\nexport function createOriginMiddleware(options: OriginMiddlewareOptions) {\n  return function originMiddleware(request: JRPCRequest<unknown>, _: JRPCResponse<unknown>, next: JRPCEngineNextCallback): void {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    (request as any).origin = options.origin;\n    next();\n  };\n}\n","import { get, patch, post, remove } from \"@toruslabs/http-helpers\";\nimport bowser from \"bowser\";\nimport { cloneDeep } from \"lodash\";\nimport log from \"loglevel\";\n\nimport BaseController from \"../BaseController\";\nimport { BaseConfig, EmailObject, LOGIN_PROVIDER, UserInfo } from \"../interfaces\";\nimport { BaseKeyringController } from \"../Keyring/BaseKeyringController\";\nimport { KeyringControllerState } from \"../Keyring/IKeyringController\";\nimport { TransactionStatus } from \"../Transaction/ITransactionController\";\nimport { getCustomDeviceInfo } from \"../utils\";\nimport {\n  ACCOUNT_CATEGORY,\n  AddressPreferences,\n  BillboardEvent,\n  Contact,\n  ContactPayload,\n  PreferencesConfig,\n  PreferencesState,\n  RecordLoginPayload,\n  THEME,\n  UserPayload,\n} from \"./IPreferencesController\";\n\n// By default, poll every 3 minutes\nconst DEFAULT_INTERVAL = 180 * 1000;\n\nexport const DEFAULT_PREFERENCES = {\n  selectedCurrency: \"USD\",\n  theme: \"dark\",\n  locale: \"en-US\",\n  accountType: ACCOUNT_CATEGORY.NORMAL,\n  contacts: [],\n  jwtToken: \"\",\n  fetchedPastTx: [],\n  pastTransactions: [],\n  paymentTx: [],\n  defaultPublicAddress: \"\",\n  customTokens: [],\n  customNfts: [],\n  crashReport: true,\n  userInfo: {\n    aggregateVerifier: \"\",\n    email: \"\",\n    name: \"\",\n    profileImage: \"\",\n    typeOfLogin: LOGIN_PROVIDER.GOOGLE,\n    verifier: \"\",\n    verifierId: \"\",\n  },\n} as AddressPreferences;\n\n/**\n * Controller that stores shared settings and exposes convenience methods\n */\nexport abstract class BasePreferencesController<\n  P extends AddressPreferences,\n  C extends PreferencesConfig,\n  S extends PreferencesState<P>\n> extends BaseController<C, S> {\n  /**\n   * Name of this controller used during composition\n   */\n  name = \"PreferencesController\";\n\n  public iframeOrigin: string;\n\n  private signAuthMessage: BaseKeyringController<BaseConfig, KeyringControllerState>[\"signAuthMessage\"];\n\n  private defaultPreferences: Partial<P>;\n\n  /**\n   * Creates a PreferencesController instance\n   *\n   * @param config - Initial options used to configure this controller\n   * @param state - Initial state to set on this controller\n   */\n  constructor({\n    config,\n    state,\n    defaultPreferences,\n    signAuthMessage,\n  }: {\n    config?: Partial<C> & Pick<C, \"api\" | \"commonApiHost\" | \"signInPrefix\">;\n    state?: Partial<S>;\n    defaultPreferences?: Partial<P>;\n    signAuthMessage: BaseKeyringController<BaseConfig, KeyringControllerState>[\"signAuthMessage\"];\n  }) {\n    super({ config, state });\n    if (!config.api) {\n      throw new Error(\"PreferencesController - no api specified in config.\");\n    }\n    this.defaultState = {\n      identities: {},\n      selectedAddress: \"\",\n      lastErrorMessage: \"\",\n      lastSuccessMessage: \"\",\n    } as S;\n    this.defaultConfig = {\n      api: config.api,\n      pollInterval: DEFAULT_INTERVAL,\n    } as C;\n    this.initialize();\n    this.defaultPreferences = {\n      ...DEFAULT_PREFERENCES,\n      ...defaultPreferences,\n    };\n    this.signAuthMessage = signAuthMessage;\n  }\n\n  public setIframeOrigin(origin: string): void {\n    this.iframeOrigin = origin;\n  }\n\n  getAddressState(address?: string): P | undefined {\n    const selectedAddress = address || this.state.selectedAddress;\n    return this.state.identities[selectedAddress];\n  }\n\n  /**\n   * Sets selected address\n   *\n   * @param selectedAddress - casper account hash\n   */\n  setSelectedAddress(selectedAddress: string): void {\n    this.update({ selectedAddress } as Partial<S>);\n  }\n\n  async getUser<U>(address: string): Promise<U> {\n    const user = await get<{ success: boolean; error?: string; data?: U }>(`${this.config.api}/user?fetchTx=false`, this.headers(address), {\n      useAPIKey: true,\n    });\n    return user.data;\n  }\n\n  async createUser(params: {\n    selectedCurrency: string;\n    theme: THEME;\n    verifier: string;\n    verifierId: string;\n    locale: string;\n    address: string;\n  }): Promise<void> {\n    const { selectedCurrency, theme, verifier, verifierId, locale, address } = params;\n    const userPayload: UserPayload = {\n      default_currency: selectedCurrency,\n      theme,\n      verifier,\n      verifier_id: verifierId,\n      locale,\n    };\n    await post(`${this.config.api}/user`, userPayload, this.headers(address), { useAPIKey: true });\n    this.updateState(\n      {\n        theme,\n        defaultPublicAddress: address,\n        selectedCurrency,\n        locale,\n      } as Partial<P>,\n      address\n    );\n  }\n\n  public async storeUserLogin(params: {\n    verifier: string;\n    verifierId: string;\n    address: string;\n    options: { calledFromEmbed: boolean; rehydrate: boolean };\n  }): Promise<void> {\n    const { verifierId, verifier, options, address } = params;\n    if (!options.rehydrate) {\n      const browser = bowser.getParser(window.navigator.userAgent);\n      const specialBrowser = getCustomDeviceInfo();\n      const recordLoginPayload: RecordLoginPayload = {\n        os: browser.getOSName(),\n        os_version: browser.getOSVersion() || \"unidentified\",\n        browser: specialBrowser?.browser || browser.getBrowserName() || \"unidentified\",\n        browser_version: browser.getBrowserVersion() || \"unidentified\",\n        platform: browser.getPlatform().type || \"desktop\",\n        hostname: this.iframeOrigin,\n        verifier,\n        verifier_id: verifierId,\n      };\n      await post<{ success: boolean }>(`${this.config.api}/user/recordLogin`, recordLoginPayload, this.headers(address), { useAPIKey: true });\n    }\n  }\n\n  async setCrashReport(isEnabled: boolean): Promise<boolean> {\n    if (isEnabled === this.getAddressState()?.crashReport) return true;\n    try {\n      await patch(`${this.config.api}/user`, { enable_crash_reporter: isEnabled }, this.headers(), { useAPIKey: true });\n      this.updateState({ crashReport: isEnabled } as Partial<P>);\n      return true;\n    } catch (error) {\n      log.error(error);\n      return false;\n    }\n  }\n\n  async setUserTheme(theme: THEME): Promise<boolean> {\n    if (theme === this.getAddressState()?.theme) return true;\n    try {\n      await patch(`${this.config.api}/user`, { theme }, this.headers(), { useAPIKey: true });\n      this.updateState({ theme } as Partial<P>);\n      return true;\n    } catch (error) {\n      log.error(error);\n      return false;\n    }\n  }\n\n  async setUserLocale(locale: string): Promise<boolean> {\n    if (locale === this.getAddressState()?.locale) return;\n    try {\n      await patch(`${this.config.api}/user`, { locale }, this.headers(), { useAPIKey: true });\n      this.updateState({ locale } as Partial<P>);\n      return true;\n    } catch (error) {\n      log.error(\"unable to set locale\", error);\n      return false;\n    }\n  }\n\n  async setSelectedCurrency(payload: { selectedCurrency: string }): Promise<boolean> {\n    if (payload.selectedCurrency === this.getAddressState()?.selectedCurrency) return true;\n    try {\n      await patch(`${this.config.api}/user`, { default_currency: payload.selectedCurrency }, this.headers(), { useAPIKey: true });\n      this.updateState({ selectedCurrency: payload.selectedCurrency } as Partial<P>);\n      return true;\n    } catch (error) {\n      log.error(error);\n      return false;\n    }\n  }\n\n  async addContact(contact: ContactPayload): Promise<boolean> {\n    try {\n      const response = await post<{ success: boolean; data: Contact }>(`${this.config.api}/contact`, contact, this.headers(), { useAPIKey: true });\n      this.updateState({ contacts: [...(this.getAddressState()?.contacts || []), response.data] } as Partial<P>);\n      return true;\n    } catch (error) {\n      log.error(\"unable to add contact\", error);\n      return false;\n    }\n  }\n\n  async deleteContact(contactId: number): Promise<boolean> {\n    try {\n      const response = await remove<{ success: boolean; data: { id: number } }>(`${this.config.api}/contact/${contactId}`, {}, this.headers(), {\n        useAPIKey: true,\n      });\n      const finalContacts = this.getAddressState()?.contacts.filter((contact) => contact.id !== response.data.id);\n      if (finalContacts) this.updateState({ contacts: [...finalContacts] } as Partial<P>);\n      return true;\n    } catch (error) {\n      log.error(\"unable to delete contact\", error);\n      return false;\n    }\n  }\n\n  async revokeDiscord(idToken: string): Promise<void> {\n    try {\n      const resp = await post(`${this.config.api}/revoke/discord`, { token: idToken }, this.headers(), { useAPIKey: true });\n      log.info(resp);\n    } catch (error) {\n      log.error(error);\n    }\n  }\n\n  async patchPastTx(body: { id: string; status: TransactionStatus; updated_at: string }, address: string): Promise<void> {\n    try {\n      const response = await patch(`${this.config.api}/transaction`, body, this.headers(address), { useAPIKey: true });\n      log.info(\"successfully patched\", response);\n    } catch (error) {\n      log.error(\"unable to patch tx\", error);\n    }\n  }\n\n  async postPastTx<T>(tx: T, address: string): Promise<{ success: boolean; response: number[] }> {\n    try {\n      const response = await post(`${this.config.api}/transaction`, tx, this.headers(address), {\n        useAPIKey: true,\n      });\n      log.info(\"successfully posted tx\", response);\n      return response as { success: boolean; response: number[] };\n    } catch (error) {\n      log.error(error, \"unable to insert transaction\");\n    }\n  }\n\n  async getWalletOrders<T>(address: string): Promise<T[]> {\n    try {\n      const response = await get<{ success: boolean; data: T[] | null }>(`${this.config.api}/transaction`, this.headers(address), {\n        useAPIKey: true,\n      });\n      return response.success ? (response.data ? response.data : []) : [];\n    } catch (error) {\n      log.error(\"unable to get wallet orders tx\", error);\n      return [];\n    }\n  }\n\n  async getTopUpOrders<T>(address: string): Promise<T[]> {\n    try {\n      const response = await get<{ success: boolean; data: T[] }>(`${this.config.commonApiHost}/transaction`, this.headers(address), {\n        useAPIKey: true,\n      });\n      return response.data || [];\n    } catch (error) {\n      log.error(\"unable to fetch past Top up orders\", error);\n    }\n  }\n\n  async getBillBoardData(): Promise<BillboardEvent[]> {\n    try {\n      const response = await get<{ success: boolean; data: BillboardEvent[] | null }>(`${this.config.api}/billboard`, this.headers(), {\n        useAPIKey: true,\n      });\n      return response.success ? response.data : [];\n    } catch (error) {\n      log.error(\"unable to get billboard data\", error);\n      return [];\n    }\n  }\n\n  async getMessageForSigning(publicAddress: string): Promise<string> {\n    const response = await post<{ success: boolean; message: string }>(\n      `${this.config.api}/auth/message`,\n      {\n        public_address: publicAddress,\n      },\n      {},\n      { useAPIKey: true }\n    );\n    return response.message;\n  }\n\n  async getTwitterId(payload: { nick: string; typeOfLogin: string }): Promise<string> {\n    const res = await get<{ success: boolean; data: string }>(`${this.config.api}/twitter?screen_name=${payload.nick}`, this.headers(), {\n      useAPIKey: true,\n    });\n    return `${payload.typeOfLogin.toLowerCase()}|${res.data.toString()}`;\n  }\n\n  async sendEmail(payload: { emailObject: EmailObject }): Promise<void> {\n    return post(`${this.config.api}/transaction/sendemail`, payload.emailObject, this.headers(), { useAPIKey: true });\n  }\n\n  protected async init(address: string, userInfo: UserInfo, jwtToken?: string): Promise<void> {\n    let response = { token: jwtToken };\n    if (this.getAddressState(address)) return;\n    if (!jwtToken) {\n      const messageToSign = await this.getMessageForSigning(address);\n      if (!messageToSign.startsWith(this.config.signInPrefix)) throw new Error(\"Cannot sign on invalid message\");\n      const signedMessage = this.signAuthMessage(address, messageToSign);\n      response = await post(\n        `${this.config.api}/auth/verify`,\n        {\n          public_address: address,\n          signed_message: signedMessage,\n        },\n        {},\n        { useAPIKey: true }\n      );\n    }\n    this.updateState({ jwtToken: response.token, userInfo } as Partial<P>, address);\n  }\n\n  protected updateState(preferences?: Partial<P>, address?: string): P {\n    const selectedAddress = address || this.state.selectedAddress;\n    const currentState = this.getAddressState(selectedAddress) || cloneDeep(this.defaultPreferences);\n    const mergedState = { ...currentState, ...preferences } as P;\n    this.update({\n      identities: {\n        ...this.state.identities,\n        [selectedAddress]: mergedState,\n      },\n    } as S);\n    return mergedState;\n  }\n\n  private headers(address?: string): { headers: { Authorization: string; \"Content-Type\": string } } {\n    const selectedAddress = address || this.state.selectedAddress;\n    return {\n      headers: {\n        Authorization: `Bearer ${this.getAddressState(selectedAddress)?.jwtToken || \"\"}`,\n        \"Content-Type\": \"application/json; charset=utf-8\",\n      },\n    };\n  }\n\n  abstract sync(address: string): Promise<boolean>;\n}\n","import { omitBy, pickBy } from \"lodash\";\n\nimport BaseController from \"../BaseController\";\nimport { transactionMatchesNetwork } from \"../utils\";\nimport {\n  TransactionConfig,\n  TransactionMeta,\n  TransactionState,\n  TransactionStatus,\n  TX_EVENTS,\n  TX_STATUS_UPDATE_EVENT_TYPE,\n} from \"./ITransactionController\";\n\nexport class BaseTransactionStateManager<T> extends BaseController<TransactionConfig, TransactionState<T>> {\n  protected getCurrentChainId: () => string;\n\n  constructor({\n    config,\n    state,\n    getCurrentChainId,\n  }: {\n    config?: Partial<TransactionConfig>;\n    state?: Partial<TransactionState<T>>;\n    getCurrentChainId: () => string;\n  }) {\n    super({ config, state });\n    this.defaultConfig = {\n      txHistoryLimit: 40,\n    };\n    this.defaultState = {\n      transactions: {},\n      unapprovedTxs: {},\n      currentNetworkTxsList: [],\n    };\n    this.initialize();\n    this.getCurrentChainId = getCurrentChainId;\n  }\n\n  getUnapprovedTxList(): Record<string, TransactionMeta<T>> {\n    const chainId = this.getCurrentChainId();\n    return pickBy(\n      this.state.transactions,\n      (transaction) => transaction.status === TransactionStatus.unapproved && transactionMatchesNetwork<T>(transaction, chainId)\n    );\n  }\n\n  getTransaction(txId: string): TransactionMeta<T> {\n    const { transactions } = this.state;\n    return transactions[txId];\n  }\n\n  updateTransaction(txMeta: TransactionMeta<T>): void {\n    // commit txMeta to state\n    const txId = txMeta.id;\n    txMeta.updated_at = new Date().toISOString();\n    this.update({\n      transactions: {\n        ...this.state.transactions,\n        [txId]: txMeta,\n      },\n    });\n  }\n\n  setTxStatusRejected(txId: string): void {\n    this._setTransactionStatus(txId, TransactionStatus.rejected);\n    this._deleteTransaction(txId);\n  }\n\n  /**\n   * The implementing controller can override this functionality and add custom logic + call super.()\n   */\n  setTxStatusUnapproved(txId: string): void {\n    this._setTransactionStatus(txId, TransactionStatus.unapproved);\n  }\n\n  setTxStatusApproved(txId: string): void {\n    this._setTransactionStatus(txId, TransactionStatus.approved);\n  }\n\n  setTxStatusSigned(txId: string): void {\n    this._setTransactionStatus(txId, TransactionStatus.signed);\n  }\n\n  setTxStatusSubmitted(txId: string): void {\n    this._setTransactionStatus(txId, TransactionStatus.submitted);\n  }\n\n  setTxStatusDropped(txId: string): void {\n    this._setTransactionStatus(txId, TransactionStatus.dropped);\n  }\n\n  setTxStatusExpired(txId: string): void {\n    this._setTransactionStatus(txId, TransactionStatus.expired);\n  }\n\n  setTxStatusConfirmed(txId: string): void {\n    this._setTransactionStatus(txId, TransactionStatus.confirmed);\n  }\n\n  setTxStatusFailed(txId: string, error_: Error): void {\n    const error = !error_ ? new Error(\"Internal torus failure\") : error_;\n\n    const txMeta = this.getTransaction(txId);\n    txMeta.error = error;\n    this.updateTransaction(txMeta);\n    this._setTransactionStatus(txId, TransactionStatus.failed);\n  }\n\n  /**\n   * Method to determine if the transaction is in a final state\n   * @param status - Transaction status\n   * @returns boolean if the transaction is in a final state\n   */\n  isFinalState(status: TransactionStatus): boolean {\n    return (\n      status === TransactionStatus.rejected ||\n      status === TransactionStatus.submitted ||\n      status === TransactionStatus.confirmed ||\n      status === TransactionStatus.failed ||\n      status === TransactionStatus.cancelled ||\n      status === TransactionStatus.expired\n    );\n  }\n\n  /**\n   * Filters out the unapproved transactions from state\n   */\n  clearUnapprovedTxs(): void {\n    this.update({\n      transactions: omitBy(this.state.transactions, (transaction: TransactionMeta<T>) => transaction.status === TransactionStatus.unapproved),\n    });\n  }\n\n  /**\n   * will append new transactions to old txns.\n   */\n  _addTransactionsToState(transactions: TransactionMeta<T>[]): void {\n    this.update({\n      transactions: transactions.reduce((result: Record<string, TransactionMeta<T>>, newTx: TransactionMeta<T>) => {\n        result[newTx.id] = newTx;\n        return result;\n      }, this.state.transactions),\n    });\n  }\n\n  /**\n   * will set new txns, override existing if any in state.\n   */\n  _setTransactionsToState(transactions: TransactionMeta<T>[]): void {\n    this.update({\n      transactions: transactions.reduce((result: Record<string, TransactionMeta<T>>, newTx: TransactionMeta<T>) => {\n        result[newTx.id] = newTx;\n        return result;\n      }, {}),\n    });\n  }\n\n  _deleteTransaction(targetTransactionId: string): void {\n    const { transactions } = this.state;\n    delete transactions[targetTransactionId];\n    this.update({\n      transactions,\n    });\n  }\n\n  _deleteTransactions(targetTransactionIds: string[]): void {\n    const { transactions } = this.state;\n    targetTransactionIds.forEach((transactionId) => {\n      delete transactions[transactionId];\n    });\n    this.update({\n      transactions,\n    });\n  }\n\n  protected _setTransactionStatus(txId: string, status: TransactionStatus): void {\n    const txMeta = this.getTransaction(txId);\n    if (!txMeta) {\n      return;\n    }\n    txMeta.status = status;\n    // only updating status so no validation required on txn.\n    this.updateTransaction(txMeta);\n    this.emit(TX_EVENTS.TX_STATUS_UPDATE, { txId, status } as TX_STATUS_UPDATE_EVENT_TYPE);\n    if (this.isFinalState(status)) {\n      this.emit(`${txMeta.id}:finished`, txMeta);\n    } else {\n      this.emit(`${txMeta.id}:${status}`, txId);\n    }\n  }\n}\n","import { BroadcastChannel } from \"broadcast-channel\";\n\nimport { POPUP_LOADED } from \"../enums\";\nimport { broadcastChannelOptions } from \"../utils\";\nimport { PopupData } from \"./interfaces\";\n\nexport default class BroadcastChannelHandler {\n  public bc: BroadcastChannel<PopupData<unknown>>;\n\n  private channel: string;\n\n  constructor(channelPrefix: string) {\n    const queryParameters = new URLSearchParams(window.location.search);\n    const instanceId = queryParameters.get(\"instanceId\");\n    this.channel = `${channelPrefix}_${instanceId}`;\n    this.bc = new BroadcastChannel(this.channel, broadcastChannelOptions);\n  }\n\n  public getMessageFromChannel<T>(): Promise<T> {\n    return new Promise((resolve, reject) => {\n      this.bc.addEventListener(\"message\", async (ev) => {\n        this.bc.close();\n        if (ev.error) {\n          reject(ev.error);\n        } else {\n          resolve(ev.data as T);\n        }\n      });\n      this.bc.postMessage({ data: { type: POPUP_LOADED } });\n    });\n  }\n}\n","import { BroadcastChannel } from \"broadcast-channel\";\nimport log from \"loglevel\";\n\nimport BaseController from \"../BaseController\";\nimport { COMMUNICATION_NOTIFICATIONS, POPUP_LOADED, SETUP_COMPLETE } from \"../enums\";\nimport { IWindow } from \"../interfaces\";\nimport { broadcastChannelOptions, randomId } from \"../utils\";\nimport { PopupData, StreamWindowConfig, StreamWindowState } from \"./interfaces\";\n\nclass StreamWindow extends BaseController<StreamWindowConfig, StreamWindowState> implements IWindow {\n  // if window has been closed by users\n  closed = false;\n\n  constructor({\n    config,\n    state = {},\n  }: {\n    config: Partial<StreamWindowConfig> & Pick<StreamWindowConfig, \"communicationEngine\" | \"communicationWindowManager\">;\n    state?: Partial<StreamWindowState>;\n  }) {\n    super({ config, state });\n    this.initialize();\n  }\n\n  async open(): Promise<this> {\n    return new Promise((resolve, reject) => {\n      const { communicationEngine, communicationWindowManager } = this.config;\n\n      communicationWindowManager.once(`${this.state.windowId}:closed`, () => {\n        this.closed = true;\n      });\n\n      // Window is not open yet\n      if (!this.state.windowId) {\n        this.update({ windowId: randomId() });\n\n        communicationWindowManager.once(`${this.state.windowId}:opened`, () => {\n          resolve(this);\n        });\n\n        // Tell the other party to create a window by prompting the user to click on something\n        communicationEngine.emit(\"notification\", {\n          method: COMMUNICATION_NOTIFICATIONS.CREATE_WINDOW,\n          params: {\n            windowId: this.state.windowId,\n            url: this.state.url.href,\n          },\n        });\n      } else {\n        // Send this window with `windowId` the url to open via bc\n        const bc = new BroadcastChannel<PopupData<{ message: string }>>(this.state.windowId, broadcastChannelOptions);\n\n        let writeInterval: number = null;\n        bc.addEventListener(\"message\", async (ev) => {\n          try {\n            log.info(ev, `receiving data on channel: ${bc.name}`);\n            const { error } = ev;\n            if (error) {\n              // Popup says some error. so, we say it's not really opened\n              reject(new Error(error));\n              return;\n            }\n            const { message } = ev.data;\n            if (message === POPUP_LOADED) {\n              if (writeInterval) window.clearInterval(writeInterval);\n              await bc.postMessage({\n                data: {\n                  url: this.state.url.href,\n                  message: \"\", // No need of a msg\n                },\n              } as PopupData<{ message: string }>);\n              resolve(this);\n              bc.close();\n            }\n          } catch (error) {\n            reject(error);\n            bc.close();\n            // Something went wrong. so, we close that window\n            this.close();\n          }\n        });\n\n        // We don't know if the other end is ready to receive this msg. So, we keep writing until it receives and sends back something\n        writeInterval = window.setInterval(() => {\n          bc.postMessage({\n            data: {\n              message: SETUP_COMPLETE,\n            },\n          } as PopupData<{ message: string }>);\n        }, 200);\n      }\n    });\n  }\n\n  close(): void {\n    const { communicationEngine } = this.config;\n    communicationEngine.emit(\"notification\", {\n      method: COMMUNICATION_NOTIFICATIONS.CLOSE_WINDOW,\n      params: {\n        windowId: this.state.windowId,\n      },\n    });\n  }\n}\n\nexport default StreamWindow;\n","import BaseController from \"../BaseController\";\nimport { FEATURES_DEFAULT_POPUP_WINDOW } from \"../enums\";\nimport { IWindow } from \"../interfaces\";\nimport { getPopupFeatures } from \"../utils\";\nimport { PopupHandlerConfig, PopupHandlerState } from \"./interfaces\";\nimport StreamWindow from \"./StreamWindow\";\n/*\nScenarios:\n1. Open a normal popup window and no communication with it - Use PopupHandler\n2. Open a popup window and communicate with it - Use PopupWithBcHandler (can initiate communication by waiting for window to open or not)\n\n3. If window is already opened, pass in windowId to the popup handler. \n   This will establish communication with the popup window and sends it a new url to redirect to\n\n\nIf you're trying to open a window and it gets blocked (happens if you're in iframe or delay b/w click and opening window),\nStreamWindow is invoked and it writes in a channel to display a message to the user\n\nOnce user clicks on that modal/dialog, we pre-open the window and pass in the windowId (goes to 3)\n*/\n\n/**\n * Handles popup window management.\n * For broadcast channel communication, use url with `instanceId` coded into state parameter.\n * This state parameter will be passed across redirects according to OAuth spec.\n */\nclass PopupHandler extends BaseController<PopupHandlerConfig, PopupHandlerState> {\n  constructor({ config, state }: { config: Partial<PopupHandlerConfig>; state: Partial<PopupHandlerState> & Pick<PopupHandlerState, \"url\"> }) {\n    super({ config, state });\n    // this.id = randomId()\n    // Add in dapp storage key to all popups as a hash parameter\n    this.defaultConfig = {\n      dappStorageKey: \"\",\n      features: getPopupFeatures(FEATURES_DEFAULT_POPUP_WINDOW),\n      target: \"_blank\",\n      communicationEngine: null,\n      communicationWindowManager: null,\n    };\n    this.defaultState = {\n      windowTimer: null,\n      window: null,\n      iClosedWindow: false,\n      windowId: \"\",\n      url: state.url,\n    };\n    this.initialize();\n    this._setupTimer();\n  }\n\n  async open(): Promise<void> {\n    // if window is already open\n    const { target, features, dappStorageKey, communicationEngine, communicationWindowManager } = this.config;\n    const { windowId, url } = this.state;\n    if (dappStorageKey) {\n      const urlHashParams = new URLSearchParams(url.hash.slice(1));\n      urlHashParams.append(\"dappStorageKey\", dappStorageKey);\n      url.hash = urlHashParams.toString();\n      this.update({ url });\n    }\n    // No window has been pre-opened\n    if (!windowId) {\n      // try to open a window first\n      let localWindow: IWindow = window.open(url.href, target, features);\n      if (!localWindow) {\n        // if it's blocked, open StreamWindow\n        localWindow = new StreamWindow({ config: { communicationEngine, communicationWindowManager }, state: { url } });\n        localWindow.open();\n      }\n      this.update({ window: localWindow });\n      return;\n    }\n    // A window has been pre-opened with a query parameter `windowId`\n    const localWindow = new StreamWindow({ config: { communicationEngine, communicationWindowManager }, state: { url, windowId } });\n    this.update({ window: localWindow });\n    await localWindow.open();\n  }\n\n  close(): void {\n    this.update({ iClosedWindow: true });\n    const { window } = this.state;\n    if (window) window.close();\n  }\n\n  private _setupTimer(): void {\n    const timer = window.setInterval(() => {\n      const { window, windowTimer, iClosedWindow } = this.state;\n      if (window && window.closed) {\n        if (windowTimer) clearInterval(windowTimer);\n        if (!iClosedWindow) {\n          this.emit(\"close\");\n        }\n        this.update({ iClosedWindow: false, window: null });\n      }\n      if (window === null && windowTimer) clearInterval(windowTimer);\n    }, 500);\n    this.update({ windowTimer: timer });\n  }\n}\n\nexport default PopupHandler;\n","import { BroadcastChannel } from \"broadcast-channel\";\nimport log from \"loglevel\";\n\nimport { BROADCAST_CHANNELS, BROADCAST_CHANNELS_MSGS } from \"../enums\";\nimport { broadcastChannelOptions } from \"../utils\";\nimport {\n  AccountImportedChannelData,\n  BasePopupChannelData,\n  NetworkChangeChannelData,\n  PopupData,\n  PopupStoreChannelHandlers,\n  SelectedAddresssChangeChannelData,\n} from \"./interfaces\";\n\nexport default class PopupStoreChannel {\n  private handleLogout: PopupStoreChannelHandlers[\"handleLogout\"];\n\n  private handleAccountImport: PopupStoreChannelHandlers[\"handleAccountImport\"];\n\n  private handleNetworkChange: PopupStoreChannelHandlers[\"handleNetworkChange\"];\n\n  private handleSelectedAddressChange: PopupStoreChannelHandlers[\"handleSelectedAddressChange\"];\n\n  private instanceId: string;\n\n  constructor({\n    instanceId,\n    handleLogout,\n    handleAccountImport,\n    handleNetworkChange,\n    handleSelectedAddressChange,\n  }: {\n    instanceId: string;\n    handleLogout: PopupStoreChannelHandlers[\"handleLogout\"];\n    handleAccountImport: PopupStoreChannelHandlers[\"handleAccountImport\"];\n    handleNetworkChange: PopupStoreChannelHandlers[\"handleNetworkChange\"];\n    handleSelectedAddressChange: PopupStoreChannelHandlers[\"handleSelectedAddressChange\"];\n  }) {\n    this.instanceId = instanceId;\n    this.handleLogout = handleLogout;\n    this.handleAccountImport = handleAccountImport;\n    this.handleNetworkChange = handleNetworkChange;\n    this.handleSelectedAddressChange = handleSelectedAddressChange;\n  }\n\n  public setupStoreChannels(): void {\n    this.logoutChannel();\n    this.importAccountChannel();\n    this.networkChangeChannel();\n    this.selectedAddressChangeChannel();\n  }\n\n  private logoutChannel(): void {\n    const logoutChannel = new BroadcastChannel<PopupData<BasePopupChannelData>>(\n      `${BROADCAST_CHANNELS.WALLET_LOGOUT_CHANNEL}_${this.instanceId}`,\n      broadcastChannelOptions\n    );\n    logoutChannel.addEventListener(\"message\", (ev) => {\n      log.info(\"received logout message\", ev);\n      if (!ev.error && ev.data?.type === BROADCAST_CHANNELS_MSGS.LOGOUT) {\n        log.info(\"Logging Out\");\n        this.handleLogout();\n      }\n    });\n  }\n\n  private importAccountChannel(): void {\n    const walletAccountImportChannel = new BroadcastChannel<PopupData<AccountImportedChannelData>>(\n      `${BROADCAST_CHANNELS.WALLET_ACCOUNT_IMPORT_CHANNEL}_${this.instanceId}`,\n      broadcastChannelOptions\n    );\n    walletAccountImportChannel.addEventListener(\"message\", (ev) => {\n      if (!ev.error && ev.data?.type === BROADCAST_CHANNELS_MSGS.ACCOUNT_IMPORTED) {\n        this.handleAccountImport(ev.data?.privKey);\n      }\n    });\n  }\n\n  private networkChangeChannel(): void {\n    const walletAccountImportChannel = new BroadcastChannel<PopupData<NetworkChangeChannelData>>(\n      `${BROADCAST_CHANNELS.WALLET_NETWORK_CHANGE_CHANNEL}_${this.instanceId}`,\n      broadcastChannelOptions\n    );\n    walletAccountImportChannel.addEventListener(\"message\", (ev) => {\n      if (!ev.error && ev.data?.type === BROADCAST_CHANNELS_MSGS.NETWORK_CHANGE) {\n        this.handleNetworkChange(ev.data?.network);\n      }\n    });\n  }\n\n  private selectedAddressChangeChannel(): void {\n    const walletAccountImportChannel = new BroadcastChannel<PopupData<SelectedAddresssChangeChannelData>>(\n      `${BROADCAST_CHANNELS.WALLET_SELECTED_ADDRESS_CHANNEL}_${this.instanceId}`,\n      broadcastChannelOptions\n    );\n    walletAccountImportChannel.addEventListener(\"message\", (ev) => {\n      if (!ev.error && ev.data?.type === BROADCAST_CHANNELS_MSGS.SELECTED_ADDRESS_CHANGE) {\n        this.handleSelectedAddressChange(ev.data?.selectedAddress);\n      }\n    });\n  }\n}\n","import { BroadcastChannel } from \"broadcast-channel\";\nimport log from \"loglevel\";\n\nimport { POPUP_LOADED, POPUP_RESULT } from \"../enums\";\nimport { broadcastChannelOptions, UserError } from \"../utils\";\nimport { PopupData, PopupHandlerConfig, PopupHandlerState, SuccessExtraFn } from \"./interfaces\";\nimport PopupHandler from \"./PopupHandler\";\n/**\n * PopupWithBcHandler is a PopupHandler which uses broadcast channel to communicate with the popup window.\n */\nclass PopupWithBcHandler<ReceiveData, SendData = unknown> extends PopupHandler {\n  bc: BroadcastChannel<PopupData<ReceiveData>>;\n\n  constructor({\n    config,\n    state,\n    instanceId,\n  }: {\n    config: Partial<PopupHandlerConfig>;\n    state: Partial<PopupHandlerState> & Pick<PopupHandlerState, \"url\">;\n    instanceId: string;\n  }) {\n    super({ config, state });\n    this.bc = new BroadcastChannel(instanceId, broadcastChannelOptions);\n  }\n\n  /**\n   * Receives the data from popup window and closes the window\n   * @param successExtraFn - Extra function to be called after the data is received\n   * @returns The data to be received\n   */\n  handle(successExtraFn?: SuccessExtraFn<ReceiveData>): Promise<ReceiveData> {\n    return new Promise((resolve, reject) => {\n      const closeListener = () => {\n        this.bc.close();\n        reject(new UserError(\"user closed popup\"));\n        this.removeListener(\"close\", closeListener);\n      };\n      this.on(\"close\", closeListener);\n\n      this.bc.addEventListener(\"message\", async (ev) => {\n        log.info(ev, `receiving data on channel: ${this.bc.name}`);\n        try {\n          const { error, data } = ev;\n          if (error) {\n            reject(new Error(error));\n            return;\n          }\n          if (successExtraFn) await successExtraFn.call(this, data);\n          resolve(data);\n        } catch (error) {\n          reject(error);\n        } finally {\n          this.bc.close();\n          this.close();\n        }\n      });\n      this.open()\n        .then(() => {\n          log.info(`opened window ${this.bc.name}`);\n          // Opened window. yay.  let the bc events do their job\n          return undefined;\n        })\n        .catch((err) => {\n          log.error(err, \"something went wrong while opening window\");\n          reject(err);\n        });\n    });\n  }\n\n  /**\n   * Use this if we have to send large payloads which don't fit in query/hash params.\n   * Waits for ack that popup window is ready to receive data.\n   * Receives the data from popup window and closes the window\n   * @param payload - The data to be sent to the popup window once we have ack that window is ready to receive data\n   * @param successExtraFn - Extra function to be called after the data is received\n   * @returns The data to be received\n   */\n  handleWithHandshake(payload: SendData, successExtraFn?: SuccessExtraFn<ReceiveData>): Promise<ReceiveData> {\n    return new Promise((resolve, reject) => {\n      const closeListener = () => {\n        this.bc.close();\n        reject(new UserError(\"user closed popup\"));\n        this.removeListener(\"close\", closeListener);\n      };\n      this.on(\"close\", closeListener);\n      this.bc.addEventListener(\"message\", async (ev) => {\n        try {\n          log.info(ev, `receiving data on channel: ${this.bc.name}`);\n          const { error, data } = ev;\n          if (error) {\n            reject(new Error(error));\n            return;\n          }\n          // Do handshake\n          const { type = \"\" } = data as { type?: string };\n          if (type === POPUP_LOADED) {\n            // Hack with generic to use the same type for both send and receive\n            await this.bc.postMessage({\n              data: payload,\n            } as unknown as PopupData<ReceiveData>);\n          } else if (type === POPUP_RESULT) {\n            if (successExtraFn) await successExtraFn.call(this, data);\n            resolve(data);\n            // Must only close the bc after result is done\n            this.bc.close();\n            this.close();\n          }\n        } catch (error) {\n          reject(error);\n          this.bc.close();\n          this.close();\n        }\n      });\n      this.open()\n        .then(() => {\n          log.info(`opened window ${this.bc.name}`);\n          // Opened window. yay.  let the bc events do their job\n          return undefined;\n        })\n        .catch((err) => {\n          log.error(err, \"something went wrong while opening window\");\n          reject(err);\n        });\n    });\n  }\n}\nexport default PopupWithBcHandler;\n","import { BroadcastChannel } from \"broadcast-channel\";\nimport log from \"loglevel\";\n\nimport { BROADCAST_CHANNELS, POPUP_LOADED, SETUP_COMPLETE } from \"../enums\";\nimport { PopupData } from \"../Popup\";\nimport { broadcastChannelOptions, handleRedirectParameters } from \"../utils/utils\";\n\nexport default class RedirectHandler {\n  private error: string;\n\n  private finalQueryParams: Record<string, string> = {};\n\n  private instanceParameters: Record<string, string>;\n\n  private hashParameters: Record<string, string>;\n\n  constructor() {\n    const { hash } = window.location;\n    const queryParameters = new URLSearchParams(window.location.search);\n    queryParameters.forEach((value, key) => {\n      this.finalQueryParams[key] = value;\n    });\n    const { error, instanceParameters, hashParameters } = handleRedirectParameters(hash, this.finalQueryParams);\n    this.error = error;\n    this.instanceParameters = instanceParameters;\n    this.hashParameters = hashParameters;\n  }\n\n  public async handle(): Promise<void> {\n    return new Promise((resolve, reject) => {\n      const { finalQueryParams, instanceParameters, hashParameters, error } = this;\n      let bc: BroadcastChannel<PopupData<unknown>>;\n      try {\n        if (!finalQueryParams.windowId) {\n          bc = new BroadcastChannel(`${BROADCAST_CHANNELS.REDIRECT_CHANNEL}_${instanceParameters.instanceId}`, broadcastChannelOptions);\n          bc.addEventListener(\"message\", async (ev) => {\n            if (ev.error) {\n              reject(ev.error);\n              window.close();\n            } else {\n              resolve();\n              bc.close();\n              log.info(\"posted\", { finalQueryParams, hashParameters, instanceParameters });\n            }\n          });\n          bc.postMessage({\n            data: {\n              instanceParams: instanceParameters,\n              hashParams: hashParameters,\n              queryParams: finalQueryParams,\n            },\n            error,\n          });\n\n          setTimeout(() => {\n            resolve();\n            window.location.href = window.location.origin + window.location.search + window.location.hash;\n          }, 5000);\n        } else {\n          bc = new BroadcastChannel(`${finalQueryParams.windowId}`, broadcastChannelOptions);\n          bc.addEventListener(\"message\", async (ev) => {\n            const { url, message } = ev.data as { url: string; message: string };\n            if (url) {\n              resolve();\n              window.location.href = url;\n            } else if (message === SETUP_COMPLETE) {\n              await bc.postMessage({\n                data: {\n                  windowId: finalQueryParams.windowId,\n                  message: POPUP_LOADED,\n                },\n              });\n            }\n            if (ev.error && ev.error !== \"\") {\n              log.error(ev.error);\n              resolve();\n              bc.close();\n            }\n          });\n        }\n      } catch (err: unknown) {\n        log.info(err as Error, \"something went wrong\");\n        reject(err);\n        if (bc) bc.close();\n        window.close();\n      }\n    });\n  }\n}\n","export { default as BroadcastChannelHandler } from \"./BroadcastChannelHandler\";\nexport * from \"./interfaces\";\nexport { default as PopupHandler } from \"./PopupHandler\";\nexport { default as PopupStoreChannel } from \"./PopupStoreChannel\";\nexport { default as PopupWithBcHandler } from \"./PopupWithBcHandler\";\nexport { default as RedirectHandler } from \"./RedirectHandler\";\nexport { default as StreamWindow } from \"./StreamWindow\";\n","module.exports = require(\"@babel/runtime/helpers/wrapNativeSuper\");","module.exports = require(\"bowser\");","export * from \"./Account/IAccountTrackerController\";\nexport { default as BaseController } from \"./BaseController\";\nexport * from \"./Block/BaseBlockTracker\";\nexport * from \"./Block/IBlockTrackerController\";\nexport { default as createEventEmitterProxy } from \"./createEventEmitterProxy\";\nexport { default as createSwappableProxy } from \"./createSwappableProxy\";\nexport * from \"./Currency/BaseCurrencyController\";\nexport * from \"./Currency/ICurrencyController\";\nexport * from \"./Embed/BaseEmbedController\";\nexport * from \"./Embed/CommunicationMethodMiddleware\";\nexport { default as CommunicationWindowManager } from \"./Embed/CommunicationWindowManager\";\nexport * from \"./Embed/IEmbedController\";\nexport * from \"./enums\";\nexport * from \"./interfaces\";\nexport * from \"./Keyring/BaseKeyringController\";\nexport * from \"./Keyring/IKeyringController\";\nexport * from \"./Network/createFetchMiddleware\";\nexport * from \"./Network/createLoggerMiddleware\";\nexport * from \"./Network/createOriginMiddleware\";\nexport * from \"./Network/INetworkController\";\nexport * from \"./Popup/index\";\nexport * from \"./Preferences/BasePreferencesController\";\nexport * from \"./Preferences/IPreferencesController\";\nexport * from \"./Transaction/BaseTransactionStateController\";\nexport * from \"./Transaction/ITransactionController\";\nexport * from \"./utils\";\n","/*!\n * The buffer module from node.js, for the browser.\n *\n * @author   Feross Aboukhadijeh <http://feross.org>\n * @license  MIT\n */\n/* eslint-disable no-proto */\n\n'use strict'\n\nvar base64 = require('base64-js')\nvar ieee754 = require('ieee754')\nvar isArray = require('isarray')\n\nexports.Buffer = Buffer\nexports.SlowBuffer = SlowBuffer\nexports.INSPECT_MAX_BYTES = 50\n\n/**\n * If `Buffer.TYPED_ARRAY_SUPPORT`:\n *   === true    Use Uint8Array implementation (fastest)\n *   === false   Use Object implementation (most compatible, even IE6)\n *\n * Browsers that support typed arrays are IE 10+, Firefox 4+, Chrome 7+, Safari 5.1+,\n * Opera 11.6+, iOS 4.2+.\n *\n * Due to various browser bugs, sometimes the Object implementation will be used even\n * when the browser supports typed arrays.\n *\n * Note:\n *\n *   - Firefox 4-29 lacks support for adding new properties to `Uint8Array` instances,\n *     See: https://bugzilla.mozilla.org/show_bug.cgi?id=695438.\n *\n *   - Chrome 9-10 is missing the `TypedArray.prototype.subarray` function.\n *\n *   - IE10 has a broken `TypedArray.prototype.subarray` function which returns arrays of\n *     incorrect length in some situations.\n\n * We detect these buggy browsers and set `Buffer.TYPED_ARRAY_SUPPORT` to `false` so they\n * get the Object implementation, which is slower but behaves correctly.\n */\nBuffer.TYPED_ARRAY_SUPPORT = global.TYPED_ARRAY_SUPPORT !== undefined\n  ? global.TYPED_ARRAY_SUPPORT\n  : typedArraySupport()\n\n/*\n * Export kMaxLength after typed array support is determined.\n */\nexports.kMaxLength = kMaxLength()\n\nfunction typedArraySupport () {\n  try {\n    var arr = new Uint8Array(1)\n    arr.__proto__ = {__proto__: Uint8Array.prototype, foo: function () { return 42 }}\n    return arr.foo() === 42 && // typed array instances can be augmented\n        typeof arr.subarray === 'function' && // chrome 9-10 lack `subarray`\n        arr.subarray(1, 1).byteLength === 0 // ie10 has broken `subarray`\n  } catch (e) {\n    return false\n  }\n}\n\nfunction kMaxLength () {\n  return Buffer.TYPED_ARRAY_SUPPORT\n    ? 0x7fffffff\n    : 0x3fffffff\n}\n\nfunction createBuffer (that, length) {\n  if (kMaxLength() < length) {\n    throw new RangeError('Invalid typed array length')\n  }\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    // Return an augmented `Uint8Array` instance, for best performance\n    that = new Uint8Array(length)\n    that.__proto__ = Buffer.prototype\n  } else {\n    // Fallback: Return an object instance of the Buffer class\n    if (that === null) {\n      that = new Buffer(length)\n    }\n    that.length = length\n  }\n\n  return that\n}\n\n/**\n * The Buffer constructor returns instances of `Uint8Array` that have their\n * prototype changed to `Buffer.prototype`. Furthermore, `Buffer` is a subclass of\n * `Uint8Array`, so the returned instances will have all the node `Buffer` methods\n * and the `Uint8Array` methods. Square bracket notation works as expected -- it\n * returns a single octet.\n *\n * The `Uint8Array` prototype remains unmodified.\n */\n\nfunction Buffer (arg, encodingOrOffset, length) {\n  if (!Buffer.TYPED_ARRAY_SUPPORT && !(this instanceof Buffer)) {\n    return new Buffer(arg, encodingOrOffset, length)\n  }\n\n  // Common case.\n  if (typeof arg === 'number') {\n    if (typeof encodingOrOffset === 'string') {\n      throw new Error(\n        'If encoding is specified then the first argument must be a string'\n      )\n    }\n    return allocUnsafe(this, arg)\n  }\n  return from(this, arg, encodingOrOffset, length)\n}\n\nBuffer.poolSize = 8192 // not used by this implementation\n\n// TODO: Legacy, not needed anymore. Remove in next major version.\nBuffer._augment = function (arr) {\n  arr.__proto__ = Buffer.prototype\n  return arr\n}\n\nfunction from (that, value, encodingOrOffset, length) {\n  if (typeof value === 'number') {\n    throw new TypeError('\"value\" argument must not be a number')\n  }\n\n  if (typeof ArrayBuffer !== 'undefined' && value instanceof ArrayBuffer) {\n    return fromArrayBuffer(that, value, encodingOrOffset, length)\n  }\n\n  if (typeof value === 'string') {\n    return fromString(that, value, encodingOrOffset)\n  }\n\n  return fromObject(that, value)\n}\n\n/**\n * Functionally equivalent to Buffer(arg, encoding) but throws a TypeError\n * if value is a number.\n * Buffer.from(str[, encoding])\n * Buffer.from(array)\n * Buffer.from(buffer)\n * Buffer.from(arrayBuffer[, byteOffset[, length]])\n **/\nBuffer.from = function (value, encodingOrOffset, length) {\n  return from(null, value, encodingOrOffset, length)\n}\n\nif (Buffer.TYPED_ARRAY_SUPPORT) {\n  Buffer.prototype.__proto__ = Uint8Array.prototype\n  Buffer.__proto__ = Uint8Array\n  if (typeof Symbol !== 'undefined' && Symbol.species &&\n      Buffer[Symbol.species] === Buffer) {\n    // Fix subarray() in ES2016. See: https://github.com/feross/buffer/pull/97\n    Object.defineProperty(Buffer, Symbol.species, {\n      value: null,\n      configurable: true\n    })\n  }\n}\n\nfunction assertSize (size) {\n  if (typeof size !== 'number') {\n    throw new TypeError('\"size\" argument must be a number')\n  } else if (size < 0) {\n    throw new RangeError('\"size\" argument must not be negative')\n  }\n}\n\nfunction alloc (that, size, fill, encoding) {\n  assertSize(size)\n  if (size <= 0) {\n    return createBuffer(that, size)\n  }\n  if (fill !== undefined) {\n    // Only pay attention to encoding if it's a string. This\n    // prevents accidentally sending in a number that would\n    // be interpretted as a start offset.\n    return typeof encoding === 'string'\n      ? createBuffer(that, size).fill(fill, encoding)\n      : createBuffer(that, size).fill(fill)\n  }\n  return createBuffer(that, size)\n}\n\n/**\n * Creates a new filled Buffer instance.\n * alloc(size[, fill[, encoding]])\n **/\nBuffer.alloc = function (size, fill, encoding) {\n  return alloc(null, size, fill, encoding)\n}\n\nfunction allocUnsafe (that, size) {\n  assertSize(size)\n  that = createBuffer(that, size < 0 ? 0 : checked(size) | 0)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) {\n    for (var i = 0; i < size; ++i) {\n      that[i] = 0\n    }\n  }\n  return that\n}\n\n/**\n * Equivalent to Buffer(num), by default creates a non-zero-filled Buffer instance.\n * */\nBuffer.allocUnsafe = function (size) {\n  return allocUnsafe(null, size)\n}\n/**\n * Equivalent to SlowBuffer(num), by default creates a non-zero-filled Buffer instance.\n */\nBuffer.allocUnsafeSlow = function (size) {\n  return allocUnsafe(null, size)\n}\n\nfunction fromString (that, string, encoding) {\n  if (typeof encoding !== 'string' || encoding === '') {\n    encoding = 'utf8'\n  }\n\n  if (!Buffer.isEncoding(encoding)) {\n    throw new TypeError('\"encoding\" must be a valid string encoding')\n  }\n\n  var length = byteLength(string, encoding) | 0\n  that = createBuffer(that, length)\n\n  var actual = that.write(string, encoding)\n\n  if (actual !== length) {\n    // Writing a hex string, for example, that contains invalid characters will\n    // cause everything after the first invalid character to be ignored. (e.g.\n    // 'abxxcd' will be treated as 'ab')\n    that = that.slice(0, actual)\n  }\n\n  return that\n}\n\nfunction fromArrayLike (that, array) {\n  var length = array.length < 0 ? 0 : checked(array.length) | 0\n  that = createBuffer(that, length)\n  for (var i = 0; i < length; i += 1) {\n    that[i] = array[i] & 255\n  }\n  return that\n}\n\nfunction fromArrayBuffer (that, array, byteOffset, length) {\n  array.byteLength // this throws if `array` is not a valid ArrayBuffer\n\n  if (byteOffset < 0 || array.byteLength < byteOffset) {\n    throw new RangeError('\\'offset\\' is out of bounds')\n  }\n\n  if (array.byteLength < byteOffset + (length || 0)) {\n    throw new RangeError('\\'length\\' is out of bounds')\n  }\n\n  if (byteOffset === undefined && length === undefined) {\n    array = new Uint8Array(array)\n  } else if (length === undefined) {\n    array = new Uint8Array(array, byteOffset)\n  } else {\n    array = new Uint8Array(array, byteOffset, length)\n  }\n\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    // Return an augmented `Uint8Array` instance, for best performance\n    that = array\n    that.__proto__ = Buffer.prototype\n  } else {\n    // Fallback: Return an object instance of the Buffer class\n    that = fromArrayLike(that, array)\n  }\n  return that\n}\n\nfunction fromObject (that, obj) {\n  if (Buffer.isBuffer(obj)) {\n    var len = checked(obj.length) | 0\n    that = createBuffer(that, len)\n\n    if (that.length === 0) {\n      return that\n    }\n\n    obj.copy(that, 0, 0, len)\n    return that\n  }\n\n  if (obj) {\n    if ((typeof ArrayBuffer !== 'undefined' &&\n        obj.buffer instanceof ArrayBuffer) || 'length' in obj) {\n      if (typeof obj.length !== 'number' || isnan(obj.length)) {\n        return createBuffer(that, 0)\n      }\n      return fromArrayLike(that, obj)\n    }\n\n    if (obj.type === 'Buffer' && isArray(obj.data)) {\n      return fromArrayLike(that, obj.data)\n    }\n  }\n\n  throw new TypeError('First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.')\n}\n\nfunction checked (length) {\n  // Note: cannot use `length < kMaxLength()` here because that fails when\n  // length is NaN (which is otherwise coerced to zero.)\n  if (length >= kMaxLength()) {\n    throw new RangeError('Attempt to allocate Buffer larger than maximum ' +\n                         'size: 0x' + kMaxLength().toString(16) + ' bytes')\n  }\n  return length | 0\n}\n\nfunction SlowBuffer (length) {\n  if (+length != length) { // eslint-disable-line eqeqeq\n    length = 0\n  }\n  return Buffer.alloc(+length)\n}\n\nBuffer.isBuffer = function isBuffer (b) {\n  return !!(b != null && b._isBuffer)\n}\n\nBuffer.compare = function compare (a, b) {\n  if (!Buffer.isBuffer(a) || !Buffer.isBuffer(b)) {\n    throw new TypeError('Arguments must be Buffers')\n  }\n\n  if (a === b) return 0\n\n  var x = a.length\n  var y = b.length\n\n  for (var i = 0, len = Math.min(x, y); i < len; ++i) {\n    if (a[i] !== b[i]) {\n      x = a[i]\n      y = b[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\nBuffer.isEncoding = function isEncoding (encoding) {\n  switch (String(encoding).toLowerCase()) {\n    case 'hex':\n    case 'utf8':\n    case 'utf-8':\n    case 'ascii':\n    case 'latin1':\n    case 'binary':\n    case 'base64':\n    case 'ucs2':\n    case 'ucs-2':\n    case 'utf16le':\n    case 'utf-16le':\n      return true\n    default:\n      return false\n  }\n}\n\nBuffer.concat = function concat (list, length) {\n  if (!isArray(list)) {\n    throw new TypeError('\"list\" argument must be an Array of Buffers')\n  }\n\n  if (list.length === 0) {\n    return Buffer.alloc(0)\n  }\n\n  var i\n  if (length === undefined) {\n    length = 0\n    for (i = 0; i < list.length; ++i) {\n      length += list[i].length\n    }\n  }\n\n  var buffer = Buffer.allocUnsafe(length)\n  var pos = 0\n  for (i = 0; i < list.length; ++i) {\n    var buf = list[i]\n    if (!Buffer.isBuffer(buf)) {\n      throw new TypeError('\"list\" argument must be an Array of Buffers')\n    }\n    buf.copy(buffer, pos)\n    pos += buf.length\n  }\n  return buffer\n}\n\nfunction byteLength (string, encoding) {\n  if (Buffer.isBuffer(string)) {\n    return string.length\n  }\n  if (typeof ArrayBuffer !== 'undefined' && typeof ArrayBuffer.isView === 'function' &&\n      (ArrayBuffer.isView(string) || string instanceof ArrayBuffer)) {\n    return string.byteLength\n  }\n  if (typeof string !== 'string') {\n    string = '' + string\n  }\n\n  var len = string.length\n  if (len === 0) return 0\n\n  // Use a for loop to avoid recursion\n  var loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'ascii':\n      case 'latin1':\n      case 'binary':\n        return len\n      case 'utf8':\n      case 'utf-8':\n      case undefined:\n        return utf8ToBytes(string).length\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return len * 2\n      case 'hex':\n        return len >>> 1\n      case 'base64':\n        return base64ToBytes(string).length\n      default:\n        if (loweredCase) return utf8ToBytes(string).length // assume utf8\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\nBuffer.byteLength = byteLength\n\nfunction slowToString (encoding, start, end) {\n  var loweredCase = false\n\n  // No need to verify that \"this.length <= MAX_UINT32\" since it's a read-only\n  // property of a typed array.\n\n  // This behaves neither like String nor Uint8Array in that we set start/end\n  // to their upper/lower bounds if the value passed is out of range.\n  // undefined is handled specially as per ECMA-262 6th Edition,\n  // Section 13.3.3.7 Runtime Semantics: KeyedBindingInitialization.\n  if (start === undefined || start < 0) {\n    start = 0\n  }\n  // Return early if start > this.length. Done here to prevent potential uint32\n  // coercion fail below.\n  if (start > this.length) {\n    return ''\n  }\n\n  if (end === undefined || end > this.length) {\n    end = this.length\n  }\n\n  if (end <= 0) {\n    return ''\n  }\n\n  // Force coersion to uint32. This will also coerce falsey/NaN values to 0.\n  end >>>= 0\n  start >>>= 0\n\n  if (end <= start) {\n    return ''\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  while (true) {\n    switch (encoding) {\n      case 'hex':\n        return hexSlice(this, start, end)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Slice(this, start, end)\n\n      case 'ascii':\n        return asciiSlice(this, start, end)\n\n      case 'latin1':\n      case 'binary':\n        return latin1Slice(this, start, end)\n\n      case 'base64':\n        return base64Slice(this, start, end)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return utf16leSlice(this, start, end)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = (encoding + '').toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\n// The property is used by `Buffer.isBuffer` and `is-buffer` (in Safari 5-7) to detect\n// Buffer instances.\nBuffer.prototype._isBuffer = true\n\nfunction swap (b, n, m) {\n  var i = b[n]\n  b[n] = b[m]\n  b[m] = i\n}\n\nBuffer.prototype.swap16 = function swap16 () {\n  var len = this.length\n  if (len % 2 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 16-bits')\n  }\n  for (var i = 0; i < len; i += 2) {\n    swap(this, i, i + 1)\n  }\n  return this\n}\n\nBuffer.prototype.swap32 = function swap32 () {\n  var len = this.length\n  if (len % 4 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 32-bits')\n  }\n  for (var i = 0; i < len; i += 4) {\n    swap(this, i, i + 3)\n    swap(this, i + 1, i + 2)\n  }\n  return this\n}\n\nBuffer.prototype.swap64 = function swap64 () {\n  var len = this.length\n  if (len % 8 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 64-bits')\n  }\n  for (var i = 0; i < len; i += 8) {\n    swap(this, i, i + 7)\n    swap(this, i + 1, i + 6)\n    swap(this, i + 2, i + 5)\n    swap(this, i + 3, i + 4)\n  }\n  return this\n}\n\nBuffer.prototype.toString = function toString () {\n  var length = this.length | 0\n  if (length === 0) return ''\n  if (arguments.length === 0) return utf8Slice(this, 0, length)\n  return slowToString.apply(this, arguments)\n}\n\nBuffer.prototype.equals = function equals (b) {\n  if (!Buffer.isBuffer(b)) throw new TypeError('Argument must be a Buffer')\n  if (this === b) return true\n  return Buffer.compare(this, b) === 0\n}\n\nBuffer.prototype.inspect = function inspect () {\n  var str = ''\n  var max = exports.INSPECT_MAX_BYTES\n  if (this.length > 0) {\n    str = this.toString('hex', 0, max).match(/.{2}/g).join(' ')\n    if (this.length > max) str += ' ... '\n  }\n  return '<Buffer ' + str + '>'\n}\n\nBuffer.prototype.compare = function compare (target, start, end, thisStart, thisEnd) {\n  if (!Buffer.isBuffer(target)) {\n    throw new TypeError('Argument must be a Buffer')\n  }\n\n  if (start === undefined) {\n    start = 0\n  }\n  if (end === undefined) {\n    end = target ? target.length : 0\n  }\n  if (thisStart === undefined) {\n    thisStart = 0\n  }\n  if (thisEnd === undefined) {\n    thisEnd = this.length\n  }\n\n  if (start < 0 || end > target.length || thisStart < 0 || thisEnd > this.length) {\n    throw new RangeError('out of range index')\n  }\n\n  if (thisStart >= thisEnd && start >= end) {\n    return 0\n  }\n  if (thisStart >= thisEnd) {\n    return -1\n  }\n  if (start >= end) {\n    return 1\n  }\n\n  start >>>= 0\n  end >>>= 0\n  thisStart >>>= 0\n  thisEnd >>>= 0\n\n  if (this === target) return 0\n\n  var x = thisEnd - thisStart\n  var y = end - start\n  var len = Math.min(x, y)\n\n  var thisCopy = this.slice(thisStart, thisEnd)\n  var targetCopy = target.slice(start, end)\n\n  for (var i = 0; i < len; ++i) {\n    if (thisCopy[i] !== targetCopy[i]) {\n      x = thisCopy[i]\n      y = targetCopy[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\n// Finds either the first index of `val` in `buffer` at offset >= `byteOffset`,\n// OR the last index of `val` in `buffer` at offset <= `byteOffset`.\n//\n// Arguments:\n// - buffer - a Buffer to search\n// - val - a string, Buffer, or number\n// - byteOffset - an index into `buffer`; will be clamped to an int32\n// - encoding - an optional encoding, relevant is val is a string\n// - dir - true for indexOf, false for lastIndexOf\nfunction bidirectionalIndexOf (buffer, val, byteOffset, encoding, dir) {\n  // Empty buffer means no match\n  if (buffer.length === 0) return -1\n\n  // Normalize byteOffset\n  if (typeof byteOffset === 'string') {\n    encoding = byteOffset\n    byteOffset = 0\n  } else if (byteOffset > 0x7fffffff) {\n    byteOffset = 0x7fffffff\n  } else if (byteOffset < -0x80000000) {\n    byteOffset = -0x80000000\n  }\n  byteOffset = +byteOffset  // Coerce to Number.\n  if (isNaN(byteOffset)) {\n    // byteOffset: it it's undefined, null, NaN, \"foo\", etc, search whole buffer\n    byteOffset = dir ? 0 : (buffer.length - 1)\n  }\n\n  // Normalize byteOffset: negative offsets start from the end of the buffer\n  if (byteOffset < 0) byteOffset = buffer.length + byteOffset\n  if (byteOffset >= buffer.length) {\n    if (dir) return -1\n    else byteOffset = buffer.length - 1\n  } else if (byteOffset < 0) {\n    if (dir) byteOffset = 0\n    else return -1\n  }\n\n  // Normalize val\n  if (typeof val === 'string') {\n    val = Buffer.from(val, encoding)\n  }\n\n  // Finally, search either indexOf (if dir is true) or lastIndexOf\n  if (Buffer.isBuffer(val)) {\n    // Special case: looking for empty string/buffer always fails\n    if (val.length === 0) {\n      return -1\n    }\n    return arrayIndexOf(buffer, val, byteOffset, encoding, dir)\n  } else if (typeof val === 'number') {\n    val = val & 0xFF // Search for a byte value [0-255]\n    if (Buffer.TYPED_ARRAY_SUPPORT &&\n        typeof Uint8Array.prototype.indexOf === 'function') {\n      if (dir) {\n        return Uint8Array.prototype.indexOf.call(buffer, val, byteOffset)\n      } else {\n        return Uint8Array.prototype.lastIndexOf.call(buffer, val, byteOffset)\n      }\n    }\n    return arrayIndexOf(buffer, [ val ], byteOffset, encoding, dir)\n  }\n\n  throw new TypeError('val must be string, number or Buffer')\n}\n\nfunction arrayIndexOf (arr, val, byteOffset, encoding, dir) {\n  var indexSize = 1\n  var arrLength = arr.length\n  var valLength = val.length\n\n  if (encoding !== undefined) {\n    encoding = String(encoding).toLowerCase()\n    if (encoding === 'ucs2' || encoding === 'ucs-2' ||\n        encoding === 'utf16le' || encoding === 'utf-16le') {\n      if (arr.length < 2 || val.length < 2) {\n        return -1\n      }\n      indexSize = 2\n      arrLength /= 2\n      valLength /= 2\n      byteOffset /= 2\n    }\n  }\n\n  function read (buf, i) {\n    if (indexSize === 1) {\n      return buf[i]\n    } else {\n      return buf.readUInt16BE(i * indexSize)\n    }\n  }\n\n  var i\n  if (dir) {\n    var foundIndex = -1\n    for (i = byteOffset; i < arrLength; i++) {\n      if (read(arr, i) === read(val, foundIndex === -1 ? 0 : i - foundIndex)) {\n        if (foundIndex === -1) foundIndex = i\n        if (i - foundIndex + 1 === valLength) return foundIndex * indexSize\n      } else {\n        if (foundIndex !== -1) i -= i - foundIndex\n        foundIndex = -1\n      }\n    }\n  } else {\n    if (byteOffset + valLength > arrLength) byteOffset = arrLength - valLength\n    for (i = byteOffset; i >= 0; i--) {\n      var found = true\n      for (var j = 0; j < valLength; j++) {\n        if (read(arr, i + j) !== read(val, j)) {\n          found = false\n          break\n        }\n      }\n      if (found) return i\n    }\n  }\n\n  return -1\n}\n\nBuffer.prototype.includes = function includes (val, byteOffset, encoding) {\n  return this.indexOf(val, byteOffset, encoding) !== -1\n}\n\nBuffer.prototype.indexOf = function indexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, true)\n}\n\nBuffer.prototype.lastIndexOf = function lastIndexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, false)\n}\n\nfunction hexWrite (buf, string, offset, length) {\n  offset = Number(offset) || 0\n  var remaining = buf.length - offset\n  if (!length) {\n    length = remaining\n  } else {\n    length = Number(length)\n    if (length > remaining) {\n      length = remaining\n    }\n  }\n\n  // must be an even number of digits\n  var strLen = string.length\n  if (strLen % 2 !== 0) throw new TypeError('Invalid hex string')\n\n  if (length > strLen / 2) {\n    length = strLen / 2\n  }\n  for (var i = 0; i < length; ++i) {\n    var parsed = parseInt(string.substr(i * 2, 2), 16)\n    if (isNaN(parsed)) return i\n    buf[offset + i] = parsed\n  }\n  return i\n}\n\nfunction utf8Write (buf, string, offset, length) {\n  return blitBuffer(utf8ToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nfunction asciiWrite (buf, string, offset, length) {\n  return blitBuffer(asciiToBytes(string), buf, offset, length)\n}\n\nfunction latin1Write (buf, string, offset, length) {\n  return asciiWrite(buf, string, offset, length)\n}\n\nfunction base64Write (buf, string, offset, length) {\n  return blitBuffer(base64ToBytes(string), buf, offset, length)\n}\n\nfunction ucs2Write (buf, string, offset, length) {\n  return blitBuffer(utf16leToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nBuffer.prototype.write = function write (string, offset, length, encoding) {\n  // Buffer#write(string)\n  if (offset === undefined) {\n    encoding = 'utf8'\n    length = this.length\n    offset = 0\n  // Buffer#write(string, encoding)\n  } else if (length === undefined && typeof offset === 'string') {\n    encoding = offset\n    length = this.length\n    offset = 0\n  // Buffer#write(string, offset[, length][, encoding])\n  } else if (isFinite(offset)) {\n    offset = offset | 0\n    if (isFinite(length)) {\n      length = length | 0\n      if (encoding === undefined) encoding = 'utf8'\n    } else {\n      encoding = length\n      length = undefined\n    }\n  // legacy write(string, encoding, offset, length) - remove in v0.13\n  } else {\n    throw new Error(\n      'Buffer.write(string, encoding, offset[, length]) is no longer supported'\n    )\n  }\n\n  var remaining = this.length - offset\n  if (length === undefined || length > remaining) length = remaining\n\n  if ((string.length > 0 && (length < 0 || offset < 0)) || offset > this.length) {\n    throw new RangeError('Attempt to write outside buffer bounds')\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  var loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'hex':\n        return hexWrite(this, string, offset, length)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Write(this, string, offset, length)\n\n      case 'ascii':\n        return asciiWrite(this, string, offset, length)\n\n      case 'latin1':\n      case 'binary':\n        return latin1Write(this, string, offset, length)\n\n      case 'base64':\n        // Warning: maxLength not taken into account in base64Write\n        return base64Write(this, string, offset, length)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return ucs2Write(this, string, offset, length)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\nBuffer.prototype.toJSON = function toJSON () {\n  return {\n    type: 'Buffer',\n    data: Array.prototype.slice.call(this._arr || this, 0)\n  }\n}\n\nfunction base64Slice (buf, start, end) {\n  if (start === 0 && end === buf.length) {\n    return base64.fromByteArray(buf)\n  } else {\n    return base64.fromByteArray(buf.slice(start, end))\n  }\n}\n\nfunction utf8Slice (buf, start, end) {\n  end = Math.min(buf.length, end)\n  var res = []\n\n  var i = start\n  while (i < end) {\n    var firstByte = buf[i]\n    var codePoint = null\n    var bytesPerSequence = (firstByte > 0xEF) ? 4\n      : (firstByte > 0xDF) ? 3\n      : (firstByte > 0xBF) ? 2\n      : 1\n\n    if (i + bytesPerSequence <= end) {\n      var secondByte, thirdByte, fourthByte, tempCodePoint\n\n      switch (bytesPerSequence) {\n        case 1:\n          if (firstByte < 0x80) {\n            codePoint = firstByte\n          }\n          break\n        case 2:\n          secondByte = buf[i + 1]\n          if ((secondByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0x1F) << 0x6 | (secondByte & 0x3F)\n            if (tempCodePoint > 0x7F) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 3:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0xC | (secondByte & 0x3F) << 0x6 | (thirdByte & 0x3F)\n            if (tempCodePoint > 0x7FF && (tempCodePoint < 0xD800 || tempCodePoint > 0xDFFF)) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 4:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          fourthByte = buf[i + 3]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80 && (fourthByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0x12 | (secondByte & 0x3F) << 0xC | (thirdByte & 0x3F) << 0x6 | (fourthByte & 0x3F)\n            if (tempCodePoint > 0xFFFF && tempCodePoint < 0x110000) {\n              codePoint = tempCodePoint\n            }\n          }\n      }\n    }\n\n    if (codePoint === null) {\n      // we did not generate a valid codePoint so insert a\n      // replacement char (U+FFFD) and advance only 1 byte\n      codePoint = 0xFFFD\n      bytesPerSequence = 1\n    } else if (codePoint > 0xFFFF) {\n      // encode to utf16 (surrogate pair dance)\n      codePoint -= 0x10000\n      res.push(codePoint >>> 10 & 0x3FF | 0xD800)\n      codePoint = 0xDC00 | codePoint & 0x3FF\n    }\n\n    res.push(codePoint)\n    i += bytesPerSequence\n  }\n\n  return decodeCodePointsArray(res)\n}\n\n// Based on http://stackoverflow.com/a/22747272/680742, the browser with\n// the lowest limit is Chrome, with 0x10000 args.\n// We go 1 magnitude less, for safety\nvar MAX_ARGUMENTS_LENGTH = 0x1000\n\nfunction decodeCodePointsArray (codePoints) {\n  var len = codePoints.length\n  if (len <= MAX_ARGUMENTS_LENGTH) {\n    return String.fromCharCode.apply(String, codePoints) // avoid extra slice()\n  }\n\n  // Decode in chunks to avoid \"call stack size exceeded\".\n  var res = ''\n  var i = 0\n  while (i < len) {\n    res += String.fromCharCode.apply(\n      String,\n      codePoints.slice(i, i += MAX_ARGUMENTS_LENGTH)\n    )\n  }\n  return res\n}\n\nfunction asciiSlice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i] & 0x7F)\n  }\n  return ret\n}\n\nfunction latin1Slice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i])\n  }\n  return ret\n}\n\nfunction hexSlice (buf, start, end) {\n  var len = buf.length\n\n  if (!start || start < 0) start = 0\n  if (!end || end < 0 || end > len) end = len\n\n  var out = ''\n  for (var i = start; i < end; ++i) {\n    out += toHex(buf[i])\n  }\n  return out\n}\n\nfunction utf16leSlice (buf, start, end) {\n  var bytes = buf.slice(start, end)\n  var res = ''\n  for (var i = 0; i < bytes.length; i += 2) {\n    res += String.fromCharCode(bytes[i] + bytes[i + 1] * 256)\n  }\n  return res\n}\n\nBuffer.prototype.slice = function slice (start, end) {\n  var len = this.length\n  start = ~~start\n  end = end === undefined ? len : ~~end\n\n  if (start < 0) {\n    start += len\n    if (start < 0) start = 0\n  } else if (start > len) {\n    start = len\n  }\n\n  if (end < 0) {\n    end += len\n    if (end < 0) end = 0\n  } else if (end > len) {\n    end = len\n  }\n\n  if (end < start) end = start\n\n  var newBuf\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    newBuf = this.subarray(start, end)\n    newBuf.__proto__ = Buffer.prototype\n  } else {\n    var sliceLen = end - start\n    newBuf = new Buffer(sliceLen, undefined)\n    for (var i = 0; i < sliceLen; ++i) {\n      newBuf[i] = this[i + start]\n    }\n  }\n\n  return newBuf\n}\n\n/*\n * Need to make sure that buffer isn't trying to write out of bounds.\n */\nfunction checkOffset (offset, ext, length) {\n  if ((offset % 1) !== 0 || offset < 0) throw new RangeError('offset is not uint')\n  if (offset + ext > length) throw new RangeError('Trying to access beyond buffer length')\n}\n\nBuffer.prototype.readUIntLE = function readUIntLE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUIntBE = function readUIntBE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    checkOffset(offset, byteLength, this.length)\n  }\n\n  var val = this[offset + --byteLength]\n  var mul = 1\n  while (byteLength > 0 && (mul *= 0x100)) {\n    val += this[offset + --byteLength] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUInt8 = function readUInt8 (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  return this[offset]\n}\n\nBuffer.prototype.readUInt16LE = function readUInt16LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return this[offset] | (this[offset + 1] << 8)\n}\n\nBuffer.prototype.readUInt16BE = function readUInt16BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return (this[offset] << 8) | this[offset + 1]\n}\n\nBuffer.prototype.readUInt32LE = function readUInt32LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return ((this[offset]) |\n      (this[offset + 1] << 8) |\n      (this[offset + 2] << 16)) +\n      (this[offset + 3] * 0x1000000)\n}\n\nBuffer.prototype.readUInt32BE = function readUInt32BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] * 0x1000000) +\n    ((this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    this[offset + 3])\n}\n\nBuffer.prototype.readIntLE = function readIntLE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readIntBE = function readIntBE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var i = byteLength\n  var mul = 1\n  var val = this[offset + --i]\n  while (i > 0 && (mul *= 0x100)) {\n    val += this[offset + --i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readInt8 = function readInt8 (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  if (!(this[offset] & 0x80)) return (this[offset])\n  return ((0xff - this[offset] + 1) * -1)\n}\n\nBuffer.prototype.readInt16LE = function readInt16LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset] | (this[offset + 1] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt16BE = function readInt16BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset + 1] | (this[offset] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt32LE = function readInt32LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset]) |\n    (this[offset + 1] << 8) |\n    (this[offset + 2] << 16) |\n    (this[offset + 3] << 24)\n}\n\nBuffer.prototype.readInt32BE = function readInt32BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] << 24) |\n    (this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    (this[offset + 3])\n}\n\nBuffer.prototype.readFloatLE = function readFloatLE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, true, 23, 4)\n}\n\nBuffer.prototype.readFloatBE = function readFloatBE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, false, 23, 4)\n}\n\nBuffer.prototype.readDoubleLE = function readDoubleLE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, true, 52, 8)\n}\n\nBuffer.prototype.readDoubleBE = function readDoubleBE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, false, 52, 8)\n}\n\nfunction checkInt (buf, value, offset, ext, max, min) {\n  if (!Buffer.isBuffer(buf)) throw new TypeError('\"buffer\" argument must be a Buffer instance')\n  if (value > max || value < min) throw new RangeError('\"value\" argument is out of bounds')\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n}\n\nBuffer.prototype.writeUIntLE = function writeUIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    var maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  var mul = 1\n  var i = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUIntBE = function writeUIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    var maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  var i = byteLength - 1\n  var mul = 1\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUInt8 = function writeUInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0xff, 0)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nfunction objectWriteUInt16 (buf, value, offset, littleEndian) {\n  if (value < 0) value = 0xffff + value + 1\n  for (var i = 0, j = Math.min(buf.length - offset, 2); i < j; ++i) {\n    buf[offset + i] = (value & (0xff << (8 * (littleEndian ? i : 1 - i)))) >>>\n      (littleEndian ? i : 1 - i) * 8\n  }\n}\n\nBuffer.prototype.writeUInt16LE = function writeUInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n  } else {\n    objectWriteUInt16(this, value, offset, true)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeUInt16BE = function writeUInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 8)\n    this[offset + 1] = (value & 0xff)\n  } else {\n    objectWriteUInt16(this, value, offset, false)\n  }\n  return offset + 2\n}\n\nfunction objectWriteUInt32 (buf, value, offset, littleEndian) {\n  if (value < 0) value = 0xffffffff + value + 1\n  for (var i = 0, j = Math.min(buf.length - offset, 4); i < j; ++i) {\n    buf[offset + i] = (value >>> (littleEndian ? i : 3 - i) * 8) & 0xff\n  }\n}\n\nBuffer.prototype.writeUInt32LE = function writeUInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset + 3] = (value >>> 24)\n    this[offset + 2] = (value >>> 16)\n    this[offset + 1] = (value >>> 8)\n    this[offset] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, true)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeUInt32BE = function writeUInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 24)\n    this[offset + 1] = (value >>> 16)\n    this[offset + 2] = (value >>> 8)\n    this[offset + 3] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, false)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeIntLE = function writeIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) {\n    var limit = Math.pow(2, 8 * byteLength - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  var i = 0\n  var mul = 1\n  var sub = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i - 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeIntBE = function writeIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) {\n    var limit = Math.pow(2, 8 * byteLength - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  var i = byteLength - 1\n  var mul = 1\n  var sub = 0\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i + 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeInt8 = function writeInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0x7f, -0x80)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)\n  if (value < 0) value = 0xff + value + 1\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nBuffer.prototype.writeInt16LE = function writeInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n  } else {\n    objectWriteUInt16(this, value, offset, true)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeInt16BE = function writeInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 8)\n    this[offset + 1] = (value & 0xff)\n  } else {\n    objectWriteUInt16(this, value, offset, false)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeInt32LE = function writeInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n    this[offset + 2] = (value >>> 16)\n    this[offset + 3] = (value >>> 24)\n  } else {\n    objectWriteUInt32(this, value, offset, true)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeInt32BE = function writeInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (value < 0) value = 0xffffffff + value + 1\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 24)\n    this[offset + 1] = (value >>> 16)\n    this[offset + 2] = (value >>> 8)\n    this[offset + 3] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, false)\n  }\n  return offset + 4\n}\n\nfunction checkIEEE754 (buf, value, offset, ext, max, min) {\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n  if (offset < 0) throw new RangeError('Index out of range')\n}\n\nfunction writeFloat (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 4, 3.4028234663852886e+38, -3.4028234663852886e+38)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 23, 4)\n  return offset + 4\n}\n\nBuffer.prototype.writeFloatLE = function writeFloatLE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeFloatBE = function writeFloatBE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, false, noAssert)\n}\n\nfunction writeDouble (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 8, 1.7976931348623157E+308, -1.7976931348623157E+308)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 52, 8)\n  return offset + 8\n}\n\nBuffer.prototype.writeDoubleLE = function writeDoubleLE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeDoubleBE = function writeDoubleBE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, false, noAssert)\n}\n\n// copy(targetBuffer, targetStart=0, sourceStart=0, sourceEnd=buffer.length)\nBuffer.prototype.copy = function copy (target, targetStart, start, end) {\n  if (!start) start = 0\n  if (!end && end !== 0) end = this.length\n  if (targetStart >= target.length) targetStart = target.length\n  if (!targetStart) targetStart = 0\n  if (end > 0 && end < start) end = start\n\n  // Copy 0 bytes; we're done\n  if (end === start) return 0\n  if (target.length === 0 || this.length === 0) return 0\n\n  // Fatal error conditions\n  if (targetStart < 0) {\n    throw new RangeError('targetStart out of bounds')\n  }\n  if (start < 0 || start >= this.length) throw new RangeError('sourceStart out of bounds')\n  if (end < 0) throw new RangeError('sourceEnd out of bounds')\n\n  // Are we oob?\n  if (end > this.length) end = this.length\n  if (target.length - targetStart < end - start) {\n    end = target.length - targetStart + start\n  }\n\n  var len = end - start\n  var i\n\n  if (this === target && start < targetStart && targetStart < end) {\n    // descending copy from end\n    for (i = len - 1; i >= 0; --i) {\n      target[i + targetStart] = this[i + start]\n    }\n  } else if (len < 1000 || !Buffer.TYPED_ARRAY_SUPPORT) {\n    // ascending copy from start\n    for (i = 0; i < len; ++i) {\n      target[i + targetStart] = this[i + start]\n    }\n  } else {\n    Uint8Array.prototype.set.call(\n      target,\n      this.subarray(start, start + len),\n      targetStart\n    )\n  }\n\n  return len\n}\n\n// Usage:\n//    buffer.fill(number[, offset[, end]])\n//    buffer.fill(buffer[, offset[, end]])\n//    buffer.fill(string[, offset[, end]][, encoding])\nBuffer.prototype.fill = function fill (val, start, end, encoding) {\n  // Handle string cases:\n  if (typeof val === 'string') {\n    if (typeof start === 'string') {\n      encoding = start\n      start = 0\n      end = this.length\n    } else if (typeof end === 'string') {\n      encoding = end\n      end = this.length\n    }\n    if (val.length === 1) {\n      var code = val.charCodeAt(0)\n      if (code < 256) {\n        val = code\n      }\n    }\n    if (encoding !== undefined && typeof encoding !== 'string') {\n      throw new TypeError('encoding must be a string')\n    }\n    if (typeof encoding === 'string' && !Buffer.isEncoding(encoding)) {\n      throw new TypeError('Unknown encoding: ' + encoding)\n    }\n  } else if (typeof val === 'number') {\n    val = val & 255\n  }\n\n  // Invalid ranges are not set to a default, so can range check early.\n  if (start < 0 || this.length < start || this.length < end) {\n    throw new RangeError('Out of range index')\n  }\n\n  if (end <= start) {\n    return this\n  }\n\n  start = start >>> 0\n  end = end === undefined ? this.length : end >>> 0\n\n  if (!val) val = 0\n\n  var i\n  if (typeof val === 'number') {\n    for (i = start; i < end; ++i) {\n      this[i] = val\n    }\n  } else {\n    var bytes = Buffer.isBuffer(val)\n      ? val\n      : utf8ToBytes(new Buffer(val, encoding).toString())\n    var len = bytes.length\n    for (i = 0; i < end - start; ++i) {\n      this[i + start] = bytes[i % len]\n    }\n  }\n\n  return this\n}\n\n// HELPER FUNCTIONS\n// ================\n\nvar INVALID_BASE64_RE = /[^+\\/0-9A-Za-z-_]/g\n\nfunction base64clean (str) {\n  // Node strips out invalid characters like \\n and \\t from the string, base64-js does not\n  str = stringtrim(str).replace(INVALID_BASE64_RE, '')\n  // Node converts strings with length < 2 to ''\n  if (str.length < 2) return ''\n  // Node allows for non-padded base64 strings (missing trailing ===), base64-js does not\n  while (str.length % 4 !== 0) {\n    str = str + '='\n  }\n  return str\n}\n\nfunction stringtrim (str) {\n  if (str.trim) return str.trim()\n  return str.replace(/^\\s+|\\s+$/g, '')\n}\n\nfunction toHex (n) {\n  if (n < 16) return '0' + n.toString(16)\n  return n.toString(16)\n}\n\nfunction utf8ToBytes (string, units) {\n  units = units || Infinity\n  var codePoint\n  var length = string.length\n  var leadSurrogate = null\n  var bytes = []\n\n  for (var i = 0; i < length; ++i) {\n    codePoint = string.charCodeAt(i)\n\n    // is surrogate component\n    if (codePoint > 0xD7FF && codePoint < 0xE000) {\n      // last char was a lead\n      if (!leadSurrogate) {\n        // no lead yet\n        if (codePoint > 0xDBFF) {\n          // unexpected trail\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        } else if (i + 1 === length) {\n          // unpaired lead\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        }\n\n        // valid lead\n        leadSurrogate = codePoint\n\n        continue\n      }\n\n      // 2 leads in a row\n      if (codePoint < 0xDC00) {\n        if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n        leadSurrogate = codePoint\n        continue\n      }\n\n      // valid surrogate pair\n      codePoint = (leadSurrogate - 0xD800 << 10 | codePoint - 0xDC00) + 0x10000\n    } else if (leadSurrogate) {\n      // valid bmp char, but last char was a lead\n      if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n    }\n\n    leadSurrogate = null\n\n    // encode utf8\n    if (codePoint < 0x80) {\n      if ((units -= 1) < 0) break\n      bytes.push(codePoint)\n    } else if (codePoint < 0x800) {\n      if ((units -= 2) < 0) break\n      bytes.push(\n        codePoint >> 0x6 | 0xC0,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x10000) {\n      if ((units -= 3) < 0) break\n      bytes.push(\n        codePoint >> 0xC | 0xE0,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x110000) {\n      if ((units -= 4) < 0) break\n      bytes.push(\n        codePoint >> 0x12 | 0xF0,\n        codePoint >> 0xC & 0x3F | 0x80,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else {\n      throw new Error('Invalid code point')\n    }\n  }\n\n  return bytes\n}\n\nfunction asciiToBytes (str) {\n  var byteArray = []\n  for (var i = 0; i < str.length; ++i) {\n    // Node's code seems to be doing this and not & 0x7F..\n    byteArray.push(str.charCodeAt(i) & 0xFF)\n  }\n  return byteArray\n}\n\nfunction utf16leToBytes (str, units) {\n  var c, hi, lo\n  var byteArray = []\n  for (var i = 0; i < str.length; ++i) {\n    if ((units -= 2) < 0) break\n\n    c = str.charCodeAt(i)\n    hi = c >> 8\n    lo = c % 256\n    byteArray.push(lo)\n    byteArray.push(hi)\n  }\n\n  return byteArray\n}\n\nfunction base64ToBytes (str) {\n  return base64.toByteArray(base64clean(str))\n}\n\nfunction blitBuffer (src, dst, offset, length) {\n  for (var i = 0; i < length; ++i) {\n    if ((i + offset >= dst.length) || (i >= src.length)) break\n    dst[i + offset] = src[i]\n  }\n  return i\n}\n\nfunction isnan (val) {\n  return val !== val // eslint-disable-line no-self-compare\n}\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","'use strict'\n\nexports.byteLength = byteLength\nexports.toByteArray = toByteArray\nexports.fromByteArray = fromByteArray\n\nvar lookup = []\nvar revLookup = []\nvar Arr = typeof Uint8Array !== 'undefined' ? Uint8Array : Array\n\nvar code = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'\nfor (var i = 0, len = code.length; i < len; ++i) {\n  lookup[i] = code[i]\n  revLookup[code.charCodeAt(i)] = i\n}\n\n// Support decoding URL-safe base64 strings, as Node.js does.\n// See: https://en.wikipedia.org/wiki/Base64#URL_applications\nrevLookup['-'.charCodeAt(0)] = 62\nrevLookup['_'.charCodeAt(0)] = 63\n\nfunction getLens (b64) {\n  var len = b64.length\n\n  if (len % 4 > 0) {\n    throw new Error('Invalid string. Length must be a multiple of 4')\n  }\n\n  // Trim off extra bytes after placeholder bytes are found\n  // See: https://github.com/beatgammit/base64-js/issues/42\n  var validLen = b64.indexOf('=')\n  if (validLen === -1) validLen = len\n\n  var placeHoldersLen = validLen === len\n    ? 0\n    : 4 - (validLen % 4)\n\n  return [validLen, placeHoldersLen]\n}\n\n// base64 is 4/3 + up to two characters of the original data\nfunction byteLength (b64) {\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction _byteLength (b64, validLen, placeHoldersLen) {\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction toByteArray (b64) {\n  var tmp\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n\n  var arr = new Arr(_byteLength(b64, validLen, placeHoldersLen))\n\n  var curByte = 0\n\n  // if there are placeholders, only get up to the last complete 4 chars\n  var len = placeHoldersLen > 0\n    ? validLen - 4\n    : validLen\n\n  var i\n  for (i = 0; i < len; i += 4) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 18) |\n      (revLookup[b64.charCodeAt(i + 1)] << 12) |\n      (revLookup[b64.charCodeAt(i + 2)] << 6) |\n      revLookup[b64.charCodeAt(i + 3)]\n    arr[curByte++] = (tmp >> 16) & 0xFF\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 2) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 2) |\n      (revLookup[b64.charCodeAt(i + 1)] >> 4)\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 1) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 10) |\n      (revLookup[b64.charCodeAt(i + 1)] << 4) |\n      (revLookup[b64.charCodeAt(i + 2)] >> 2)\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  return arr\n}\n\nfunction tripletToBase64 (num) {\n  return lookup[num >> 18 & 0x3F] +\n    lookup[num >> 12 & 0x3F] +\n    lookup[num >> 6 & 0x3F] +\n    lookup[num & 0x3F]\n}\n\nfunction encodeChunk (uint8, start, end) {\n  var tmp\n  var output = []\n  for (var i = start; i < end; i += 3) {\n    tmp =\n      ((uint8[i] << 16) & 0xFF0000) +\n      ((uint8[i + 1] << 8) & 0xFF00) +\n      (uint8[i + 2] & 0xFF)\n    output.push(tripletToBase64(tmp))\n  }\n  return output.join('')\n}\n\nfunction fromByteArray (uint8) {\n  var tmp\n  var len = uint8.length\n  var extraBytes = len % 3 // if we have 1 byte left, pad 2 bytes\n  var parts = []\n  var maxChunkLength = 16383 // must be multiple of 3\n\n  // go through the array every three bytes, we'll deal with trailing stuff later\n  for (var i = 0, len2 = len - extraBytes; i < len2; i += maxChunkLength) {\n    parts.push(encodeChunk(uint8, i, (i + maxChunkLength) > len2 ? len2 : (i + maxChunkLength)))\n  }\n\n  // pad the end with zeros, but make sure to not forget the extra bytes\n  if (extraBytes === 1) {\n    tmp = uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 2] +\n      lookup[(tmp << 4) & 0x3F] +\n      '=='\n    )\n  } else if (extraBytes === 2) {\n    tmp = (uint8[len - 2] << 8) + uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 10] +\n      lookup[(tmp >> 4) & 0x3F] +\n      lookup[(tmp << 2) & 0x3F] +\n      '='\n    )\n  }\n\n  return parts.join('')\n}\n","/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */\nexports.read = function (buffer, offset, isLE, mLen, nBytes) {\n  var e, m\n  var eLen = (nBytes * 8) - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var nBits = -7\n  var i = isLE ? (nBytes - 1) : 0\n  var d = isLE ? -1 : 1\n  var s = buffer[offset + i]\n\n  i += d\n\n  e = s & ((1 << (-nBits)) - 1)\n  s >>= (-nBits)\n  nBits += eLen\n  for (; nBits > 0; e = (e * 256) + buffer[offset + i], i += d, nBits -= 8) {}\n\n  m = e & ((1 << (-nBits)) - 1)\n  e >>= (-nBits)\n  nBits += mLen\n  for (; nBits > 0; m = (m * 256) + buffer[offset + i], i += d, nBits -= 8) {}\n\n  if (e === 0) {\n    e = 1 - eBias\n  } else if (e === eMax) {\n    return m ? NaN : ((s ? -1 : 1) * Infinity)\n  } else {\n    m = m + Math.pow(2, mLen)\n    e = e - eBias\n  }\n  return (s ? -1 : 1) * m * Math.pow(2, e - mLen)\n}\n\nexports.write = function (buffer, value, offset, isLE, mLen, nBytes) {\n  var e, m, c\n  var eLen = (nBytes * 8) - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var rt = (mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0)\n  var i = isLE ? 0 : (nBytes - 1)\n  var d = isLE ? 1 : -1\n  var s = value < 0 || (value === 0 && 1 / value < 0) ? 1 : 0\n\n  value = Math.abs(value)\n\n  if (isNaN(value) || value === Infinity) {\n    m = isNaN(value) ? 1 : 0\n    e = eMax\n  } else {\n    e = Math.floor(Math.log(value) / Math.LN2)\n    if (value * (c = Math.pow(2, -e)) < 1) {\n      e--\n      c *= 2\n    }\n    if (e + eBias >= 1) {\n      value += rt / c\n    } else {\n      value += rt * Math.pow(2, 1 - eBias)\n    }\n    if (value * c >= 2) {\n      e++\n      c /= 2\n    }\n\n    if (e + eBias >= eMax) {\n      m = 0\n      e = eMax\n    } else if (e + eBias >= 1) {\n      m = ((value * c) - 1) * Math.pow(2, mLen)\n      e = e + eBias\n    } else {\n      m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen)\n      e = 0\n    }\n  }\n\n  for (; mLen >= 8; buffer[offset + i] = m & 0xff, i += d, m /= 256, mLen -= 8) {}\n\n  e = (e << mLen) | m\n  eLen += mLen\n  for (; eLen > 0; buffer[offset + i] = e & 0xff, i += d, e /= 256, eLen -= 8) {}\n\n  buffer[offset + i - d] |= s * 128\n}\n","var toString = {}.toString;\n\nmodule.exports = Array.isArray || function (arr) {\n  return toString.call(arr) == '[object Array]';\n};\n"],"sourceRoot":""}