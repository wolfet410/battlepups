module.exports =
/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 48);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ (function(module, exports) {

module.exports = require("@babel/runtime/regenerator");

/***/ }),
/* 1 */
/***/ (function(module, exports) {

module.exports = require("@babel/runtime/helpers/defineProperty");

/***/ }),
/* 2 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "u", function() { return FEATURES_PROVIDER_CHANGE_WINDOW; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "t", function() { return FEATURES_DEFAULT_WALLET_WINDOW; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "s", function() { return FEATURES_DEFAULT_POPUP_WINDOW; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "r", function() { return FEATURES_CONFIRM_WINDOW; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "v", function() { return POPUP_LOADED; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "w", function() { return POPUP_RESULT; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "z", function() { return SETUP_COMPLETE; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return ACTIVITY_ACTION_ALL; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "c", function() { return ACTIVITY_ACTION_SEND; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return ACTIVITY_ACTION_RECEIVE; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "d", function() { return ACTIVITY_ACTION_TOPUP; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "e", function() { return ACTIVITY_PERIOD_ALL; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "h", function() { return ACTIVITY_PERIOD_WEEK_ONE; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "f", function() { return ACTIVITY_PERIOD_MONTH_ONE; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "g", function() { return ACTIVITY_PERIOD_MONTH_SIX; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "l", function() { return ACTIVITY_STATUS_SUCCESSFUL; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "m", function() { return ACTIVITY_STATUS_UNSUCCESSFUL; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "k", function() { return ACTIVITY_STATUS_PENDING; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "i", function() { return ACTIVITY_STATUS_CANCELLED; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "j", function() { return ACTIVITY_STATUS_CANCELLING; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "q", function() { return COMMUNICATION_NOTIFICATIONS; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "p", function() { return COMMUNICATION_JRPC_METHODS; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "x", function() { return PROVIDER_JRPC_METHODS; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "y", function() { return PROVIDER_NOTIFICATIONS; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "n", function() { return BROADCAST_CHANNELS; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "o", function() { return BROADCAST_CHANNELS_MSGS; });
var FEATURES_PROVIDER_CHANGE_WINDOW = {
  height: 660,
  width: 375
};
var FEATURES_DEFAULT_WALLET_WINDOW = {
  height: 740,
  width: 1315
};
var FEATURES_DEFAULT_POPUP_WINDOW = {
  height: 700,
  width: 1200
};
var FEATURES_CONFIRM_WINDOW = {
  height: 700,
  width: 450
};
var POPUP_LOADED = "popup_loaded";
var POPUP_RESULT = "popup_result";
var SETUP_COMPLETE = "setup_complete";
var ACTIVITY_ACTION_ALL = "walletActivity.allTransactions";
var ACTIVITY_ACTION_SEND = "walletActivity.send";
var ACTIVITY_ACTION_RECEIVE = "walletActivity.receive";
var ACTIVITY_ACTION_TOPUP = "walletActivity.topup";
var ACTIVITY_PERIOD_ALL = "walletActivity.all";
var ACTIVITY_PERIOD_WEEK_ONE = "walletActivity.lastOneWeek";
var ACTIVITY_PERIOD_MONTH_ONE = "walletActivity.lastOneMonth";
var ACTIVITY_PERIOD_MONTH_SIX = "walletActivity.lastSixMonts";
var ACTIVITY_STATUS_SUCCESSFUL = "walletActivity.successful";
var ACTIVITY_STATUS_UNSUCCESSFUL = "walletActivity.unsuccessful";
var ACTIVITY_STATUS_PENDING = "walletActivity.pending";
var ACTIVITY_STATUS_CANCELLED = "walletActivity.cancelled";
var ACTIVITY_STATUS_CANCELLING = "walletActivity.cancelling";
var COMMUNICATION_NOTIFICATIONS = {
  IFRAME_STATUS: "iframe_status",
  // Tell embed to create the window
  CREATE_WINDOW: "create_window",
  // Tell embed to close the window
  CLOSE_WINDOW: "close_window",
  USER_LOGGED_IN: "user_logged_in",
  USER_LOGGED_OUT: "user_logged_out"
};
var COMMUNICATION_JRPC_METHODS = {
  LOGOUT: "logout",
  WALLET_INSTANCE_ID: "wallet_instance_id",
  USER_INFO: "user_info",
  SET_PROVIDER: "set_provider",
  TOPUP: "topup",
  IFRAME_STATUS: "iframe_status",
  // embed has opened the window as requested
  OPENED_WINDOW: "opened_window",
  // user has closed the window from embed's side
  CLOSED_WINDOW: "closed_window",
  GET_PROVIDER_STATE: "get_provider_state"
};
var PROVIDER_JRPC_METHODS = {
  GET_PROVIDER_STATE: "wallet_get_provider_state"
};
var PROVIDER_NOTIFICATIONS = {
  ACCOUNTS_CHANGED: "wallet_accounts_changed",
  CHAIN_CHANGED: "wallet_chain_changed",
  UNLOCK_STATE_CHANGED: "wallet_unlock_state_changed"
};
var BROADCAST_CHANNELS = {
  REDIRECT_CHANNEL: "redirect_channel",
  PROVIDER_CHANGE_CHANNEL: "torus_provider_change_channel",
  TRANSACTION_CHANNEL: "torus_channel",
  WALLET_LOGOUT_CHANNEL: "wallet_logout_channel",
  WALLET_SELECTED_ADDRESS_CHANNEL: "wallet_selected_address_channel",
  WALLET_NETWORK_CHANGE_CHANNEL: "wallet_network_change_channel",
  WALLET_ACCOUNT_IMPORT_CHANNEL: "wallet_account_import_channel"
};
var BROADCAST_CHANNELS_MSGS = {
  LOGOUT: "logout",
  ACCOUNT_IMPORTED: "account_imported",
  SELECTED_ADDRESS_CHANGE: "selected_address_change",
  NETWORK_CHANGE: "network_change"
};

/***/ }),
/* 3 */
/***/ (function(module, exports) {

module.exports = require("@babel/runtime/helpers/asyncToGenerator");

/***/ }),
/* 4 */
/***/ (function(module, exports) {

module.exports = require("@babel/runtime/helpers/getPrototypeOf");

/***/ }),
/* 5 */
/***/ (function(module, exports) {

module.exports = require("loglevel");

/***/ }),
/* 6 */
/***/ (function(module, exports) {

module.exports = require("@babel/runtime/helpers/classCallCheck");

/***/ }),
/* 7 */
/***/ (function(module, exports) {

module.exports = require("@babel/runtime/helpers/assertThisInitialized");

/***/ }),
/* 8 */
/***/ (function(module, exports) {

module.exports = require("@babel/runtime/helpers/createClass");

/***/ }),
/* 9 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";

// EXPORTS
__webpack_require__.d(__webpack_exports__, "j", function() { return /* reexport */ txUtils_getTxStatusText; });
__webpack_require__.d(__webpack_exports__, "m", function() { return /* reexport */ utils["l" /* intToHex */]; });
__webpack_require__.d(__webpack_exports__, "o", function() { return /* reexport */ utils["n" /* randomId */]; });
__webpack_require__.d(__webpack_exports__, "n", function() { return /* reexport */ utils["m" /* padWithZeroes */]; });
__webpack_require__.d(__webpack_exports__, "d", function() { return /* reexport */ utils["d" /* concatSig */]; });
__webpack_require__.d(__webpack_exports__, "r", function() { return /* reexport */ utils["q" /* timeout */]; });
__webpack_require__.d(__webpack_exports__, "f", function() { return /* reexport */ utils["f" /* formatSmallNumbers */]; });
__webpack_require__.d(__webpack_exports__, "b", function() { return /* reexport */ utils["b" /* addressSlicer */]; });
__webpack_require__.d(__webpack_exports__, "q", function() { return /* reexport */ utils["p" /* significantDigits */]; });
__webpack_require__.d(__webpack_exports__, "e", function() { return /* reexport */ utils["e" /* formatDate */]; });
__webpack_require__.d(__webpack_exports__, "g", function() { return /* reexport */ utils["g" /* formatTime */]; });
__webpack_require__.d(__webpack_exports__, "s", function() { return /* reexport */ utils["r" /* transactionMatchesNetwork */]; });
__webpack_require__.d(__webpack_exports__, "l", function() { return /* reexport */ utils["k" /* hashMessage */]; });
__webpack_require__.d(__webpack_exports__, "p", function() { return /* reexport */ utils["o" /* signMessage */]; });
__webpack_require__.d(__webpack_exports__, "i", function() { return /* reexport */ utils["i" /* getPopupFeatures */]; });
__webpack_require__.d(__webpack_exports__, "c", function() { return /* reexport */ utils["c" /* broadcastChannelOptions */]; });
__webpack_require__.d(__webpack_exports__, "h", function() { return /* reexport */ utils["h" /* getCustomDeviceInfo */]; });
__webpack_require__.d(__webpack_exports__, "a", function() { return /* reexport */ utils["a" /* UserError */]; });
__webpack_require__.d(__webpack_exports__, "k", function() { return /* reexport */ utils["j" /* handleRedirectParameters */]; });

// EXTERNAL MODULE: ./src/enums.ts
var enums = __webpack_require__(2);

// CONCATENATED MODULE: ./src/utils/txUtils.ts

var txUtils_getTxStatusText = function getTxStatusText(txStatus) {
  switch (txStatus) {
    case "rejected":
    case "unapproved":
    case "failed":
      return enums["m" /* ACTIVITY_STATUS_UNSUCCESSFUL */];

    case "confirmed":
      return enums["l" /* ACTIVITY_STATUS_SUCCESSFUL */];

    case "submitted":
      return enums["k" /* ACTIVITY_STATUS_PENDING */];

    case "cancelled":
      return enums["i" /* ACTIVITY_STATUS_CANCELLED */];

    default:
      return "";
  }
};
// EXTERNAL MODULE: ./src/utils/utils.ts
var utils = __webpack_require__(19);

// CONCATENATED MODULE: ./src/utils/index.ts



/***/ }),
/* 10 */
/***/ (function(module, exports) {

module.exports = require("@babel/runtime/helpers/inherits");

/***/ }),
/* 11 */
/***/ (function(module, exports) {

module.exports = require("@babel/runtime/helpers/possibleConstructorReturn");

/***/ }),
/* 12 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "c", function() { return TransactionStatus; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return TRANSACTION_TYPES; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return TX_EVENTS; });
/**
 * The status of the transaction. Each status represents the state of the transaction internally
 * in the wallet. Some of these correspond with the state of the transaction on the network, but
 * some are wallet-specific.
 */
var TransactionStatus;

(function (TransactionStatus) {
  TransactionStatus["approved"] = "approved";
  TransactionStatus["cancelled"] = "cancelled";
  TransactionStatus["confirmed"] = "confirmed";
  TransactionStatus["failed"] = "failed";
  TransactionStatus["finalized"] = "finalized";
  TransactionStatus["processed"] = "processed";
  TransactionStatus["rejected"] = "rejected";
  TransactionStatus["signed"] = "signed";
  TransactionStatus["submitted"] = "submitted";
  TransactionStatus["unapproved"] = "unapproved";
  TransactionStatus["dropped"] = "dropped";
  TransactionStatus["expired"] = "expired";
})(TransactionStatus || (TransactionStatus = {}));

var TRANSACTION_TYPES = {
  CONTRACT_INTERACTION: "contractInteraction",
  DEPLOY_CONTRACT: "contractDeployment",
  STANDARD_TRANSACTION: "transaction",
  STANDARD_PAYMENT_TRANSACTION: "payment_transaction" // specific to chains like solana and casper

};
var TX_EVENTS = {
  TX_WARNING: "tx:warning",
  TX_ERROR: "tx:error",
  TX_FAILED: "tx:failed",
  TX_CONFIRMED: "tx:confirmed",
  TX_DROPPED: "tx:dropped",
  TX_EXPIRED: "tx:expired",
  TX_STATUS_UPDATE: "tx:status_update",
  TX_UNAPPROVED: "tx:unapproved"
};

/***/ }),
/* 13 */
/***/ (function(module, exports) {

module.exports = require("@toruslabs/http-helpers");

/***/ }),
/* 14 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(6);
/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(8);
/* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(7);
/* harmony import */ var _babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(10);
/* harmony import */ var _babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var _babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(11);
/* harmony import */ var _babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(4);
/* harmony import */ var _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(1);
/* harmony import */ var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var _toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(15);
/* harmony import */ var _toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(_toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_7__);








function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_6___default()(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_5___default()(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_5___default()(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_4___default()(this, result); }; }

function _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }



/**
 * Controller class that provides configuration, state management, and subscriptions
 */
var BaseController = /*#__PURE__*/function (_SafeEventEmitter) {
  _babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_3___default()(BaseController, _SafeEventEmitter);

  var _super = _createSuper(BaseController);

  /**
   * Default options used to configure this controller
   */

  /**
   * Default state set on this controller
   */

  /**
   * Determines if listeners are notified of state changes
   */

  /**
   * Name of this controller used during composition
   */

  /**
   * Creates a BaseController instance. Both initial state and initial
   * configuration options are merged with defaults upon initialization.
   *
   * @param config - Initial options used to configure this controller
   * @param state - Initial state to set on this controller
   */
  function BaseController(_ref) {
    var _this;

    var _ref$config = _ref.config,
        config = _ref$config === void 0 ? {} : _ref$config,
        _ref$state = _ref.state,
        state = _ref$state === void 0 ? {} : _ref$state;

    _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this, BaseController);

    _this = _super.call(this); // Use assign since generics can't be spread: https://git.io/vpRhY

    _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_6___default()(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_2___default()(_this), "defaultConfig", {});

    _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_6___default()(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_2___default()(_this), "defaultState", {});

    _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_6___default()(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_2___default()(_this), "disabled", false);

    _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_6___default()(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_2___default()(_this), "name", "BaseController");

    _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_6___default()(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_2___default()(_this), "initialConfig", void 0);

    _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_6___default()(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_2___default()(_this), "initialState", void 0);

    _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_6___default()(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_2___default()(_this), "internalConfig", _this.defaultConfig);

    _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_6___default()(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_2___default()(_this), "internalState", _this.defaultState);

    _this.initialState = state;
    _this.initialConfig = config;
    return _this;
  }
  /**
   * Retrieves current controller configuration options
   *
   * @returns - Current configuration
   */


  _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(BaseController, [{
    key: "config",
    get: function get() {
      return this.internalConfig;
    }
    /**
     * Retrieves current controller state
     *
     * @returns - Current state
     */

  }, {
    key: "state",
    get: function get() {
      return this.internalState;
    }
    /**
     * Updates controller configuration
     *
     * @param config - New configuration options
     * @param overwrite - Overwrite config instead of merging
     * @param fullUpdate - Boolean that defines if the update is partial or not
     */

  }, {
    key: "configure",
    value: function configure(config) {
      var overwrite = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
      var fullUpdate = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;

      if (fullUpdate) {
        this.internalConfig = overwrite ? config : Object.assign(this.internalConfig, config);

        for (var key in this.internalConfig) {
          if (typeof this.internalConfig[key] !== "undefined") {
            this[key] = this.internalConfig[key];
          }
        }
      } else {
        for (var _key in config) {
          /* istanbul ignore else */
          if (typeof this.internalConfig[_key] !== "undefined") {
            this.internalConfig[_key] = config[_key];
            this[_key] = config[_key];
          }
        }
      }
    }
    /**
     * Updates controller state
     *
     * @param state - New state
     * @param overwrite - Overwrite state instead of merging
     */

  }, {
    key: "update",
    value: function update(state) {
      var overwrite = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
      this.internalState = overwrite ? _objectSpread({}, state) : _objectSpread(_objectSpread({}, this.internalState), state);
      this.emit("store", this.internalState);
    }
    /**
     * Enables the controller. This sets each config option as a member
     * variable on this instance and triggers any defined setters. This
     * also sets initial state and triggers any listeners.
     *
     * @returns - This controller instance
     */

  }, {
    key: "initialize",
    value: function initialize() {
      this.internalState = this.defaultState;
      this.internalConfig = this.defaultConfig;
      this.configure(this.initialConfig);
      this.update(this.initialState);
      return this;
    }
  }]);

  return BaseController;
}(_toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_7__["SafeEventEmitter"]);

/* harmony default export */ __webpack_exports__["a"] = (BaseController);

/***/ }),
/* 15 */
/***/ (function(module, exports) {

module.exports = require("@toruslabs/openlogin-jrpc");

/***/ }),
/* 16 */
/***/ (function(module, exports) {

module.exports = require("broadcast-channel");

/***/ }),
/* 17 */
/***/ (function(module, exports) {

module.exports = require("ethereumjs-util");

/***/ }),
/* 18 */
/***/ (function(module, exports) {

module.exports = require("bignumber.js");

/***/ }),
/* 19 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function(Buffer) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "l", function() { return intToHex; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "n", function() { return randomId; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "m", function() { return padWithZeroes; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "d", function() { return concatSig; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "q", function() { return timeout; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "f", function() { return formatSmallNumbers; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return addressSlicer; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "p", function() { return significantDigits; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "e", function() { return formatDate; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "g", function() { return formatTime; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "r", function() { return transactionMatchesNetwork; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "k", function() { return hashMessage; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "o", function() { return signMessage; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "i", function() { return getPopupFeatures; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "c", function() { return broadcastChannelOptions; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "h", function() { return getCustomDeviceInfo; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return UserError; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "j", function() { return handleRedirectParameters; });
/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(6);
/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(10);
/* harmony import */ var _babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(11);
/* harmony import */ var _babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(4);
/* harmony import */ var _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var _babel_runtime_helpers_wrapNativeSuper__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(46);
/* harmony import */ var _babel_runtime_helpers_wrapNativeSuper__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_wrapNativeSuper__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var bignumber_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(18);
/* harmony import */ var bignumber_js__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(bignumber_js__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var ethereumjs_util__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(17);
/* harmony import */ var ethereumjs_util__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(ethereumjs_util__WEBPACK_IMPORTED_MODULE_6__);






function _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default()(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default()(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default()(this, result); }; }

function _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }




/**
 * General utility functions
 */
function intToHex(i) {
  var hex = i.toString(16);
  return "0x".concat(hex);
}
/**
 * Returns a random number. Don't use for cryptographic purposes.
 * @returns a random number
 */

var randomId = function randomId() {
  return Math.random().toString(36).slice(2);
};
/**
 * Pads the front of the given hex string with zeroes until it reaches the
 * target length. If the input string is already longer than or equal to the
 * target length, it is returned unmodified.
 *
 * If the input string is "0x"-prefixed or not a hex string, an error will be
 * thrown.
 *
 * @param hexString - The hexadecimal string to pad with zeroes.
 * @param targetLength - The target length of the hexadecimal string.
 * @returns The input string front-padded with zeroes, or the original string
 * if it was already greater than or equal to to the target length.
 */

function padWithZeroes(hexString, targetLength) {
  if (hexString !== "" && !/^[0-9a-f]+$/i.test(hexString)) {
    throw new Error("Expected an unprefixed hex string. Received: ".concat(hexString));
  }

  if (targetLength < 0) {
    throw new Error("Expected a non-negative integer target length. Received: ".concat(targetLength));
  }

  return String.prototype.padStart.call(hexString, targetLength, "0");
}
/**
 * Concatenate an extended ECDSA signature into a hex string.
 *
 * @param v - The 'v' portion of the signature.
 * @param r - The 'r' portion of the signature.
 * @param s - The 's' portion of the signature.
 * @returns The concatenated ECDSA signature.
 */

function concatSig(v, r, s) {
  var rSig = Object(ethereumjs_util__WEBPACK_IMPORTED_MODULE_6__["fromSigned"])(r);
  var sSig = Object(ethereumjs_util__WEBPACK_IMPORTED_MODULE_6__["fromSigned"])(s);
  var vSig = Object(ethereumjs_util__WEBPACK_IMPORTED_MODULE_6__["bufferToInt"])(v);
  var rStr = padWithZeroes(Object(ethereumjs_util__WEBPACK_IMPORTED_MODULE_6__["toUnsigned"])(rSig).toString("hex"), 64);
  var sStr = padWithZeroes(Object(ethereumjs_util__WEBPACK_IMPORTED_MODULE_6__["toUnsigned"])(sSig).toString("hex"), 64);
  var vStr = Object(ethereumjs_util__WEBPACK_IMPORTED_MODULE_6__["stripHexPrefix"])(intToHex(vSig));
  return Object(ethereumjs_util__WEBPACK_IMPORTED_MODULE_6__["addHexPrefix"])(rStr.concat(sStr, vStr));
}
function timeout(duration) {
  return new Promise(function (resolve) {
    var timeoutRef = window.setTimeout(function () {
      resolve();
      window.clearTimeout(timeoutRef);
    }, duration);
  });
}
/**
 * Text/number formatting utilities
 */

var formatSmallNumbers = function formatSmallNumbers(number) {
  var currency = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : "usd";
  var noTilde = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;
  var finalNumber = bignumber_js__WEBPACK_IMPORTED_MODULE_5__["BigNumber"].isBigNumber(number) ? number.toNumber() : number;
  if (!Number.isFinite(finalNumber)) return "";
  var value = currency.toLowerCase() === "usd" ? parseFloat(Number(finalNumber).toFixed(2)) : parseFloat(Number(finalNumber).toFixed(5));
  var tilde = value > 0 ? "~ " : "";
  return "".concat(currency.toLowerCase() === "usd" || noTilde ? "" : tilde).concat(Number(value), " ").concat(currency.toUpperCase());
};
var addressSlicer = function addressSlicer(address) {
  if (address.length < 11) {
    return address;
  }

  if (typeof address !== "string") return "";
  return "".concat(address.slice(0, 5), "...").concat(address.slice(-5));
};
var significantDigits = function significantDigits(number) {
  var perc = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
  var length_ = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 2;
  var input = !bignumber_js__WEBPACK_IMPORTED_MODULE_5__["BigNumber"].isBigNumber(number) ? new bignumber_js__WEBPACK_IMPORTED_MODULE_5__["BigNumber"](number) : number;
  if (input.isZero()) return input;

  if (perc) {
    input = input.times(new bignumber_js__WEBPACK_IMPORTED_MODULE_5__["BigNumber"](100));
  }

  var depth;

  if (input.gte(new bignumber_js__WEBPACK_IMPORTED_MODULE_5__["BigNumber"](1))) {
    depth = length_;
  } else {
    depth = length_ - 1 + Math.ceil(Math.log10(new bignumber_js__WEBPACK_IMPORTED_MODULE_5__["BigNumber"]("1").div(input).toNumber()));
  }

  var shift = new bignumber_js__WEBPACK_IMPORTED_MODULE_5__["BigNumber"](10).pow(new bignumber_js__WEBPACK_IMPORTED_MODULE_5__["BigNumber"](depth));
  var roundedNumber = Math.round(shift.times(input).toNumber()) / shift.toNumber();
  return roundedNumber;
};
var formatDate = function formatDate(inputDate) {
  var monthList = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
  var date = new Date(inputDate);
  var day = date.getDate();
  var month = monthList[date.getMonth()];
  var year = date.getFullYear();
  return "".concat(day, " ").concat(month, " ").concat(year);
};
var formatTime = function formatTime(time) {
  return new Date(time).toTimeString().slice(0, 8);
};
/**
 * Network utilities
 */

var transactionMatchesNetwork = function transactionMatchesNetwork(transaction, chainId) {
  if (typeof transaction.chainId !== "undefined") {
    return transaction.chainId === chainId;
  }

  return false;
};
/**
 * Signing utils
 */

var hashMessage = function hashMessage(message) {
  var bufferedMessage = Buffer.from(message, "utf8");
  var el = Object(ethereumjs_util__WEBPACK_IMPORTED_MODULE_6__["hashPersonalMessage"])(bufferedMessage);
  return el;
};
var signMessage = function signMessage(privateKey, data) {
  var privKey = Buffer.from(privateKey, "hex");
  var message = Object(ethereumjs_util__WEBPACK_IMPORTED_MODULE_6__["stripHexPrefix"])(data);
  var msgSig = Object(ethereumjs_util__WEBPACK_IMPORTED_MODULE_6__["ecsign"])(Buffer.from(message, "hex"), privKey);
  var rawMsgSig = concatSig(Object(ethereumjs_util__WEBPACK_IMPORTED_MODULE_6__["intToBuffer"])(msgSig.v), msgSig.r, msgSig.s);
  return rawMsgSig;
};
/**
 * popup handler utils
 */

function getPopupFeatures(_ref) {
  var w = _ref.width,
      h = _ref.height;
  // Fixes dual-screen position                             Most browsers      Firefox
  var dualScreenLeft = window.screenLeft !== undefined ? window.screenLeft : window.screenX;
  var dualScreenTop = window.screenTop !== undefined ? window.screenTop : window.screenY;
  var width = window.innerWidth ? window.innerWidth : document.documentElement.clientWidth ? document.documentElement.clientWidth : window.screen.width;
  var height = window.innerHeight ? window.innerHeight : document.documentElement.clientHeight ? document.documentElement.clientHeight : window.screen.height;
  var systemZoom = 1; // No reliable estimate

  var left = Math.abs((width - w) / 2 / systemZoom + dualScreenLeft);
  var top = Math.abs((height - h) / 2 / systemZoom + dualScreenTop);
  var features = "titlebar=0,toolbar=0,status=0,location=0,menubar=0,height=".concat(h / systemZoom, ",width=").concat(w / systemZoom, ",top=").concat(top, ",left=").concat(left);
  return features;
}
var broadcastChannelOptions = {
  // type: 'localstorage', // (optional) enforce a type, oneOf['native', 'idb', 'localstorage', 'node']
  webWorkerSupport: false // (optional) set this to false if you know that your channel will never be used in a WebWorker (increases performance)

};
function getCustomDeviceInfo() {
  var _navigator;

  if ((_navigator = navigator) !== null && _navigator !== void 0 && _navigator.brave) {
    return {
      browser: "Brave"
    };
  }
}
var UserError = /*#__PURE__*/function (_Error) {
  _babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_1___default()(UserError, _Error);

  var _super = _createSuper(UserError);

  function UserError() {
    _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this, UserError);

    return _super.apply(this, arguments);
  }

  return UserError;
}( /*#__PURE__*/_babel_runtime_helpers_wrapNativeSuper__WEBPACK_IMPORTED_MODULE_4___default()(Error));
var handleRedirectParameters = function handleRedirectParameters(hash, queryParameters) {
  var hashParameters = {};
  var hashUrl = new URL("".concat(window.location.origin, "/?").concat(hash.slice(1)));
  hashUrl.searchParams.forEach(function (value, key) {
    hashParameters[key] = value;
  });
  var instanceParameters = {};
  var error = "";

  if (!queryParameters.windowId) {
    if (Object.keys(hashParameters).length > 0 && hashParameters.state) {
      instanceParameters = JSON.parse(window.atob(decodeURIComponent(decodeURIComponent(hashParameters.state)))) || {};
      error = hashParameters.error_description || hashParameters.error || error;
    } else if (Object.keys(queryParameters).length > 0 && queryParameters.state) {
      instanceParameters = JSON.parse(window.atob(decodeURIComponent(decodeURIComponent(queryParameters.state)))) || {};
      if (queryParameters.error) error = queryParameters.error;
    }
  }

  return {
    error: error,
    instanceParameters: instanceParameters,
    hashParameters: hashParameters
  };
};
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(49).Buffer))

/***/ }),
/* 20 */
/***/ (function(module, exports) {

module.exports = require("eth-rpc-errors");

/***/ }),
/* 21 */
/***/ (function(module, exports) {

module.exports = require("lodash");

/***/ }),
/* 22 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return createSwappableProxy; });
function createSwappableProxy(initialTarget) {
  var target = initialTarget;

  var setTarget = function setTarget(newTarget) {
    target = newTarget;
  };

  var proxy = new Proxy({}, {
    get: function get(_, name) {
      // override `setTarget` access
      if (name === "setTarget") return setTarget;
      return target[name];
    },
    set: function set(_, name, value) {
      // allow `setTarget` overrides
      if (name === "setTarget") {
        setTarget = value;
        return true;
      }

      target[name] = value;
      return true;
    }
  });
  return proxy;
}

/***/ }),
/* 23 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return providerFromEngine; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "c", function() { return providerFromMiddleware; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return providerAsMiddleware; });
/* harmony import */ var _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(3);
/* harmony import */ var _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(0);
/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(15);
/* harmony import */ var _toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_2__);



function providerFromEngine(engine) {
  var provider = new _toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_2__["SafeEventEmitter"](); // handle both rpc send methods

  provider.sendAsync = /*#__PURE__*/function () {
    var _ref = _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_0___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.mark(function _callee(req) {
      var res;
      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.wrap(function _callee$(_context) {
        while (1) {
          switch (_context.prev = _context.next) {
            case 0:
              _context.next = 2;
              return engine.handle(req);

            case 2:
              res = _context.sent;

              if (!res.error) {
                _context.next = 5;
                break;
              }

              throw new Error(res.error);

            case 5:
              return _context.abrupt("return", res.result);

            case 6:
            case "end":
              return _context.stop();
          }
        }
      }, _callee);
    }));

    return function (_x) {
      return _ref.apply(this, arguments);
    };
  }(); // eslint-disable-next-line @typescript-eslint/no-explicit-any


  provider.send = function (req, callback) {
    if (typeof callback !== "function") {
      throw new Error('Must provide callback to "send" method.');
    }

    engine.handle(req, callback);
  }; // forward notifications


  if (engine.on) {
    engine.on("notification", function (message) {
      provider.emit("data", null, message);
    });
  }

  return provider;
}
function providerFromMiddleware(middleware) {
  var engine = new _toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_2__["JRPCEngine"]();
  engine.push(middleware);
  var provider = providerFromEngine(engine);
  return provider;
}
function providerAsMiddleware(provider) {
  return /*#__PURE__*/function () {
    var _ref2 = _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_0___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.mark(function _callee2(req, res, _next, end) {
      var _providerRes;

      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.wrap(function _callee2$(_context2) {
        while (1) {
          switch (_context2.prev = _context2.next) {
            case 0:
              _context2.prev = 0;
              _context2.next = 3;
              return provider.sendAsync(req);

            case 3:
              _providerRes = _context2.sent;
              res.result = _providerRes;
              return _context2.abrupt("return", end());

            case 8:
              _context2.prev = 8;
              _context2.t0 = _context2["catch"](0);
              return _context2.abrupt("return", end(_context2.t0.message));

            case 11:
            case "end":
              return _context2.stop();
          }
        }
      }, _callee2, null, [[0, 8]]);
    }));

    return function (_x2, _x3, _x4, _x5) {
      return _ref2.apply(this, arguments);
    };
  }();
}

/***/ }),
/* 24 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return createChangeProviderMiddlewareMiddleware; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "c", function() { return createTopupMiddleware; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return createCommunicationMiddleware; });
/* harmony import */ var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(1);
/* harmony import */ var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(3);
/* harmony import */ var _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(0);
/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(15);
/* harmony import */ var _toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var _enums__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(2);





function createChangeProviderMiddlewareMiddleware(_ref) {
  var changeProvider = _ref.changeProvider;
  return Object(_toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_3__["createAsyncMiddleware"])( /*#__PURE__*/function () {
    var _ref2 = _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_2___default.a.mark(function _callee(request, response, next) {
      var method;
      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_2___default.a.wrap(function _callee$(_context) {
        while (1) {
          switch (_context.prev = _context.next) {
            case 0:
              method = request.method;

              if (!(method !== _enums__WEBPACK_IMPORTED_MODULE_4__[/* COMMUNICATION_JRPC_METHODS */ "p"].SET_PROVIDER)) {
                _context.next = 3;
                break;
              }

              return _context.abrupt("return", next());

            case 3:
              if (changeProvider) {
                _context.next = 5;
                break;
              }

              throw new Error("CommunicationMiddleware - opts.changeProvider not provided");

            case 5:
              _context.next = 7;
              return changeProvider(request);

            case 7:
              response.result = _context.sent;

            case 8:
            case "end":
              return _context.stop();
          }
        }
      }, _callee);
    }));

    return function (_x, _x2, _x3) {
      return _ref2.apply(this, arguments);
    };
  }());
}
function createTopupMiddleware(_ref3) {
  var topup = _ref3.topup;
  return Object(_toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_3__["createAsyncMiddleware"])( /*#__PURE__*/function () {
    var _ref4 = _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_2___default.a.mark(function _callee2(request, response, next) {
      var method;
      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_2___default.a.wrap(function _callee2$(_context2) {
        while (1) {
          switch (_context2.prev = _context2.next) {
            case 0:
              method = request.method;

              if (!(method !== _enums__WEBPACK_IMPORTED_MODULE_4__[/* COMMUNICATION_JRPC_METHODS */ "p"].TOPUP)) {
                _context2.next = 3;
                break;
              }

              return _context2.abrupt("return", next());

            case 3:
              if (topup) {
                _context2.next = 5;
                break;
              }

              throw new Error("CommunicationMiddleware - opts.topup not provided");

            case 5:
              _context2.next = 7;
              return topup(request);

            case 7:
              response.result = _context2.sent;

            case 8:
            case "end":
              return _context2.stop();
          }
        }
      }, _callee2);
    }));

    return function (_x4, _x5, _x6) {
      return _ref4.apply(this, arguments);
    };
  }());
}
function createCommunicationMiddleware(providerHandlers) {
  var _createScaffoldMiddle;

  var getUserInfo = providerHandlers.getUserInfo,
      getWalletInstanceId = providerHandlers.getWalletInstanceId,
      topup = providerHandlers.topup,
      logout = providerHandlers.logout,
      changeProvider = providerHandlers.changeProvider,
      setIFrameStatus = providerHandlers.setIFrameStatus,
      handleWindowRpc = providerHandlers.handleWindowRpc,
      getProviderState = providerHandlers.getProviderState;
  return Object(_toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_3__["mergeMiddleware"])([createChangeProviderMiddlewareMiddleware({
    changeProvider: changeProvider
  }), createTopupMiddleware({
    topup: topup
  }), Object(_toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_3__["createScaffoldMiddleware"])((_createScaffoldMiddle = {}, _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(_createScaffoldMiddle, _enums__WEBPACK_IMPORTED_MODULE_4__[/* COMMUNICATION_JRPC_METHODS */ "p"].LOGOUT, logout), _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(_createScaffoldMiddle, _enums__WEBPACK_IMPORTED_MODULE_4__[/* COMMUNICATION_JRPC_METHODS */ "p"].WALLET_INSTANCE_ID, getWalletInstanceId), _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(_createScaffoldMiddle, _enums__WEBPACK_IMPORTED_MODULE_4__[/* COMMUNICATION_JRPC_METHODS */ "p"].USER_INFO, getUserInfo), _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(_createScaffoldMiddle, _enums__WEBPACK_IMPORTED_MODULE_4__[/* COMMUNICATION_JRPC_METHODS */ "p"].IFRAME_STATUS, setIFrameStatus), _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(_createScaffoldMiddle, _enums__WEBPACK_IMPORTED_MODULE_4__[/* COMMUNICATION_JRPC_METHODS */ "p"].OPENED_WINDOW, handleWindowRpc), _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(_createScaffoldMiddle, _enums__WEBPACK_IMPORTED_MODULE_4__[/* COMMUNICATION_JRPC_METHODS */ "p"].CLOSED_WINDOW, handleWindowRpc), _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(_createScaffoldMiddle, _enums__WEBPACK_IMPORTED_MODULE_4__[/* COMMUNICATION_JRPC_METHODS */ "p"].GET_PROVIDER_STATE, getProviderState), _createScaffoldMiddle))]);
}

/***/ }),
/* 25 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return LOGIN_PROVIDER; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return PAYMENT_PROVIDER; });
/**
 * State change callbacks
 */

/**
 * Base controller configuration
 */

/**
 * Base state representation
 */
var LOGIN_PROVIDER = {
  GOOGLE: "google",
  FACEBOOK: "facebook",
  REDDIT: "reddit",
  DISCORD: "discord",
  TWITCH: "twitch",
  APPLE: "apple",
  LINE: "line",
  GITHUB: "github",
  KAKAO: "kakao",
  LINKEDIN: "linkedin",
  TWITTER: "twitter",
  WEIBO: "weibo",
  WECHAT: "wechat",
  EMAIL_PASSWORDLESS: "email_passwordless"
};
/**
 * {@label loginProviderType}
 */

var PAYMENT_PROVIDER = {
  MOONPAY: "moonpay",
  WYRE: "wyre",
  RAMPNETWORK: "rampnetwork",
  XANPOOL: "xanpool",
  MERCURYO: "mercuryo",
  TRANSAK: "transak"
};

/***/ }),
/* 26 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return ACTIVITY_ACTION; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return ACCOUNT_CATEGORY; });
var ACTIVITY_ACTION = {
  ACTIVITY_ACTION_ALL: "walletActivity.allTransactions",
  ACTIVITY_ACTION_SEND: "walletActivity.send",
  ACTIVITY_ACTION_RECEIVE: "walletActivity.receive",
  ACTIVITY_ACTION_TOPUP: "walletActivity.topup"
};
var ACCOUNT_CATEGORY = {
  NORMAL: "normal",
  THRESHOLD: "threshold",
  IMPORTED: "imported"
};

/***/ }),
/* 27 */
/***/ (function(module, exports) {

module.exports = require("@babel/runtime/helpers/get");

/***/ }),
/* 28 */
/***/ (function(module, exports) {

module.exports = require("@babel/runtime/helpers/toConsumableArray");

/***/ }),
/* 29 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";


/***/ }),
/* 30 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return BaseBlockTracker; });
/* harmony import */ var _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(3);
/* harmony import */ var _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(6);
/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(8);
/* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(7);
/* harmony import */ var _babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var _babel_runtime_helpers_get__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(27);
/* harmony import */ var _babel_runtime_helpers_get__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_get__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var _babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(10);
/* harmony import */ var _babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var _babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(11);
/* harmony import */ var _babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(4);
/* harmony import */ var _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_7__);
/* harmony import */ var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(1);
/* harmony import */ var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_8__);
/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(0);
/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_9___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_9__);
/* harmony import */ var _BaseController__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(14);











function _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_7___default()(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_7___default()(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_6___default()(this, result); }; }

function _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }


var sec = 1000;

var calculateSum = function calculateSum(accumulator, currentValue) {
  return accumulator + currentValue;
};

var blockTrackerEvents = ["sync", "latest"];
var BaseBlockTracker = /*#__PURE__*/function (_BaseController) {
  _babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5___default()(BaseBlockTracker, _BaseController);

  var _super = _createSuper(BaseBlockTracker);

  function BaseBlockTracker(_ref) {
    var _this;

    var _ref$config = _ref.config,
        config = _ref$config === void 0 ? {} : _ref$config,
        _ref$state = _ref.state,
        state = _ref$state === void 0 ? {} : _ref$state;

    _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1___default()(this, BaseBlockTracker);

    _this = _super.call(this, {
      config: config,
      state: state
    }); // config

    _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_8___default()(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_3___default()(_this), "name", "BaseBlockTracker");

    _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_8___default()(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_3___default()(_this), "_blockResetTimeout", void 0);

    _this.defaultState = {
      _currentBlock: {
        idempotencyKey: ""
      },
      _isRunning: false
    };
    _this.defaultConfig = {
      blockResetDuration: 20 * sec
    };

    _this.initialize(); // bind functions for internal use


    _this._onNewListener = _this._onNewListener.bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_3___default()(_this));
    _this._onRemoveListener = _this._onRemoveListener.bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_3___default()(_this));
    _this._resetCurrentBlock = _this._resetCurrentBlock.bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_3___default()(_this)); // listen for handler changes

    _this._setupInternalEvents();

    return _this;
  }

  _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_2___default()(BaseBlockTracker, [{
    key: "isRunning",
    value: function isRunning() {
      return this.state._isRunning;
    }
  }, {
    key: "getCurrentBlock",
    value: function getCurrentBlock() {
      return this.state._currentBlock;
    }
  }, {
    key: "getLatestBlock",
    value: function () {
      var _getLatestBlock = _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_0___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_9___default.a.mark(function _callee() {
        var _this2 = this;

        var latestBlock;
        return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_9___default.a.wrap(function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                if (!this.state._currentBlock) {
                  _context.next = 2;
                  break;
                }

                return _context.abrupt("return", this.state._currentBlock);

              case 2:
                _context.next = 4;
                return new Promise(function (resolve) {
                  return _this2.once("latest", function (newState) {
                    if (newState._currentBlock) {
                      resolve(newState._currentBlock);
                    }
                  });
                });

              case 4:
                latestBlock = _context.sent;
                return _context.abrupt("return", latestBlock);

              case 6:
              case "end":
                return _context.stop();
            }
          }
        }, _callee, this);
      }));

      function getLatestBlock() {
        return _getLatestBlock.apply(this, arguments);
      }

      return getLatestBlock;
    }() // dont allow module consumer to remove our internal event listeners

  }, {
    key: "removeAllListeners",
    value: function removeAllListeners(eventName) {
      if (eventName) {
        _babel_runtime_helpers_get__WEBPACK_IMPORTED_MODULE_4___default()(_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_7___default()(BaseBlockTracker.prototype), "removeAllListeners", this).call(this, eventName);
      } else {
        _babel_runtime_helpers_get__WEBPACK_IMPORTED_MODULE_4___default()(_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_7___default()(BaseBlockTracker.prototype), "removeAllListeners", this).call(this);
      } // re-add internal events


      this._setupInternalEvents(); // trigger stop check just in case


      this._onRemoveListener();

      return this;
    }
    /**
     * To be implemented in subclass.
     */

  }, {
    key: "_start",
    value: function _start() {// default behavior is noop
    }
    /**
     * To be implemented in subclass.
     */

  }, {
    key: "_end",
    value: function _end() {// default behavior is noop
    }
  }, {
    key: "_newPotentialLatest",
    value: function _newPotentialLatest(newBlock) {
      var currentBlock = this.state._currentBlock; // only update if blok number is higher

      if (currentBlock && newBlock.idempotencyKey === currentBlock.idempotencyKey) {
        return;
      }

      this._setCurrentBlock(newBlock);
    }
  }, {
    key: "_setupInternalEvents",
    value: function _setupInternalEvents() {
      // first remove listeners for idempotency
      this.removeListener("newListener", this._onNewListener);
      this.removeListener("removeListener", this._onRemoveListener); // then add them

      this.on("removeListener", this._onRemoveListener);
      this.on("newListener", this._onNewListener);
    }
  }, {
    key: "_onNewListener",
    value: function _onNewListener() {
      this._maybeStart();
    }
  }, {
    key: "_onRemoveListener",
    value: function _onRemoveListener() {
      // `removeListener` is called *after* the listener is removed
      if (this._getBlockTrackerEventCount() > 0) {
        return;
      }

      this._maybeEnd();
    }
  }, {
    key: "_maybeStart",
    value: function _maybeStart() {
      if (this.state._isRunning) {
        return;
      }

      this.state._isRunning = true; // cancel setting latest block to stale

      this._cancelBlockResetTimeout();

      this._start();
    }
  }, {
    key: "_maybeEnd",
    value: function _maybeEnd() {
      if (!this.state._isRunning) {
        return;
      }

      this.state._isRunning = false;

      this._setupBlockResetTimeout();

      this._end();
    }
  }, {
    key: "_getBlockTrackerEventCount",
    value: function _getBlockTrackerEventCount() {
      var _this3 = this;

      return blockTrackerEvents.map(function (eventName) {
        return _this3.listenerCount(eventName);
      }).reduce(calculateSum);
    }
  }, {
    key: "_setCurrentBlock",
    value: function _setCurrentBlock(newBlock) {
      var oldBlock = this.state._currentBlock;
      this.update({
        _currentBlock: newBlock
      });
      this.emit("latest", newBlock);
      this.emit("sync", {
        oldBlock: oldBlock,
        newBlock: newBlock
      });
    }
  }, {
    key: "_setupBlockResetTimeout",
    value: function _setupBlockResetTimeout() {
      // clear any existing timeout
      this._cancelBlockResetTimeout(); // clear latest block when stale


      this._blockResetTimeout = setTimeout(this._resetCurrentBlock, this.config.blockResetDuration); // nodejs - dont hold process open

      if (this._blockResetTimeout.unref) {
        this._blockResetTimeout.unref();
      }
    }
  }, {
    key: "_cancelBlockResetTimeout",
    value: function _cancelBlockResetTimeout() {
      if (this._blockResetTimeout) {
        clearTimeout(this._blockResetTimeout);
      }
    }
  }, {
    key: "_resetCurrentBlock",
    value: function _resetCurrentBlock() {
      this.update({
        _currentBlock: {
          idempotencyKey: ""
        }
      });
    }
  }]);

  return BaseBlockTracker;
}(_BaseController__WEBPACK_IMPORTED_MODULE_10__[/* default */ "a"]);

/***/ }),
/* 31 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";


/***/ }),
/* 32 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return createEventEmitterProxy; });
var filterNoop = function filterNoop() {
  return true;
};

var internalEvents = ["newListener", "removeListener"];

var externalEventFilter = function externalEventFilter(name) {
  return !internalEvents.includes(name);
};

function getRawListeners(eventEmitter, name) {
  // prefer native
  return eventEmitter.rawListeners(name);
}

function createEventEmitterProxy(initialTarget, opts) {
  // parse options
  var finalOpts = opts || {};
  var eventFilter = finalOpts.eventFilter || filterNoop;
  if (typeof eventFilter === "string" && eventFilter === "skipInternal") eventFilter = externalEventFilter;
  if (typeof eventFilter !== "function") throw new Error("createEventEmitterProxy - Invalid eventFilter");
  var target = initialTarget;

  var setTarget = function setTarget(newTarget) {
    var oldTarget = target;
    target = newTarget;
    oldTarget.eventNames().filter(eventFilter).forEach(function (name) {
      getRawListeners(oldTarget, name).forEach(function (handler) {
        return newTarget.on(name, handler);
      });
    }); // remove old listeners

    oldTarget.removeAllListeners();
  };

  var proxy = new Proxy({}, {
    get: function get(_, name) {
      // override `setTarget` access
      if (name === "setTarget") return setTarget;
      return target[name];
    },
    set: function set(_, name, value) {
      // allow `setTarget` overrides
      if (name === "setTarget") {
        setTarget = value;
        return true;
      }

      target[name] = value;
      return true;
    }
  });
  return proxy;
}

/***/ }),
/* 33 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return BaseCurrencyController; });
/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(6);
/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(8);
/* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(10);
/* harmony import */ var _babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(11);
/* harmony import */ var _babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(4);
/* harmony import */ var _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var _BaseController__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(14);






function _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_4___default()(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_4___default()(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_3___default()(this, result); }; }

function _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }


// every ten minutes
var POLLING_INTERVAL = 600000;
var BaseCurrencyController = /*#__PURE__*/function (_BaseController) {
  _babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_2___default()(BaseCurrencyController, _BaseController);

  var _super = _createSuper(BaseCurrencyController);

  function BaseCurrencyController(_ref) {
    var _this;

    var _ref$config = _ref.config,
        config = _ref$config === void 0 ? {} : _ref$config,
        state = _ref.state;

    _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this, BaseCurrencyController);

    _this = _super.call(this, {
      config: config,
      state: state
    });
    _this.defaultState = {
      currentCurrency: "usd",
      conversionRate: 0,
      conversionDate: "N/A",
      nativeCurrency: "ETH"
    };
    _this.defaultConfig = {
      pollInterval: POLLING_INTERVAL
    };

    _this.initialize();

    return _this;
  } //
  // PUBLIC METHODS
  //


  _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(BaseCurrencyController, [{
    key: "getNativeCurrency",
    value: function getNativeCurrency() {
      return this.state.nativeCurrency;
    }
  }, {
    key: "setNativeCurrency",
    value: function setNativeCurrency(nativeCurrency) {
      this.update({
        nativeCurrency: nativeCurrency,
        ticker: nativeCurrency
      });
    }
  }, {
    key: "getCurrentCurrency",
    value: function getCurrentCurrency() {
      return this.state.currentCurrency;
    }
  }, {
    key: "setCurrentCurrency",
    value: function setCurrentCurrency(currentCurrency) {
      this.update({
        currentCurrency: currentCurrency
      });
    }
    /**
     * A getter for the conversionRate property
     *
     * @returns The conversion rate from ETH to the selected currency.
     *
     */

  }, {
    key: "getConversionRate",
    value: function getConversionRate() {
      return this.state.conversionRate;
    }
  }, {
    key: "setConversionRate",
    value: function setConversionRate(conversionRate) {
      this.update({
        conversionRate: conversionRate
      });
    }
    /**
     * A getter for the conversionDate property
     *
     * @returns The date at which the conversion rate was set. Expressed in milliseconds since midnight of
     * January 1, 1970
     *
     */

  }, {
    key: "getConversionDate",
    value: function getConversionDate() {
      return this.state.conversionDate;
    }
  }, {
    key: "setConversionDate",
    value: function setConversionDate(conversionDate) {
      this.update({
        conversionDate: conversionDate
      });
    }
  }]);

  return BaseCurrencyController;
}(_BaseController__WEBPACK_IMPORTED_MODULE_5__[/* default */ "a"]);

/***/ }),
/* 34 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";


/***/ }),
/* 35 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return BaseEmbedController; });
/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(6);
/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(8);
/* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(7);
/* harmony import */ var _babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(10);
/* harmony import */ var _babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var _babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(11);
/* harmony import */ var _babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(4);
/* harmony import */ var _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(1);
/* harmony import */ var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var _toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(15);
/* harmony import */ var _toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(_toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_7__);
/* harmony import */ var _BaseController__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(14);
/* harmony import */ var _createSwappableProxy__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(22);
/* harmony import */ var _Network_INetworkController__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(23);
/* harmony import */ var _CommunicationMethodMiddleware__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(24);








function _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_5___default()(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_5___default()(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_4___default()(this, result); }; }

function _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }






var BaseEmbedController = /*#__PURE__*/function (_BaseController) {
  _babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_3___default()(BaseEmbedController, _BaseController);

  var _super = _createSuper(BaseEmbedController);

  function BaseEmbedController(_ref) {
    var _this;

    var _ref$config = _ref.config,
        config = _ref$config === void 0 ? {} : _ref$config,
        state = _ref.state;

    _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this, BaseEmbedController);

    _this = _super.call(this, {
      config: config,
      state: state
    });

    _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_6___default()(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_2___default()(_this), "_communicationProviderProxy", void 0);

    _this.defaultState = {
      buttonPosition: "bottom-right",
      isIFrameFullScreen: true,
      apiKey: "torus-default",
      oauthModalVisibility: false,
      loginInProgress: false,
      dappMetadata: {
        name: "",
        icon: ""
      }
    };

    _this.initialize();

    return _this;
  }
  /**
   * Called by orchestrator once while initializing the class
   * @param handlers - JRPC handlers for provider
   * @returns - provider - Returns the providerProxy
   */


  _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(BaseEmbedController, [{
    key: "initializeProvider",
    value: function initializeProvider(handlers) {
      var engine = new _toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_7__["JRPCEngine"]();
      var communicationMiddleware = Object(_CommunicationMethodMiddleware__WEBPACK_IMPORTED_MODULE_11__[/* createCommunicationMiddleware */ "b"])(handlers);
      engine.push(communicationMiddleware);
      var communicationProvider = Object(_Network_INetworkController__WEBPACK_IMPORTED_MODULE_10__[/* providerFromEngine */ "b"])(engine);
      this.setCommunicationProvider(communicationProvider);
    }
  }, {
    key: "setCommunicationProvider",
    value: function setCommunicationProvider(communicationProvider) {
      if (this._communicationProviderProxy) {
        // eslint-disable-next-line @typescript-eslint/ban-ts-comment
        // @ts-ignore
        this._communicationProviderProxy.setTarget(communicationProvider);
      } else {
        this._communicationProviderProxy = Object(_createSwappableProxy__WEBPACK_IMPORTED_MODULE_9__[/* default */ "a"])(communicationProvider);
      }
    }
  }]);

  return BaseEmbedController;
}(_BaseController__WEBPACK_IMPORTED_MODULE_8__[/* default */ "a"]);

/***/ }),
/* 36 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(6);
/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(7);
/* harmony import */ var _babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(10);
/* harmony import */ var _babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(11);
/* harmony import */ var _babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(4);
/* harmony import */ var _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(1);
/* harmony import */ var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var _toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(15);
/* harmony import */ var _toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(_toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var _enums__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(2);







function _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_4___default()(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_4___default()(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_3___default()(this, result); }; }

function _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }




var CommunicationWindowManager = /*#__PURE__*/function (_SafeEventEmitter) {
  _babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_2___default()(CommunicationWindowManager, _SafeEventEmitter);

  var _super = _createSuper(CommunicationWindowManager);

  function CommunicationWindowManager() {
    var _this;

    _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this, CommunicationWindowManager);

    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    _this = _super.call.apply(_super, [this].concat(args));

    _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_5___default()(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_1___default()(_this), "handleWindowRpc", function (request, response, next, end) {
      var method = request.method,
          params = request.params;

      if (method === _enums__WEBPACK_IMPORTED_MODULE_7__[/* COMMUNICATION_JRPC_METHODS */ "p"].OPENED_WINDOW) {
        var windowId = params.windowId; // I've been informed that a window has been opened

        _this.emit("".concat(windowId, ":opened"));

        response.result = true;
        end();
      } else if (method === _enums__WEBPACK_IMPORTED_MODULE_7__[/* COMMUNICATION_JRPC_METHODS */ "p"].CLOSED_WINDOW) {
        var _windowId = params.windowId; // I've been informed that a window has been closed

        _this.emit("".concat(_windowId, ":closed"));

        response.result = true;
        end();
      } else {
        next();
      }
    });

    return _this;
  }

  return CommunicationWindowManager;
}(_toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_6__["SafeEventEmitter"]);

/* harmony default export */ __webpack_exports__["a"] = (CommunicationWindowManager);

/***/ }),
/* 37 */
/***/ (function(module, exports) {



/***/ }),
/* 38 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return BaseKeyringController; });
/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(6);
/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(8);
/* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(10);
/* harmony import */ var _babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(11);
/* harmony import */ var _babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(4);
/* harmony import */ var _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var _BaseController__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(14);
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(9);






function _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_4___default()(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_4___default()(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_3___default()(this, result); }; }

function _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }



var BaseKeyringController = /*#__PURE__*/function (_BaseController) {
  _babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_2___default()(BaseKeyringController, _BaseController);

  var _super = _createSuper(BaseKeyringController);

  function BaseKeyringController(_ref) {
    var _state$wallets;

    var _this;

    var _ref$config = _ref.config,
        config = _ref$config === void 0 ? {} : _ref$config,
        state = _ref.state;

    _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this, BaseKeyringController);

    _this = _super.call(this, {
      config: config,
      state: state
    });
    _this.defaultState = {
      wallets: (_state$wallets = state.wallets) !== null && _state$wallets !== void 0 ? _state$wallets : []
    };

    _this.initialize();

    return _this;
  } // for signing auth message


  _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(BaseKeyringController, [{
    key: "signAuthMessage",
    value: function signAuthMessage(address, message) {
      var keyring = this.state.wallets.find(function (x) {
        return x.address === address;
      });

      if (!keyring) {
        throw new Error("key does not exist");
      }

      var hashedMessage = Object(_utils__WEBPACK_IMPORTED_MODULE_6__[/* hashMessage */ "l"])(message).toString("hex");
      var rawMessageSig = Object(_utils__WEBPACK_IMPORTED_MODULE_6__[/* signMessage */ "p"])(keyring.privateKey, hashedMessage);
      return rawMessageSig;
    }
  }]);

  return BaseKeyringController;
}(_BaseController__WEBPACK_IMPORTED_MODULE_5__[/* default */ "a"]);

/***/ }),
/* 39 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";


/***/ }),
/* 40 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return createFetchConfigFromReq; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return createFetchMiddleware; });
/* harmony import */ var _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(3);
/* harmony import */ var _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(0);
/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(15);
/* harmony import */ var _toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var eth_rpc_errors__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(20);
/* harmony import */ var eth_rpc_errors__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(eth_rpc_errors__WEBPACK_IMPORTED_MODULE_3__);




var RETRIABLE_ERRORS = [// ignore server overload errors
"Gateway timeout", "ETIMEDOUT", // ignore server sent html error pages
// or truncated json responses
"failed to parse response body", // ignore errors where http req failed to establish
"Failed to fetch"];

function checkForHttpErrors(fetchRes) {
  // check for errors
  switch (fetchRes.status) {
    case 405:
      throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_3__["ethErrors"].rpc.methodNotFound();

    case 418:
      throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_3__["ethErrors"].rpc.internal({
        message: "Request is being rate limited."
      });

    case 503:
    case 504:
      throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_3__["ethErrors"].rpc.internal({
        message: "Gateway timeout. The request took too long to process." + "This can happen when querying over too wide a block range."
      });

    default:
      break;
  }
}

function timeout(duration) {
  return new Promise(function (resolve) {
    return setTimeout(resolve, duration);
  });
}

function parseResponse(fetchRes, body) {
  // check for error code
  if (fetchRes.status !== 200) {
    throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_3__["ethErrors"].rpc.internal({
      message: "Non-200 status code: '".concat(fetchRes.status, "'"),
      data: body
    });
  } // check for rpc error


  if (body.error) {
    throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_3__["ethErrors"].rpc.internal({
      data: body.error
    });
  } // return successful result


  return body.result;
}

function createFetchConfigFromReq(_ref) {
  var req = _ref.req,
      rpcTarget = _ref.rpcTarget,
      originHttpHeaderKey = _ref.originHttpHeaderKey;
  var parsedUrl = new URL(rpcTarget); // prepare payload
  // copy only canonical json rpc properties

  var payload = {
    id: req.id,
    jsonrpc: req.jsonrpc,
    method: req.method,
    params: req.params
  }; // extract 'origin' parameter from request

  var originDomain = req.origin; // serialize request body

  var serializedPayload = JSON.stringify(payload); // configure fetch params

  var fetchParams = {
    method: "POST",
    headers: {
      Accept: "application/json",
      "Content-Type": "application/json"
    },
    body: serializedPayload
  }; // optional: add request origin as header

  if (originHttpHeaderKey && originDomain) {
    fetchParams.headers[originHttpHeaderKey] = originDomain;
  }

  return {
    fetchUrl: parsedUrl.href,
    fetchParams: fetchParams
  };
}
function createFetchMiddleware(_ref2) {
  var rpcTarget = _ref2.rpcTarget,
      originHttpHeaderKey = _ref2.originHttpHeaderKey;
  return Object(_toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_2__["createAsyncMiddleware"])( /*#__PURE__*/function () {
    var _ref3 = _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_0___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.mark(function _callee(req, res, _next) {
      var _createFetchConfigFro, fetchUrl, fetchParams, maxAttempts, retryInterval, attempt, fetchRes, fetchBody, result;

      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.wrap(function _callee$(_context) {
        while (1) {
          switch (_context.prev = _context.next) {
            case 0:
              _createFetchConfigFro = createFetchConfigFromReq({
                req: req,
                rpcTarget: rpcTarget,
                originHttpHeaderKey: originHttpHeaderKey
              }), fetchUrl = _createFetchConfigFro.fetchUrl, fetchParams = _createFetchConfigFro.fetchParams; // attempt request multiple times

              maxAttempts = 5;
              retryInterval = 1000;
              attempt = 0;

            case 4:
              if (!(attempt < maxAttempts)) {
                _context.next = 26;
                break;
              }

              _context.prev = 5;
              _context.next = 8;
              return fetch(fetchUrl, fetchParams);

            case 8:
              fetchRes = _context.sent;
              // check for http errrors
              checkForHttpErrors(fetchRes); // parse response body

              _context.next = 12;
              return fetchRes.json();

            case 12:
              fetchBody = _context.sent;
              result = parseResponse(fetchRes, fetchBody); // set result and exit retry loop

              res.result = result;
              return _context.abrupt("return");

            case 18:
              _context.prev = 18;
              _context.t0 = _context["catch"](5);

              (function () {
                var errMsg = _context.t0.toString();

                var isRetriable = RETRIABLE_ERRORS.some(function (phrase) {
                  return errMsg.includes(phrase);
                }); // re-throw error if not retriable

                if (!isRetriable) {
                  throw _context.t0;
                }
              })();

            case 21:
              _context.next = 23;
              return timeout(retryInterval);

            case 23:
              attempt++;
              _context.next = 4;
              break;

            case 26:
            case "end":
              return _context.stop();
          }
        }
      }, _callee, null, [[5, 18]]);
    }));

    return function (_x, _x2, _x3) {
      return _ref3.apply(this, arguments);
    };
  }());
}

/***/ }),
/* 41 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return createLoggerMiddleware; });
/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(5);
/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_0__);

function createLoggerMiddleware(options) {
  return function loggerMiddleware(request, response, next) {
    next(function (callback) {
      if (response.error) {
        loglevel__WEBPACK_IMPORTED_MODULE_0___default.a.warn("Error in RPC response:\n", response);
      }

      if (request.isTorusInternal) return;
      loglevel__WEBPACK_IMPORTED_MODULE_0___default.a.info("RPC (".concat(options.origin, "):"), request, "->", response);
      callback();
    });
  };
}

/***/ }),
/* 42 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return createOriginMiddleware; });
function createOriginMiddleware(options) {
  return function originMiddleware(request, _, next) {
    // eslint-disable-next-line @typescript-eslint/no-explicit-any
    request.origin = options.origin;
    next();
  };
}

/***/ }),
/* 43 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return DEFAULT_PREFERENCES; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return BasePreferencesController; });
/* harmony import */ var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(28);
/* harmony import */ var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(3);
/* harmony import */ var _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(6);
/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(8);
/* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var _babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(7);
/* harmony import */ var _babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var _babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(10);
/* harmony import */ var _babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var _babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(11);
/* harmony import */ var _babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(4);
/* harmony import */ var _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_7__);
/* harmony import */ var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(1);
/* harmony import */ var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_8__);
/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(0);
/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_9___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_9__);
/* harmony import */ var _toruslabs_http_helpers__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(13);
/* harmony import */ var _toruslabs_http_helpers__WEBPACK_IMPORTED_MODULE_10___default = /*#__PURE__*/__webpack_require__.n(_toruslabs_http_helpers__WEBPACK_IMPORTED_MODULE_10__);
/* harmony import */ var bowser__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(47);
/* harmony import */ var bowser__WEBPACK_IMPORTED_MODULE_11___default = /*#__PURE__*/__webpack_require__.n(bowser__WEBPACK_IMPORTED_MODULE_11__);
/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(21);
/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_12___default = /*#__PURE__*/__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_12__);
/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(5);
/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_13___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_13__);
/* harmony import */ var _BaseController__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(14);
/* harmony import */ var _interfaces__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(25);
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(9);
/* harmony import */ var _IPreferencesController__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(26);











function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_8___default()(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_7___default()(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_7___default()(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_6___default()(this, result); }; }

function _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }








 // By default, poll every 3 minutes

var DEFAULT_INTERVAL = 180 * 1000;
var DEFAULT_PREFERENCES = {
  selectedCurrency: "USD",
  theme: "dark",
  locale: "en-US",
  accountType: _IPreferencesController__WEBPACK_IMPORTED_MODULE_17__[/* ACCOUNT_CATEGORY */ "a"].NORMAL,
  contacts: [],
  jwtToken: "",
  fetchedPastTx: [],
  pastTransactions: [],
  paymentTx: [],
  defaultPublicAddress: "",
  customTokens: [],
  customNfts: [],
  crashReport: true,
  userInfo: {
    aggregateVerifier: "",
    email: "",
    name: "",
    profileImage: "",
    typeOfLogin: _interfaces__WEBPACK_IMPORTED_MODULE_15__[/* LOGIN_PROVIDER */ "a"].GOOGLE,
    verifier: "",
    verifierId: ""
  }
};
/**
 * Controller that stores shared settings and exposes convenience methods
 */

var BasePreferencesController = /*#__PURE__*/function (_BaseController) {
  _babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5___default()(BasePreferencesController, _BaseController);

  var _super = _createSuper(BasePreferencesController);

  /**
   * Name of this controller used during composition
   */

  /**
   * Creates a PreferencesController instance
   *
   * @param config - Initial options used to configure this controller
   * @param state - Initial state to set on this controller
   */
  function BasePreferencesController(_ref) {
    var _this;

    var config = _ref.config,
        state = _ref.state,
        defaultPreferences = _ref.defaultPreferences,
        signAuthMessage = _ref.signAuthMessage;

    _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_2___default()(this, BasePreferencesController);

    _this = _super.call(this, {
      config: config,
      state: state
    });

    _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_8___default()(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4___default()(_this), "name", "PreferencesController");

    _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_8___default()(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4___default()(_this), "iframeOrigin", void 0);

    _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_8___default()(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4___default()(_this), "signAuthMessage", void 0);

    _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_8___default()(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4___default()(_this), "defaultPreferences", void 0);

    if (!config.api) {
      throw new Error("PreferencesController - no api specified in config.");
    }

    _this.defaultState = {
      identities: {},
      selectedAddress: "",
      lastErrorMessage: "",
      lastSuccessMessage: ""
    };
    _this.defaultConfig = {
      api: config.api,
      pollInterval: DEFAULT_INTERVAL
    };

    _this.initialize();

    _this.defaultPreferences = _objectSpread(_objectSpread({}, DEFAULT_PREFERENCES), defaultPreferences);
    _this.signAuthMessage = signAuthMessage;
    return _this;
  }

  _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_3___default()(BasePreferencesController, [{
    key: "setIframeOrigin",
    value: function setIframeOrigin(origin) {
      this.iframeOrigin = origin;
    }
  }, {
    key: "getAddressState",
    value: function getAddressState(address) {
      var selectedAddress = address || this.state.selectedAddress;
      return this.state.identities[selectedAddress];
    }
    /**
     * Sets selected address
     *
     * @param selectedAddress - casper account hash
     */

  }, {
    key: "setSelectedAddress",
    value: function setSelectedAddress(selectedAddress) {
      this.update({
        selectedAddress: selectedAddress
      });
    }
  }, {
    key: "getUser",
    value: function () {
      var _getUser = _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_9___default.a.mark(function _callee(address) {
        var user;
        return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_9___default.a.wrap(function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                _context.next = 2;
                return Object(_toruslabs_http_helpers__WEBPACK_IMPORTED_MODULE_10__["get"])("".concat(this.config.api, "/user?fetchTx=false"), this.headers(address), {
                  useAPIKey: true
                });

              case 2:
                user = _context.sent;
                return _context.abrupt("return", user.data);

              case 4:
              case "end":
                return _context.stop();
            }
          }
        }, _callee, this);
      }));

      function getUser(_x) {
        return _getUser.apply(this, arguments);
      }

      return getUser;
    }()
  }, {
    key: "createUser",
    value: function () {
      var _createUser = _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_9___default.a.mark(function _callee2(params) {
        var selectedCurrency, theme, verifier, verifierId, locale, address, userPayload;
        return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_9___default.a.wrap(function _callee2$(_context2) {
          while (1) {
            switch (_context2.prev = _context2.next) {
              case 0:
                selectedCurrency = params.selectedCurrency, theme = params.theme, verifier = params.verifier, verifierId = params.verifierId, locale = params.locale, address = params.address;
                userPayload = {
                  default_currency: selectedCurrency,
                  theme: theme,
                  verifier: verifier,
                  verifier_id: verifierId,
                  locale: locale
                };
                _context2.next = 4;
                return Object(_toruslabs_http_helpers__WEBPACK_IMPORTED_MODULE_10__["post"])("".concat(this.config.api, "/user"), userPayload, this.headers(address), {
                  useAPIKey: true
                });

              case 4:
                this.updateState({
                  theme: theme,
                  defaultPublicAddress: address,
                  selectedCurrency: selectedCurrency,
                  locale: locale
                }, address);

              case 5:
              case "end":
                return _context2.stop();
            }
          }
        }, _callee2, this);
      }));

      function createUser(_x2) {
        return _createUser.apply(this, arguments);
      }

      return createUser;
    }()
  }, {
    key: "storeUserLogin",
    value: function () {
      var _storeUserLogin = _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_9___default.a.mark(function _callee3(params) {
        var verifierId, verifier, options, address, browser, specialBrowser, recordLoginPayload;
        return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_9___default.a.wrap(function _callee3$(_context3) {
          while (1) {
            switch (_context3.prev = _context3.next) {
              case 0:
                verifierId = params.verifierId, verifier = params.verifier, options = params.options, address = params.address;

                if (options.rehydrate) {
                  _context3.next = 7;
                  break;
                }

                browser = bowser__WEBPACK_IMPORTED_MODULE_11___default.a.getParser(window.navigator.userAgent);
                specialBrowser = Object(_utils__WEBPACK_IMPORTED_MODULE_16__[/* getCustomDeviceInfo */ "h"])();
                recordLoginPayload = {
                  os: browser.getOSName(),
                  os_version: browser.getOSVersion() || "unidentified",
                  browser: (specialBrowser === null || specialBrowser === void 0 ? void 0 : specialBrowser.browser) || browser.getBrowserName() || "unidentified",
                  browser_version: browser.getBrowserVersion() || "unidentified",
                  platform: browser.getPlatform().type || "desktop",
                  hostname: this.iframeOrigin,
                  verifier: verifier,
                  verifier_id: verifierId
                };
                _context3.next = 7;
                return Object(_toruslabs_http_helpers__WEBPACK_IMPORTED_MODULE_10__["post"])("".concat(this.config.api, "/user/recordLogin"), recordLoginPayload, this.headers(address), {
                  useAPIKey: true
                });

              case 7:
              case "end":
                return _context3.stop();
            }
          }
        }, _callee3, this);
      }));

      function storeUserLogin(_x3) {
        return _storeUserLogin.apply(this, arguments);
      }

      return storeUserLogin;
    }()
  }, {
    key: "setCrashReport",
    value: function () {
      var _setCrashReport = _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_9___default.a.mark(function _callee4(isEnabled) {
        var _this$getAddressState;

        return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_9___default.a.wrap(function _callee4$(_context4) {
          while (1) {
            switch (_context4.prev = _context4.next) {
              case 0:
                if (!(isEnabled === ((_this$getAddressState = this.getAddressState()) === null || _this$getAddressState === void 0 ? void 0 : _this$getAddressState.crashReport))) {
                  _context4.next = 2;
                  break;
                }

                return _context4.abrupt("return", true);

              case 2:
                _context4.prev = 2;
                _context4.next = 5;
                return Object(_toruslabs_http_helpers__WEBPACK_IMPORTED_MODULE_10__["patch"])("".concat(this.config.api, "/user"), {
                  enable_crash_reporter: isEnabled
                }, this.headers(), {
                  useAPIKey: true
                });

              case 5:
                this.updateState({
                  crashReport: isEnabled
                });
                return _context4.abrupt("return", true);

              case 9:
                _context4.prev = 9;
                _context4.t0 = _context4["catch"](2);
                loglevel__WEBPACK_IMPORTED_MODULE_13___default.a.error(_context4.t0);
                return _context4.abrupt("return", false);

              case 13:
              case "end":
                return _context4.stop();
            }
          }
        }, _callee4, this, [[2, 9]]);
      }));

      function setCrashReport(_x4) {
        return _setCrashReport.apply(this, arguments);
      }

      return setCrashReport;
    }()
  }, {
    key: "setUserTheme",
    value: function () {
      var _setUserTheme = _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_9___default.a.mark(function _callee5(theme) {
        var _this$getAddressState2;

        return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_9___default.a.wrap(function _callee5$(_context5) {
          while (1) {
            switch (_context5.prev = _context5.next) {
              case 0:
                if (!(theme === ((_this$getAddressState2 = this.getAddressState()) === null || _this$getAddressState2 === void 0 ? void 0 : _this$getAddressState2.theme))) {
                  _context5.next = 2;
                  break;
                }

                return _context5.abrupt("return", true);

              case 2:
                _context5.prev = 2;
                _context5.next = 5;
                return Object(_toruslabs_http_helpers__WEBPACK_IMPORTED_MODULE_10__["patch"])("".concat(this.config.api, "/user"), {
                  theme: theme
                }, this.headers(), {
                  useAPIKey: true
                });

              case 5:
                this.updateState({
                  theme: theme
                });
                return _context5.abrupt("return", true);

              case 9:
                _context5.prev = 9;
                _context5.t0 = _context5["catch"](2);
                loglevel__WEBPACK_IMPORTED_MODULE_13___default.a.error(_context5.t0);
                return _context5.abrupt("return", false);

              case 13:
              case "end":
                return _context5.stop();
            }
          }
        }, _callee5, this, [[2, 9]]);
      }));

      function setUserTheme(_x5) {
        return _setUserTheme.apply(this, arguments);
      }

      return setUserTheme;
    }()
  }, {
    key: "setUserLocale",
    value: function () {
      var _setUserLocale = _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_9___default.a.mark(function _callee6(locale) {
        var _this$getAddressState3;

        return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_9___default.a.wrap(function _callee6$(_context6) {
          while (1) {
            switch (_context6.prev = _context6.next) {
              case 0:
                if (!(locale === ((_this$getAddressState3 = this.getAddressState()) === null || _this$getAddressState3 === void 0 ? void 0 : _this$getAddressState3.locale))) {
                  _context6.next = 2;
                  break;
                }

                return _context6.abrupt("return");

              case 2:
                _context6.prev = 2;
                _context6.next = 5;
                return Object(_toruslabs_http_helpers__WEBPACK_IMPORTED_MODULE_10__["patch"])("".concat(this.config.api, "/user"), {
                  locale: locale
                }, this.headers(), {
                  useAPIKey: true
                });

              case 5:
                this.updateState({
                  locale: locale
                });
                return _context6.abrupt("return", true);

              case 9:
                _context6.prev = 9;
                _context6.t0 = _context6["catch"](2);
                loglevel__WEBPACK_IMPORTED_MODULE_13___default.a.error("unable to set locale", _context6.t0);
                return _context6.abrupt("return", false);

              case 13:
              case "end":
                return _context6.stop();
            }
          }
        }, _callee6, this, [[2, 9]]);
      }));

      function setUserLocale(_x6) {
        return _setUserLocale.apply(this, arguments);
      }

      return setUserLocale;
    }()
  }, {
    key: "setSelectedCurrency",
    value: function () {
      var _setSelectedCurrency = _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_9___default.a.mark(function _callee7(payload) {
        var _this$getAddressState4;

        return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_9___default.a.wrap(function _callee7$(_context7) {
          while (1) {
            switch (_context7.prev = _context7.next) {
              case 0:
                if (!(payload.selectedCurrency === ((_this$getAddressState4 = this.getAddressState()) === null || _this$getAddressState4 === void 0 ? void 0 : _this$getAddressState4.selectedCurrency))) {
                  _context7.next = 2;
                  break;
                }

                return _context7.abrupt("return", true);

              case 2:
                _context7.prev = 2;
                _context7.next = 5;
                return Object(_toruslabs_http_helpers__WEBPACK_IMPORTED_MODULE_10__["patch"])("".concat(this.config.api, "/user"), {
                  default_currency: payload.selectedCurrency
                }, this.headers(), {
                  useAPIKey: true
                });

              case 5:
                this.updateState({
                  selectedCurrency: payload.selectedCurrency
                });
                return _context7.abrupt("return", true);

              case 9:
                _context7.prev = 9;
                _context7.t0 = _context7["catch"](2);
                loglevel__WEBPACK_IMPORTED_MODULE_13___default.a.error(_context7.t0);
                return _context7.abrupt("return", false);

              case 13:
              case "end":
                return _context7.stop();
            }
          }
        }, _callee7, this, [[2, 9]]);
      }));

      function setSelectedCurrency(_x7) {
        return _setSelectedCurrency.apply(this, arguments);
      }

      return setSelectedCurrency;
    }()
  }, {
    key: "addContact",
    value: function () {
      var _addContact = _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_9___default.a.mark(function _callee8(contact) {
        var _this$getAddressState5, response;

        return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_9___default.a.wrap(function _callee8$(_context8) {
          while (1) {
            switch (_context8.prev = _context8.next) {
              case 0:
                _context8.prev = 0;
                _context8.next = 3;
                return Object(_toruslabs_http_helpers__WEBPACK_IMPORTED_MODULE_10__["post"])("".concat(this.config.api, "/contact"), contact, this.headers(), {
                  useAPIKey: true
                });

              case 3:
                response = _context8.sent;
                this.updateState({
                  contacts: [].concat(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default()(((_this$getAddressState5 = this.getAddressState()) === null || _this$getAddressState5 === void 0 ? void 0 : _this$getAddressState5.contacts) || []), [response.data])
                });
                return _context8.abrupt("return", true);

              case 8:
                _context8.prev = 8;
                _context8.t0 = _context8["catch"](0);
                loglevel__WEBPACK_IMPORTED_MODULE_13___default.a.error("unable to add contact", _context8.t0);
                return _context8.abrupt("return", false);

              case 12:
              case "end":
                return _context8.stop();
            }
          }
        }, _callee8, this, [[0, 8]]);
      }));

      function addContact(_x8) {
        return _addContact.apply(this, arguments);
      }

      return addContact;
    }()
  }, {
    key: "deleteContact",
    value: function () {
      var _deleteContact = _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_9___default.a.mark(function _callee9(contactId) {
        var _this$getAddressState6, response, finalContacts;

        return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_9___default.a.wrap(function _callee9$(_context9) {
          while (1) {
            switch (_context9.prev = _context9.next) {
              case 0:
                _context9.prev = 0;
                _context9.next = 3;
                return Object(_toruslabs_http_helpers__WEBPACK_IMPORTED_MODULE_10__["remove"])("".concat(this.config.api, "/contact/").concat(contactId), {}, this.headers(), {
                  useAPIKey: true
                });

              case 3:
                response = _context9.sent;
                finalContacts = (_this$getAddressState6 = this.getAddressState()) === null || _this$getAddressState6 === void 0 ? void 0 : _this$getAddressState6.contacts.filter(function (contact) {
                  return contact.id !== response.data.id;
                });
                if (finalContacts) this.updateState({
                  contacts: _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default()(finalContacts)
                });
                return _context9.abrupt("return", true);

              case 9:
                _context9.prev = 9;
                _context9.t0 = _context9["catch"](0);
                loglevel__WEBPACK_IMPORTED_MODULE_13___default.a.error("unable to delete contact", _context9.t0);
                return _context9.abrupt("return", false);

              case 13:
              case "end":
                return _context9.stop();
            }
          }
        }, _callee9, this, [[0, 9]]);
      }));

      function deleteContact(_x9) {
        return _deleteContact.apply(this, arguments);
      }

      return deleteContact;
    }()
  }, {
    key: "revokeDiscord",
    value: function () {
      var _revokeDiscord = _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_9___default.a.mark(function _callee10(idToken) {
        var resp;
        return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_9___default.a.wrap(function _callee10$(_context10) {
          while (1) {
            switch (_context10.prev = _context10.next) {
              case 0:
                _context10.prev = 0;
                _context10.next = 3;
                return Object(_toruslabs_http_helpers__WEBPACK_IMPORTED_MODULE_10__["post"])("".concat(this.config.api, "/revoke/discord"), {
                  token: idToken
                }, this.headers(), {
                  useAPIKey: true
                });

              case 3:
                resp = _context10.sent;
                loglevel__WEBPACK_IMPORTED_MODULE_13___default.a.info(resp);
                _context10.next = 10;
                break;

              case 7:
                _context10.prev = 7;
                _context10.t0 = _context10["catch"](0);
                loglevel__WEBPACK_IMPORTED_MODULE_13___default.a.error(_context10.t0);

              case 10:
              case "end":
                return _context10.stop();
            }
          }
        }, _callee10, this, [[0, 7]]);
      }));

      function revokeDiscord(_x10) {
        return _revokeDiscord.apply(this, arguments);
      }

      return revokeDiscord;
    }()
  }, {
    key: "patchPastTx",
    value: function () {
      var _patchPastTx = _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_9___default.a.mark(function _callee11(body, address) {
        var response;
        return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_9___default.a.wrap(function _callee11$(_context11) {
          while (1) {
            switch (_context11.prev = _context11.next) {
              case 0:
                _context11.prev = 0;
                _context11.next = 3;
                return Object(_toruslabs_http_helpers__WEBPACK_IMPORTED_MODULE_10__["patch"])("".concat(this.config.api, "/transaction"), body, this.headers(address), {
                  useAPIKey: true
                });

              case 3:
                response = _context11.sent;
                loglevel__WEBPACK_IMPORTED_MODULE_13___default.a.info("successfully patched", response);
                _context11.next = 10;
                break;

              case 7:
                _context11.prev = 7;
                _context11.t0 = _context11["catch"](0);
                loglevel__WEBPACK_IMPORTED_MODULE_13___default.a.error("unable to patch tx", _context11.t0);

              case 10:
              case "end":
                return _context11.stop();
            }
          }
        }, _callee11, this, [[0, 7]]);
      }));

      function patchPastTx(_x11, _x12) {
        return _patchPastTx.apply(this, arguments);
      }

      return patchPastTx;
    }()
  }, {
    key: "postPastTx",
    value: function () {
      var _postPastTx = _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_9___default.a.mark(function _callee12(tx, address) {
        var response;
        return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_9___default.a.wrap(function _callee12$(_context12) {
          while (1) {
            switch (_context12.prev = _context12.next) {
              case 0:
                _context12.prev = 0;
                _context12.next = 3;
                return Object(_toruslabs_http_helpers__WEBPACK_IMPORTED_MODULE_10__["post"])("".concat(this.config.api, "/transaction"), tx, this.headers(address), {
                  useAPIKey: true
                });

              case 3:
                response = _context12.sent;
                loglevel__WEBPACK_IMPORTED_MODULE_13___default.a.info("successfully posted tx", response);
                return _context12.abrupt("return", response);

              case 8:
                _context12.prev = 8;
                _context12.t0 = _context12["catch"](0);
                loglevel__WEBPACK_IMPORTED_MODULE_13___default.a.error(_context12.t0, "unable to insert transaction");

              case 11:
              case "end":
                return _context12.stop();
            }
          }
        }, _callee12, this, [[0, 8]]);
      }));

      function postPastTx(_x13, _x14) {
        return _postPastTx.apply(this, arguments);
      }

      return postPastTx;
    }()
  }, {
    key: "getWalletOrders",
    value: function () {
      var _getWalletOrders = _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_9___default.a.mark(function _callee13(address) {
        var response;
        return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_9___default.a.wrap(function _callee13$(_context13) {
          while (1) {
            switch (_context13.prev = _context13.next) {
              case 0:
                _context13.prev = 0;
                _context13.next = 3;
                return Object(_toruslabs_http_helpers__WEBPACK_IMPORTED_MODULE_10__["get"])("".concat(this.config.api, "/transaction"), this.headers(address), {
                  useAPIKey: true
                });

              case 3:
                response = _context13.sent;
                return _context13.abrupt("return", response.success ? response.data ? response.data : [] : []);

              case 7:
                _context13.prev = 7;
                _context13.t0 = _context13["catch"](0);
                loglevel__WEBPACK_IMPORTED_MODULE_13___default.a.error("unable to get wallet orders tx", _context13.t0);
                return _context13.abrupt("return", []);

              case 11:
              case "end":
                return _context13.stop();
            }
          }
        }, _callee13, this, [[0, 7]]);
      }));

      function getWalletOrders(_x15) {
        return _getWalletOrders.apply(this, arguments);
      }

      return getWalletOrders;
    }()
  }, {
    key: "getTopUpOrders",
    value: function () {
      var _getTopUpOrders = _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_9___default.a.mark(function _callee14(address) {
        var response;
        return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_9___default.a.wrap(function _callee14$(_context14) {
          while (1) {
            switch (_context14.prev = _context14.next) {
              case 0:
                _context14.prev = 0;
                _context14.next = 3;
                return Object(_toruslabs_http_helpers__WEBPACK_IMPORTED_MODULE_10__["get"])("".concat(this.config.commonApiHost, "/transaction"), this.headers(address), {
                  useAPIKey: true
                });

              case 3:
                response = _context14.sent;
                return _context14.abrupt("return", response.data || []);

              case 7:
                _context14.prev = 7;
                _context14.t0 = _context14["catch"](0);
                loglevel__WEBPACK_IMPORTED_MODULE_13___default.a.error("unable to fetch past Top up orders", _context14.t0);

              case 10:
              case "end":
                return _context14.stop();
            }
          }
        }, _callee14, this, [[0, 7]]);
      }));

      function getTopUpOrders(_x16) {
        return _getTopUpOrders.apply(this, arguments);
      }

      return getTopUpOrders;
    }()
  }, {
    key: "getBillBoardData",
    value: function () {
      var _getBillBoardData = _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_9___default.a.mark(function _callee15() {
        var response;
        return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_9___default.a.wrap(function _callee15$(_context15) {
          while (1) {
            switch (_context15.prev = _context15.next) {
              case 0:
                _context15.prev = 0;
                _context15.next = 3;
                return Object(_toruslabs_http_helpers__WEBPACK_IMPORTED_MODULE_10__["get"])("".concat(this.config.api, "/billboard"), this.headers(), {
                  useAPIKey: true
                });

              case 3:
                response = _context15.sent;
                return _context15.abrupt("return", response.success ? response.data : []);

              case 7:
                _context15.prev = 7;
                _context15.t0 = _context15["catch"](0);
                loglevel__WEBPACK_IMPORTED_MODULE_13___default.a.error("unable to get billboard data", _context15.t0);
                return _context15.abrupt("return", []);

              case 11:
              case "end":
                return _context15.stop();
            }
          }
        }, _callee15, this, [[0, 7]]);
      }));

      function getBillBoardData() {
        return _getBillBoardData.apply(this, arguments);
      }

      return getBillBoardData;
    }()
  }, {
    key: "getMessageForSigning",
    value: function () {
      var _getMessageForSigning = _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_9___default.a.mark(function _callee16(publicAddress) {
        var response;
        return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_9___default.a.wrap(function _callee16$(_context16) {
          while (1) {
            switch (_context16.prev = _context16.next) {
              case 0:
                _context16.next = 2;
                return Object(_toruslabs_http_helpers__WEBPACK_IMPORTED_MODULE_10__["post"])("".concat(this.config.api, "/auth/message"), {
                  public_address: publicAddress
                }, {}, {
                  useAPIKey: true
                });

              case 2:
                response = _context16.sent;
                return _context16.abrupt("return", response.message);

              case 4:
              case "end":
                return _context16.stop();
            }
          }
        }, _callee16, this);
      }));

      function getMessageForSigning(_x17) {
        return _getMessageForSigning.apply(this, arguments);
      }

      return getMessageForSigning;
    }()
  }, {
    key: "getTwitterId",
    value: function () {
      var _getTwitterId = _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_9___default.a.mark(function _callee17(payload) {
        var res;
        return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_9___default.a.wrap(function _callee17$(_context17) {
          while (1) {
            switch (_context17.prev = _context17.next) {
              case 0:
                _context17.next = 2;
                return Object(_toruslabs_http_helpers__WEBPACK_IMPORTED_MODULE_10__["get"])("".concat(this.config.api, "/twitter?screen_name=").concat(payload.nick), this.headers(), {
                  useAPIKey: true
                });

              case 2:
                res = _context17.sent;
                return _context17.abrupt("return", "".concat(payload.typeOfLogin.toLowerCase(), "|").concat(res.data.toString()));

              case 4:
              case "end":
                return _context17.stop();
            }
          }
        }, _callee17, this);
      }));

      function getTwitterId(_x18) {
        return _getTwitterId.apply(this, arguments);
      }

      return getTwitterId;
    }()
  }, {
    key: "sendEmail",
    value: function () {
      var _sendEmail = _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_9___default.a.mark(function _callee18(payload) {
        return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_9___default.a.wrap(function _callee18$(_context18) {
          while (1) {
            switch (_context18.prev = _context18.next) {
              case 0:
                return _context18.abrupt("return", Object(_toruslabs_http_helpers__WEBPACK_IMPORTED_MODULE_10__["post"])("".concat(this.config.api, "/transaction/sendemail"), payload.emailObject, this.headers(), {
                  useAPIKey: true
                }));

              case 1:
              case "end":
                return _context18.stop();
            }
          }
        }, _callee18, this);
      }));

      function sendEmail(_x19) {
        return _sendEmail.apply(this, arguments);
      }

      return sendEmail;
    }()
  }, {
    key: "init",
    value: function () {
      var _init = _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_9___default.a.mark(function _callee19(address, userInfo, jwtToken) {
        var response, messageToSign, signedMessage;
        return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_9___default.a.wrap(function _callee19$(_context19) {
          while (1) {
            switch (_context19.prev = _context19.next) {
              case 0:
                response = {
                  token: jwtToken
                };

                if (!this.getAddressState(address)) {
                  _context19.next = 3;
                  break;
                }

                return _context19.abrupt("return");

              case 3:
                if (jwtToken) {
                  _context19.next = 13;
                  break;
                }

                _context19.next = 6;
                return this.getMessageForSigning(address);

              case 6:
                messageToSign = _context19.sent;

                if (messageToSign.startsWith(this.config.signInPrefix)) {
                  _context19.next = 9;
                  break;
                }

                throw new Error("Cannot sign on invalid message");

              case 9:
                signedMessage = this.signAuthMessage(address, messageToSign);
                _context19.next = 12;
                return Object(_toruslabs_http_helpers__WEBPACK_IMPORTED_MODULE_10__["post"])("".concat(this.config.api, "/auth/verify"), {
                  public_address: address,
                  signed_message: signedMessage
                }, {}, {
                  useAPIKey: true
                });

              case 12:
                response = _context19.sent;

              case 13:
                this.updateState({
                  jwtToken: response.token,
                  userInfo: userInfo
                }, address);

              case 14:
              case "end":
                return _context19.stop();
            }
          }
        }, _callee19, this);
      }));

      function init(_x20, _x21, _x22) {
        return _init.apply(this, arguments);
      }

      return init;
    }()
  }, {
    key: "updateState",
    value: function updateState(preferences, address) {
      var selectedAddress = address || this.state.selectedAddress;
      var currentState = this.getAddressState(selectedAddress) || Object(lodash__WEBPACK_IMPORTED_MODULE_12__["cloneDeep"])(this.defaultPreferences);

      var mergedState = _objectSpread(_objectSpread({}, currentState), preferences);

      this.update({
        identities: _objectSpread(_objectSpread({}, this.state.identities), {}, _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_8___default()({}, selectedAddress, mergedState))
      });
      return mergedState;
    }
  }, {
    key: "headers",
    value: function headers(address) {
      var _this$getAddressState7;

      var selectedAddress = address || this.state.selectedAddress;
      return {
        headers: {
          Authorization: "Bearer ".concat(((_this$getAddressState7 = this.getAddressState(selectedAddress)) === null || _this$getAddressState7 === void 0 ? void 0 : _this$getAddressState7.jwtToken) || ""),
          "Content-Type": "application/json; charset=utf-8"
        }
      };
    }
  }]);

  return BasePreferencesController;
}(_BaseController__WEBPACK_IMPORTED_MODULE_14__[/* default */ "a"]);

/***/ }),
/* 44 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return BaseTransactionStateManager; });
/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(6);
/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(8);
/* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(7);
/* harmony import */ var _babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(10);
/* harmony import */ var _babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var _babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(11);
/* harmony import */ var _babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(4);
/* harmony import */ var _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(1);
/* harmony import */ var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(21);
/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_7__);
/* harmony import */ var _BaseController__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(14);
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(9);
/* harmony import */ var _ITransactionController__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(12);








function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_6___default()(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_5___default()(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_5___default()(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_4___default()(this, result); }; }

function _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }





var BaseTransactionStateManager = /*#__PURE__*/function (_BaseController) {
  _babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_3___default()(BaseTransactionStateManager, _BaseController);

  var _super = _createSuper(BaseTransactionStateManager);

  function BaseTransactionStateManager(_ref) {
    var _this;

    var config = _ref.config,
        state = _ref.state,
        getCurrentChainId = _ref.getCurrentChainId;

    _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this, BaseTransactionStateManager);

    _this = _super.call(this, {
      config: config,
      state: state
    });

    _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_6___default()(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_2___default()(_this), "getCurrentChainId", void 0);

    _this.defaultConfig = {
      txHistoryLimit: 40
    };
    _this.defaultState = {
      transactions: {},
      unapprovedTxs: {},
      currentNetworkTxsList: []
    };

    _this.initialize();

    _this.getCurrentChainId = getCurrentChainId;
    return _this;
  }

  _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(BaseTransactionStateManager, [{
    key: "getUnapprovedTxList",
    value: function getUnapprovedTxList() {
      var chainId = this.getCurrentChainId();
      return Object(lodash__WEBPACK_IMPORTED_MODULE_7__["pickBy"])(this.state.transactions, function (transaction) {
        return transaction.status === _ITransactionController__WEBPACK_IMPORTED_MODULE_10__[/* TransactionStatus */ "c"].unapproved && Object(_utils__WEBPACK_IMPORTED_MODULE_9__[/* transactionMatchesNetwork */ "s"])(transaction, chainId);
      });
    }
  }, {
    key: "getTransaction",
    value: function getTransaction(txId) {
      var transactions = this.state.transactions;
      return transactions[txId];
    }
  }, {
    key: "updateTransaction",
    value: function updateTransaction(txMeta) {
      // commit txMeta to state
      var txId = txMeta.id;
      txMeta.updated_at = new Date().toISOString();
      this.update({
        transactions: _objectSpread(_objectSpread({}, this.state.transactions), {}, _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_6___default()({}, txId, txMeta))
      });
    }
  }, {
    key: "setTxStatusRejected",
    value: function setTxStatusRejected(txId) {
      this._setTransactionStatus(txId, _ITransactionController__WEBPACK_IMPORTED_MODULE_10__[/* TransactionStatus */ "c"].rejected);

      this._deleteTransaction(txId);
    }
    /**
     * The implementing controller can override this functionality and add custom logic + call super.()
     */

  }, {
    key: "setTxStatusUnapproved",
    value: function setTxStatusUnapproved(txId) {
      this._setTransactionStatus(txId, _ITransactionController__WEBPACK_IMPORTED_MODULE_10__[/* TransactionStatus */ "c"].unapproved);
    }
  }, {
    key: "setTxStatusApproved",
    value: function setTxStatusApproved(txId) {
      this._setTransactionStatus(txId, _ITransactionController__WEBPACK_IMPORTED_MODULE_10__[/* TransactionStatus */ "c"].approved);
    }
  }, {
    key: "setTxStatusSigned",
    value: function setTxStatusSigned(txId) {
      this._setTransactionStatus(txId, _ITransactionController__WEBPACK_IMPORTED_MODULE_10__[/* TransactionStatus */ "c"].signed);
    }
  }, {
    key: "setTxStatusSubmitted",
    value: function setTxStatusSubmitted(txId) {
      this._setTransactionStatus(txId, _ITransactionController__WEBPACK_IMPORTED_MODULE_10__[/* TransactionStatus */ "c"].submitted);
    }
  }, {
    key: "setTxStatusDropped",
    value: function setTxStatusDropped(txId) {
      this._setTransactionStatus(txId, _ITransactionController__WEBPACK_IMPORTED_MODULE_10__[/* TransactionStatus */ "c"].dropped);
    }
  }, {
    key: "setTxStatusExpired",
    value: function setTxStatusExpired(txId) {
      this._setTransactionStatus(txId, _ITransactionController__WEBPACK_IMPORTED_MODULE_10__[/* TransactionStatus */ "c"].expired);
    }
  }, {
    key: "setTxStatusConfirmed",
    value: function setTxStatusConfirmed(txId) {
      this._setTransactionStatus(txId, _ITransactionController__WEBPACK_IMPORTED_MODULE_10__[/* TransactionStatus */ "c"].confirmed);
    }
  }, {
    key: "setTxStatusFailed",
    value: function setTxStatusFailed(txId, error_) {
      var error = !error_ ? new Error("Internal torus failure") : error_;
      var txMeta = this.getTransaction(txId);
      txMeta.error = error;
      this.updateTransaction(txMeta);

      this._setTransactionStatus(txId, _ITransactionController__WEBPACK_IMPORTED_MODULE_10__[/* TransactionStatus */ "c"].failed);
    }
    /**
     * Method to determine if the transaction is in a final state
     * @param status - Transaction status
     * @returns boolean if the transaction is in a final state
     */

  }, {
    key: "isFinalState",
    value: function isFinalState(status) {
      return status === _ITransactionController__WEBPACK_IMPORTED_MODULE_10__[/* TransactionStatus */ "c"].rejected || status === _ITransactionController__WEBPACK_IMPORTED_MODULE_10__[/* TransactionStatus */ "c"].submitted || status === _ITransactionController__WEBPACK_IMPORTED_MODULE_10__[/* TransactionStatus */ "c"].confirmed || status === _ITransactionController__WEBPACK_IMPORTED_MODULE_10__[/* TransactionStatus */ "c"].failed || status === _ITransactionController__WEBPACK_IMPORTED_MODULE_10__[/* TransactionStatus */ "c"].cancelled || status === _ITransactionController__WEBPACK_IMPORTED_MODULE_10__[/* TransactionStatus */ "c"].expired;
    }
    /**
     * Filters out the unapproved transactions from state
     */

  }, {
    key: "clearUnapprovedTxs",
    value: function clearUnapprovedTxs() {
      this.update({
        transactions: Object(lodash__WEBPACK_IMPORTED_MODULE_7__["omitBy"])(this.state.transactions, function (transaction) {
          return transaction.status === _ITransactionController__WEBPACK_IMPORTED_MODULE_10__[/* TransactionStatus */ "c"].unapproved;
        })
      });
    }
    /**
     * will append new transactions to old txns.
     */

  }, {
    key: "_addTransactionsToState",
    value: function _addTransactionsToState(transactions) {
      this.update({
        transactions: transactions.reduce(function (result, newTx) {
          result[newTx.id] = newTx;
          return result;
        }, this.state.transactions)
      });
    }
    /**
     * will set new txns, override existing if any in state.
     */

  }, {
    key: "_setTransactionsToState",
    value: function _setTransactionsToState(transactions) {
      this.update({
        transactions: transactions.reduce(function (result, newTx) {
          result[newTx.id] = newTx;
          return result;
        }, {})
      });
    }
  }, {
    key: "_deleteTransaction",
    value: function _deleteTransaction(targetTransactionId) {
      var transactions = this.state.transactions;
      delete transactions[targetTransactionId];
      this.update({
        transactions: transactions
      });
    }
  }, {
    key: "_deleteTransactions",
    value: function _deleteTransactions(targetTransactionIds) {
      var transactions = this.state.transactions;
      targetTransactionIds.forEach(function (transactionId) {
        delete transactions[transactionId];
      });
      this.update({
        transactions: transactions
      });
    }
  }, {
    key: "_setTransactionStatus",
    value: function _setTransactionStatus(txId, status) {
      var txMeta = this.getTransaction(txId);

      if (!txMeta) {
        return;
      }

      txMeta.status = status; // only updating status so no validation required on txn.

      this.updateTransaction(txMeta);
      this.emit(_ITransactionController__WEBPACK_IMPORTED_MODULE_10__[/* TX_EVENTS */ "b"].TX_STATUS_UPDATE, {
        txId: txId,
        status: status
      });

      if (this.isFinalState(status)) {
        this.emit("".concat(txMeta.id, ":finished"), txMeta);
      } else {
        this.emit("".concat(txMeta.id, ":").concat(status), txId);
      }
    }
  }]);

  return BaseTransactionStateManager;
}(_BaseController__WEBPACK_IMPORTED_MODULE_8__[/* default */ "a"]);

/***/ }),
/* 45 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";

// EXPORTS
__webpack_require__.d(__webpack_exports__, "a", function() { return /* reexport */ BroadcastChannelHandler_BroadcastChannelHandler; });
__webpack_require__.d(__webpack_exports__, "b", function() { return /* reexport */ Popup_PopupHandler; });
__webpack_require__.d(__webpack_exports__, "c", function() { return /* reexport */ PopupStoreChannel_PopupStoreChannel; });
__webpack_require__.d(__webpack_exports__, "d", function() { return /* reexport */ Popup_PopupWithBcHandler; });
__webpack_require__.d(__webpack_exports__, "e", function() { return /* reexport */ RedirectHandler_RedirectHandler; });
__webpack_require__.d(__webpack_exports__, "f", function() { return /* reexport */ Popup_StreamWindow; });

// EXTERNAL MODULE: external "@babel/runtime/helpers/asyncToGenerator"
var asyncToGenerator_ = __webpack_require__(3);
var asyncToGenerator_default = /*#__PURE__*/__webpack_require__.n(asyncToGenerator_);

// EXTERNAL MODULE: external "@babel/runtime/helpers/classCallCheck"
var classCallCheck_ = __webpack_require__(6);
var classCallCheck_default = /*#__PURE__*/__webpack_require__.n(classCallCheck_);

// EXTERNAL MODULE: external "@babel/runtime/helpers/createClass"
var createClass_ = __webpack_require__(8);
var createClass_default = /*#__PURE__*/__webpack_require__.n(createClass_);

// EXTERNAL MODULE: external "@babel/runtime/helpers/defineProperty"
var defineProperty_ = __webpack_require__(1);
var defineProperty_default = /*#__PURE__*/__webpack_require__.n(defineProperty_);

// EXTERNAL MODULE: external "@babel/runtime/regenerator"
var regenerator_ = __webpack_require__(0);
var regenerator_default = /*#__PURE__*/__webpack_require__.n(regenerator_);

// EXTERNAL MODULE: external "broadcast-channel"
var external_broadcast_channel_ = __webpack_require__(16);

// EXTERNAL MODULE: ./src/enums.ts
var enums = __webpack_require__(2);

// EXTERNAL MODULE: ./src/utils/index.ts + 1 modules
var utils = __webpack_require__(9);

// CONCATENATED MODULE: ./src/Popup/BroadcastChannelHandler.ts









var BroadcastChannelHandler_BroadcastChannelHandler = /*#__PURE__*/function () {
  function BroadcastChannelHandler(channelPrefix) {
    classCallCheck_default()(this, BroadcastChannelHandler);

    defineProperty_default()(this, "bc", void 0);

    defineProperty_default()(this, "channel", void 0);

    var queryParameters = new URLSearchParams(window.location.search);
    var instanceId = queryParameters.get("instanceId");
    this.channel = "".concat(channelPrefix, "_").concat(instanceId);
    this.bc = new external_broadcast_channel_["BroadcastChannel"](this.channel, utils["c" /* broadcastChannelOptions */]);
  }

  createClass_default()(BroadcastChannelHandler, [{
    key: "getMessageFromChannel",
    value: function getMessageFromChannel() {
      var _this = this;

      return new Promise(function (resolve, reject) {
        _this.bc.addEventListener("message", /*#__PURE__*/function () {
          var _ref = asyncToGenerator_default()( /*#__PURE__*/regenerator_default.a.mark(function _callee(ev) {
            return regenerator_default.a.wrap(function _callee$(_context) {
              while (1) {
                switch (_context.prev = _context.next) {
                  case 0:
                    _this.bc.close();

                    if (ev.error) {
                      reject(ev.error);
                    } else {
                      resolve(ev.data);
                    }

                  case 2:
                  case "end":
                    return _context.stop();
                }
              }
            }, _callee);
          }));

          return function (_x) {
            return _ref.apply(this, arguments);
          };
        }());

        _this.bc.postMessage({
          data: {
            type: enums["v" /* POPUP_LOADED */]
          }
        });
      });
    }
  }]);

  return BroadcastChannelHandler;
}();


// CONCATENATED MODULE: ./src/Popup/interfaces.ts

// EXTERNAL MODULE: external "@babel/runtime/helpers/inherits"
var inherits_ = __webpack_require__(10);
var inherits_default = /*#__PURE__*/__webpack_require__.n(inherits_);

// EXTERNAL MODULE: external "@babel/runtime/helpers/possibleConstructorReturn"
var possibleConstructorReturn_ = __webpack_require__(11);
var possibleConstructorReturn_default = /*#__PURE__*/__webpack_require__.n(possibleConstructorReturn_);

// EXTERNAL MODULE: external "@babel/runtime/helpers/getPrototypeOf"
var getPrototypeOf_ = __webpack_require__(4);
var getPrototypeOf_default = /*#__PURE__*/__webpack_require__.n(getPrototypeOf_);

// EXTERNAL MODULE: ./src/BaseController.ts
var BaseController = __webpack_require__(14);

// EXTERNAL MODULE: external "@babel/runtime/helpers/assertThisInitialized"
var assertThisInitialized_ = __webpack_require__(7);
var assertThisInitialized_default = /*#__PURE__*/__webpack_require__.n(assertThisInitialized_);

// EXTERNAL MODULE: external "loglevel"
var external_loglevel_ = __webpack_require__(5);
var external_loglevel_default = /*#__PURE__*/__webpack_require__.n(external_loglevel_);

// CONCATENATED MODULE: ./src/Popup/StreamWindow.ts










function _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = getPrototypeOf_default()(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = getPrototypeOf_default()(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return possibleConstructorReturn_default()(this, result); }; }

function _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }







var StreamWindow_StreamWindow = /*#__PURE__*/function (_BaseController) {
  inherits_default()(StreamWindow, _BaseController);

  var _super = _createSuper(StreamWindow);

  // if window has been closed by users
  function StreamWindow(_ref) {
    var _this;

    var config = _ref.config,
        _ref$state = _ref.state,
        state = _ref$state === void 0 ? {} : _ref$state;

    classCallCheck_default()(this, StreamWindow);

    _this = _super.call(this, {
      config: config,
      state: state
    });

    defineProperty_default()(assertThisInitialized_default()(_this), "closed", false);

    _this.initialize();

    return _this;
  }

  createClass_default()(StreamWindow, [{
    key: "open",
    value: function () {
      var _open = asyncToGenerator_default()( /*#__PURE__*/regenerator_default.a.mark(function _callee2() {
        var _this2 = this;

        return regenerator_default.a.wrap(function _callee2$(_context2) {
          while (1) {
            switch (_context2.prev = _context2.next) {
              case 0:
                return _context2.abrupt("return", new Promise(function (resolve, reject) {
                  var _this2$config = _this2.config,
                      communicationEngine = _this2$config.communicationEngine,
                      communicationWindowManager = _this2$config.communicationWindowManager;
                  communicationWindowManager.once("".concat(_this2.state.windowId, ":closed"), function () {
                    _this2.closed = true;
                  }); // Window is not open yet

                  // Window is not open yet
                  if (!_this2.state.windowId) {
                    _this2.update({
                      windowId: Object(utils["o" /* randomId */])()
                    });

                    communicationWindowManager.once("".concat(_this2.state.windowId, ":opened"), function () {
                      resolve(_this2);
                    }); // Tell the other party to create a window by prompting the user to click on something

                    // Tell the other party to create a window by prompting the user to click on something
                    communicationEngine.emit("notification", {
                      method: enums["q" /* COMMUNICATION_NOTIFICATIONS */].CREATE_WINDOW,
                      params: {
                        windowId: _this2.state.windowId,
                        url: _this2.state.url.href
                      }
                    });
                  } else {
                    // Send this window with `windowId` the url to open via bc
                    var bc = new external_broadcast_channel_["BroadcastChannel"](_this2.state.windowId, utils["c" /* broadcastChannelOptions */]);
                    var writeInterval = null;
                    bc.addEventListener("message", /*#__PURE__*/function () {
                      var _ref2 = asyncToGenerator_default()( /*#__PURE__*/regenerator_default.a.mark(function _callee(ev) {
                        var error, message;
                        return regenerator_default.a.wrap(function _callee$(_context) {
                          while (1) {
                            switch (_context.prev = _context.next) {
                              case 0:
                                _context.prev = 0;
                                external_loglevel_default.a.info(ev, "receiving data on channel: ".concat(bc.name));
                                error = ev.error;

                                if (!error) {
                                  _context.next = 6;
                                  break;
                                }

                                // Popup says some error. so, we say it's not really opened
                                reject(new Error(error));
                                return _context.abrupt("return");

                              case 6:
                                message = ev.data.message;

                                if (!(message === enums["v" /* POPUP_LOADED */])) {
                                  _context.next = 13;
                                  break;
                                }

                                if (writeInterval) window.clearInterval(writeInterval);
                                _context.next = 11;
                                return bc.postMessage({
                                  data: {
                                    url: _this2.state.url.href,
                                    message: "" // No need of a msg

                                  }
                                });

                              case 11:
                                resolve(_this2);
                                bc.close();

                              case 13:
                                _context.next = 20;
                                break;

                              case 15:
                                _context.prev = 15;
                                _context.t0 = _context["catch"](0);
                                reject(_context.t0);
                                bc.close(); // Something went wrong. so, we close that window

                                // Something went wrong. so, we close that window
                                _this2.close();

                              case 20:
                              case "end":
                                return _context.stop();
                            }
                          }
                        }, _callee, null, [[0, 15]]);
                      }));

                      return function (_x) {
                        return _ref2.apply(this, arguments);
                      };
                    }()); // We don't know if the other end is ready to receive this msg. So, we keep writing until it receives and sends back something

                    // We don't know if the other end is ready to receive this msg. So, we keep writing until it receives and sends back something
                    writeInterval = window.setInterval(function () {
                      bc.postMessage({
                        data: {
                          message: enums["z" /* SETUP_COMPLETE */]
                        }
                      });
                    }, 200);
                  }
                }));

              case 1:
              case "end":
                return _context2.stop();
            }
          }
        }, _callee2);
      }));

      function open() {
        return _open.apply(this, arguments);
      }

      return open;
    }()
  }, {
    key: "close",
    value: function close() {
      var communicationEngine = this.config.communicationEngine;
      communicationEngine.emit("notification", {
        method: enums["q" /* COMMUNICATION_NOTIFICATIONS */].CLOSE_WINDOW,
        params: {
          windowId: this.state.windowId
        }
      });
    }
  }]);

  return StreamWindow;
}(BaseController["a" /* default */]);

/* harmony default export */ var Popup_StreamWindow = (StreamWindow_StreamWindow);
// CONCATENATED MODULE: ./src/Popup/PopupHandler.ts








function PopupHandler_createSuper(Derived) { var hasNativeReflectConstruct = PopupHandler_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = getPrototypeOf_default()(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = getPrototypeOf_default()(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return possibleConstructorReturn_default()(this, result); }; }

function PopupHandler_isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }





/*
Scenarios:
1. Open a normal popup window and no communication with it - Use PopupHandler
2. Open a popup window and communicate with it - Use PopupWithBcHandler (can initiate communication by waiting for window to open or not)

3. If window is already opened, pass in windowId to the popup handler. 
   This will establish communication with the popup window and sends it a new url to redirect to


If you're trying to open a window and it gets blocked (happens if you're in iframe or delay b/w click and opening window),
StreamWindow is invoked and it writes in a channel to display a message to the user

Once user clicks on that modal/dialog, we pre-open the window and pass in the windowId (goes to 3)
*/

/**
 * Handles popup window management.
 * For broadcast channel communication, use url with `instanceId` coded into state parameter.
 * This state parameter will be passed across redirects according to OAuth spec.
 */

var PopupHandler_PopupHandler = /*#__PURE__*/function (_BaseController) {
  inherits_default()(PopupHandler, _BaseController);

  var _super = PopupHandler_createSuper(PopupHandler);

  function PopupHandler(_ref) {
    var _this;

    var config = _ref.config,
        state = _ref.state;

    classCallCheck_default()(this, PopupHandler);

    _this = _super.call(this, {
      config: config,
      state: state
    }); // this.id = randomId()
    // Add in dapp storage key to all popups as a hash parameter

    _this.defaultConfig = {
      dappStorageKey: "",
      features: Object(utils["i" /* getPopupFeatures */])(enums["s" /* FEATURES_DEFAULT_POPUP_WINDOW */]),
      target: "_blank",
      communicationEngine: null,
      communicationWindowManager: null
    };
    _this.defaultState = {
      windowTimer: null,
      window: null,
      iClosedWindow: false,
      windowId: "",
      url: state.url
    };

    _this.initialize();

    _this._setupTimer();

    return _this;
  }

  createClass_default()(PopupHandler, [{
    key: "open",
    value: function () {
      var _open = asyncToGenerator_default()( /*#__PURE__*/regenerator_default.a.mark(function _callee() {
        var _this$config, target, features, dappStorageKey, communicationEngine, communicationWindowManager, _this$state, windowId, url, urlHashParams, _localWindow, localWindow;

        return regenerator_default.a.wrap(function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                // if window is already open
                _this$config = this.config, target = _this$config.target, features = _this$config.features, dappStorageKey = _this$config.dappStorageKey, communicationEngine = _this$config.communicationEngine, communicationWindowManager = _this$config.communicationWindowManager;
                _this$state = this.state, windowId = _this$state.windowId, url = _this$state.url;

                if (dappStorageKey) {
                  urlHashParams = new URLSearchParams(url.hash.slice(1));
                  urlHashParams.append("dappStorageKey", dappStorageKey);
                  url.hash = urlHashParams.toString();
                  this.update({
                    url: url
                  });
                } // No window has been pre-opened


                if (windowId) {
                  _context.next = 8;
                  break;
                }

                // try to open a window first
                _localWindow = window.open(url.href, target, features);

                if (!_localWindow) {
                  // if it's blocked, open StreamWindow
                  _localWindow = new Popup_StreamWindow({
                    config: {
                      communicationEngine: communicationEngine,
                      communicationWindowManager: communicationWindowManager
                    },
                    state: {
                      url: url
                    }
                  });

                  _localWindow.open();
                }

                this.update({
                  window: _localWindow
                });
                return _context.abrupt("return");

              case 8:
                // A window has been pre-opened with a query parameter `windowId`
                localWindow = new Popup_StreamWindow({
                  config: {
                    communicationEngine: communicationEngine,
                    communicationWindowManager: communicationWindowManager
                  },
                  state: {
                    url: url,
                    windowId: windowId
                  }
                });
                this.update({
                  window: localWindow
                });
                _context.next = 12;
                return localWindow.open();

              case 12:
              case "end":
                return _context.stop();
            }
          }
        }, _callee, this);
      }));

      function open() {
        return _open.apply(this, arguments);
      }

      return open;
    }()
  }, {
    key: "close",
    value: function close() {
      this.update({
        iClosedWindow: true
      });
      var window = this.state.window;
      if (window) window.close();
    }
  }, {
    key: "_setupTimer",
    value: function _setupTimer() {
      var _this2 = this;

      var timer = window.setInterval(function () {
        var _this2$state = _this2.state,
            window = _this2$state.window,
            windowTimer = _this2$state.windowTimer,
            iClosedWindow = _this2$state.iClosedWindow;

        if (window && window.closed) {
          if (windowTimer) clearInterval(windowTimer);

          if (!iClosedWindow) {
            _this2.emit("close");
          }

          _this2.update({
            iClosedWindow: false,
            window: null
          });
        }

        if (window === null && windowTimer) clearInterval(windowTimer);
      }, 500);
      this.update({
        windowTimer: timer
      });
    }
  }]);

  return PopupHandler;
}(BaseController["a" /* default */]);

/* harmony default export */ var Popup_PopupHandler = (PopupHandler_PopupHandler);
// CONCATENATED MODULE: ./src/Popup/PopupStoreChannel.ts








var PopupStoreChannel_PopupStoreChannel = /*#__PURE__*/function () {
  function PopupStoreChannel(_ref) {
    var instanceId = _ref.instanceId,
        handleLogout = _ref.handleLogout,
        handleAccountImport = _ref.handleAccountImport,
        handleNetworkChange = _ref.handleNetworkChange,
        handleSelectedAddressChange = _ref.handleSelectedAddressChange;

    classCallCheck_default()(this, PopupStoreChannel);

    defineProperty_default()(this, "handleLogout", void 0);

    defineProperty_default()(this, "handleAccountImport", void 0);

    defineProperty_default()(this, "handleNetworkChange", void 0);

    defineProperty_default()(this, "handleSelectedAddressChange", void 0);

    defineProperty_default()(this, "instanceId", void 0);

    this.instanceId = instanceId;
    this.handleLogout = handleLogout;
    this.handleAccountImport = handleAccountImport;
    this.handleNetworkChange = handleNetworkChange;
    this.handleSelectedAddressChange = handleSelectedAddressChange;
  }

  createClass_default()(PopupStoreChannel, [{
    key: "setupStoreChannels",
    value: function setupStoreChannels() {
      this.logoutChannel();
      this.importAccountChannel();
      this.networkChangeChannel();
      this.selectedAddressChangeChannel();
    }
  }, {
    key: "logoutChannel",
    value: function logoutChannel() {
      var _this = this;

      var logoutChannel = new external_broadcast_channel_["BroadcastChannel"]("".concat(enums["n" /* BROADCAST_CHANNELS */].WALLET_LOGOUT_CHANNEL, "_").concat(this.instanceId), utils["c" /* broadcastChannelOptions */]);
      logoutChannel.addEventListener("message", function (ev) {
        var _ev$data;

        external_loglevel_default.a.info("received logout message", ev);

        if (!ev.error && ((_ev$data = ev.data) === null || _ev$data === void 0 ? void 0 : _ev$data.type) === enums["o" /* BROADCAST_CHANNELS_MSGS */].LOGOUT) {
          external_loglevel_default.a.info("Logging Out");

          _this.handleLogout();
        }
      });
    }
  }, {
    key: "importAccountChannel",
    value: function importAccountChannel() {
      var _this2 = this;

      var walletAccountImportChannel = new external_broadcast_channel_["BroadcastChannel"]("".concat(enums["n" /* BROADCAST_CHANNELS */].WALLET_ACCOUNT_IMPORT_CHANNEL, "_").concat(this.instanceId), utils["c" /* broadcastChannelOptions */]);
      walletAccountImportChannel.addEventListener("message", function (ev) {
        var _ev$data2;

        if (!ev.error && ((_ev$data2 = ev.data) === null || _ev$data2 === void 0 ? void 0 : _ev$data2.type) === enums["o" /* BROADCAST_CHANNELS_MSGS */].ACCOUNT_IMPORTED) {
          var _ev$data3;

          _this2.handleAccountImport((_ev$data3 = ev.data) === null || _ev$data3 === void 0 ? void 0 : _ev$data3.privKey);
        }
      });
    }
  }, {
    key: "networkChangeChannel",
    value: function networkChangeChannel() {
      var _this3 = this;

      var walletAccountImportChannel = new external_broadcast_channel_["BroadcastChannel"]("".concat(enums["n" /* BROADCAST_CHANNELS */].WALLET_NETWORK_CHANGE_CHANNEL, "_").concat(this.instanceId), utils["c" /* broadcastChannelOptions */]);
      walletAccountImportChannel.addEventListener("message", function (ev) {
        var _ev$data4;

        if (!ev.error && ((_ev$data4 = ev.data) === null || _ev$data4 === void 0 ? void 0 : _ev$data4.type) === enums["o" /* BROADCAST_CHANNELS_MSGS */].NETWORK_CHANGE) {
          var _ev$data5;

          _this3.handleNetworkChange((_ev$data5 = ev.data) === null || _ev$data5 === void 0 ? void 0 : _ev$data5.network);
        }
      });
    }
  }, {
    key: "selectedAddressChangeChannel",
    value: function selectedAddressChangeChannel() {
      var _this4 = this;

      var walletAccountImportChannel = new external_broadcast_channel_["BroadcastChannel"]("".concat(enums["n" /* BROADCAST_CHANNELS */].WALLET_SELECTED_ADDRESS_CHANNEL, "_").concat(this.instanceId), utils["c" /* broadcastChannelOptions */]);
      walletAccountImportChannel.addEventListener("message", function (ev) {
        var _ev$data6;

        if (!ev.error && ((_ev$data6 = ev.data) === null || _ev$data6 === void 0 ? void 0 : _ev$data6.type) === enums["o" /* BROADCAST_CHANNELS_MSGS */].SELECTED_ADDRESS_CHANGE) {
          var _ev$data7;

          _this4.handleSelectedAddressChange((_ev$data7 = ev.data) === null || _ev$data7 === void 0 ? void 0 : _ev$data7.selectedAddress);
        }
      });
    }
  }]);

  return PopupStoreChannel;
}();


// CONCATENATED MODULE: ./src/Popup/PopupWithBcHandler.ts










function PopupWithBcHandler_createSuper(Derived) { var hasNativeReflectConstruct = PopupWithBcHandler_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = getPrototypeOf_default()(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = getPrototypeOf_default()(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return possibleConstructorReturn_default()(this, result); }; }

function PopupWithBcHandler_isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }






/**
 * PopupWithBcHandler is a PopupHandler which uses broadcast channel to communicate with the popup window.
 */

var PopupWithBcHandler_PopupWithBcHandler = /*#__PURE__*/function (_PopupHandler) {
  inherits_default()(PopupWithBcHandler, _PopupHandler);

  var _super = PopupWithBcHandler_createSuper(PopupWithBcHandler);

  function PopupWithBcHandler(_ref) {
    var _this;

    var config = _ref.config,
        state = _ref.state,
        instanceId = _ref.instanceId;

    classCallCheck_default()(this, PopupWithBcHandler);

    _this = _super.call(this, {
      config: config,
      state: state
    });

    defineProperty_default()(assertThisInitialized_default()(_this), "bc", void 0);

    _this.bc = new external_broadcast_channel_["BroadcastChannel"](instanceId, utils["c" /* broadcastChannelOptions */]);
    return _this;
  }
  /**
   * Receives the data from popup window and closes the window
   * @param successExtraFn - Extra function to be called after the data is received
   * @returns The data to be received
   */


  createClass_default()(PopupWithBcHandler, [{
    key: "handle",
    value: function handle(successExtraFn) {
      var _this2 = this;

      return new Promise(function (resolve, reject) {
        var closeListener = function closeListener() {
          _this2.bc.close();

          reject(new utils["a" /* UserError */]("user closed popup"));

          _this2.removeListener("close", closeListener);
        };

        _this2.on("close", closeListener);

        _this2.bc.addEventListener("message", /*#__PURE__*/function () {
          var _ref2 = asyncToGenerator_default()( /*#__PURE__*/regenerator_default.a.mark(function _callee(ev) {
            var error, data;
            return regenerator_default.a.wrap(function _callee$(_context) {
              while (1) {
                switch (_context.prev = _context.next) {
                  case 0:
                    external_loglevel_default.a.info(ev, "receiving data on channel: ".concat(_this2.bc.name));
                    _context.prev = 1;
                    error = ev.error, data = ev.data;

                    if (!error) {
                      _context.next = 6;
                      break;
                    }

                    reject(new Error(error));
                    return _context.abrupt("return");

                  case 6:
                    if (!successExtraFn) {
                      _context.next = 9;
                      break;
                    }

                    _context.next = 9;
                    return successExtraFn.call(_this2, data);

                  case 9:
                    resolve(data);
                    _context.next = 15;
                    break;

                  case 12:
                    _context.prev = 12;
                    _context.t0 = _context["catch"](1);
                    reject(_context.t0);

                  case 15:
                    _context.prev = 15;

                    _this2.bc.close();

                    _this2.close();

                    return _context.finish(15);

                  case 19:
                  case "end":
                    return _context.stop();
                }
              }
            }, _callee, null, [[1, 12, 15, 19]]);
          }));

          return function (_x) {
            return _ref2.apply(this, arguments);
          };
        }());

        _this2.open().then(function () {
          external_loglevel_default.a.info("opened window ".concat(_this2.bc.name)); // Opened window. yay.  let the bc events do their job

          return undefined;
        })["catch"](function (err) {
          external_loglevel_default.a.error(err, "something went wrong while opening window");
          reject(err);
        });
      });
    }
    /**
     * Use this if we have to send large payloads which don't fit in query/hash params.
     * Waits for ack that popup window is ready to receive data.
     * Receives the data from popup window and closes the window
     * @param payload - The data to be sent to the popup window once we have ack that window is ready to receive data
     * @param successExtraFn - Extra function to be called after the data is received
     * @returns The data to be received
     */

  }, {
    key: "handleWithHandshake",
    value: function handleWithHandshake(payload, successExtraFn) {
      var _this3 = this;

      return new Promise(function (resolve, reject) {
        var closeListener = function closeListener() {
          _this3.bc.close();

          reject(new utils["a" /* UserError */]("user closed popup"));

          _this3.removeListener("close", closeListener);
        };

        _this3.on("close", closeListener);

        _this3.bc.addEventListener("message", /*#__PURE__*/function () {
          var _ref3 = asyncToGenerator_default()( /*#__PURE__*/regenerator_default.a.mark(function _callee2(ev) {
            var error, data, _ref4, _ref4$type, type;

            return regenerator_default.a.wrap(function _callee2$(_context2) {
              while (1) {
                switch (_context2.prev = _context2.next) {
                  case 0:
                    _context2.prev = 0;
                    external_loglevel_default.a.info(ev, "receiving data on channel: ".concat(_this3.bc.name));
                    error = ev.error, data = ev.data;

                    if (!error) {
                      _context2.next = 6;
                      break;
                    }

                    reject(new Error(error));
                    return _context2.abrupt("return");

                  case 6:
                    // Do handshake
                    _ref4 = data, _ref4$type = _ref4.type, type = _ref4$type === void 0 ? "" : _ref4$type;

                    if (!(type === enums["v" /* POPUP_LOADED */])) {
                      _context2.next = 12;
                      break;
                    }

                    _context2.next = 10;
                    return _this3.bc.postMessage({
                      data: payload
                    });

                  case 10:
                    _context2.next = 19;
                    break;

                  case 12:
                    if (!(type === enums["w" /* POPUP_RESULT */])) {
                      _context2.next = 19;
                      break;
                    }

                    if (!successExtraFn) {
                      _context2.next = 16;
                      break;
                    }

                    _context2.next = 16;
                    return successExtraFn.call(_this3, data);

                  case 16:
                    resolve(data); // Must only close the bc after result is done

                    _this3.bc.close();

                    _this3.close();

                  case 19:
                    _context2.next = 26;
                    break;

                  case 21:
                    _context2.prev = 21;
                    _context2.t0 = _context2["catch"](0);
                    reject(_context2.t0);

                    _this3.bc.close();

                    _this3.close();

                  case 26:
                  case "end":
                    return _context2.stop();
                }
              }
            }, _callee2, null, [[0, 21]]);
          }));

          return function (_x2) {
            return _ref3.apply(this, arguments);
          };
        }());

        _this3.open().then(function () {
          external_loglevel_default.a.info("opened window ".concat(_this3.bc.name)); // Opened window. yay.  let the bc events do their job

          return undefined;
        })["catch"](function (err) {
          external_loglevel_default.a.error(err, "something went wrong while opening window");
          reject(err);
        });
      });
    }
  }]);

  return PopupWithBcHandler;
}(Popup_PopupHandler);

/* harmony default export */ var Popup_PopupWithBcHandler = (PopupWithBcHandler_PopupWithBcHandler);
// EXTERNAL MODULE: ./src/utils/utils.ts
var utils_utils = __webpack_require__(19);

// CONCATENATED MODULE: ./src/Popup/RedirectHandler.ts










var RedirectHandler_RedirectHandler = /*#__PURE__*/function () {
  function RedirectHandler() {
    var _this = this;

    classCallCheck_default()(this, RedirectHandler);

    defineProperty_default()(this, "error", void 0);

    defineProperty_default()(this, "finalQueryParams", {});

    defineProperty_default()(this, "instanceParameters", void 0);

    defineProperty_default()(this, "hashParameters", void 0);

    var hash = window.location.hash;
    var queryParameters = new URLSearchParams(window.location.search);
    queryParameters.forEach(function (value, key) {
      _this.finalQueryParams[key] = value;
    });

    var _handleRedirectParame = Object(utils_utils["j" /* handleRedirectParameters */])(hash, this.finalQueryParams),
        error = _handleRedirectParame.error,
        instanceParameters = _handleRedirectParame.instanceParameters,
        hashParameters = _handleRedirectParame.hashParameters;

    this.error = error;
    this.instanceParameters = instanceParameters;
    this.hashParameters = hashParameters;
  }

  createClass_default()(RedirectHandler, [{
    key: "handle",
    value: function () {
      var _handle = asyncToGenerator_default()( /*#__PURE__*/regenerator_default.a.mark(function _callee3() {
        var _this2 = this;

        return regenerator_default.a.wrap(function _callee3$(_context3) {
          while (1) {
            switch (_context3.prev = _context3.next) {
              case 0:
                return _context3.abrupt("return", new Promise(function (resolve, reject) {
                  var finalQueryParams = _this2.finalQueryParams,
                      instanceParameters = _this2.instanceParameters,
                      hashParameters = _this2.hashParameters,
                      error = _this2.error;
                  var bc;

                  try {
                    if (!finalQueryParams.windowId) {
                      bc = new external_broadcast_channel_["BroadcastChannel"]("".concat(enums["n" /* BROADCAST_CHANNELS */].REDIRECT_CHANNEL, "_").concat(instanceParameters.instanceId), utils_utils["c" /* broadcastChannelOptions */]);
                      bc.addEventListener("message", /*#__PURE__*/function () {
                        var _ref = asyncToGenerator_default()( /*#__PURE__*/regenerator_default.a.mark(function _callee(ev) {
                          return regenerator_default.a.wrap(function _callee$(_context) {
                            while (1) {
                              switch (_context.prev = _context.next) {
                                case 0:
                                  if (ev.error) {
                                    reject(ev.error);
                                    window.close();
                                  } else {
                                    resolve();
                                    bc.close();
                                    external_loglevel_default.a.info("posted", {
                                      finalQueryParams: finalQueryParams,
                                      hashParameters: hashParameters,
                                      instanceParameters: instanceParameters
                                    });
                                  }

                                case 1:
                                case "end":
                                  return _context.stop();
                              }
                            }
                          }, _callee);
                        }));

                        return function (_x) {
                          return _ref.apply(this, arguments);
                        };
                      }());
                      bc.postMessage({
                        data: {
                          instanceParams: instanceParameters,
                          hashParams: hashParameters,
                          queryParams: finalQueryParams
                        },
                        error: error
                      });
                      setTimeout(function () {
                        resolve();
                        window.location.href = window.location.origin + window.location.search + window.location.hash;
                      }, 5000);
                    } else {
                      bc = new external_broadcast_channel_["BroadcastChannel"]("".concat(finalQueryParams.windowId), utils_utils["c" /* broadcastChannelOptions */]);
                      bc.addEventListener("message", /*#__PURE__*/function () {
                        var _ref2 = asyncToGenerator_default()( /*#__PURE__*/regenerator_default.a.mark(function _callee2(ev) {
                          var _ref3, url, message;

                          return regenerator_default.a.wrap(function _callee2$(_context2) {
                            while (1) {
                              switch (_context2.prev = _context2.next) {
                                case 0:
                                  _ref3 = ev.data, url = _ref3.url, message = _ref3.message;

                                  if (!url) {
                                    _context2.next = 6;
                                    break;
                                  }

                                  resolve();
                                  window.location.href = url;
                                  _context2.next = 9;
                                  break;

                                case 6:
                                  if (!(message === enums["z" /* SETUP_COMPLETE */])) {
                                    _context2.next = 9;
                                    break;
                                  }

                                  _context2.next = 9;
                                  return bc.postMessage({
                                    data: {
                                      windowId: finalQueryParams.windowId,
                                      message: enums["v" /* POPUP_LOADED */]
                                    }
                                  });

                                case 9:
                                  if (ev.error && ev.error !== "") {
                                    external_loglevel_default.a.error(ev.error);
                                    resolve();
                                    bc.close();
                                  }

                                case 10:
                                case "end":
                                  return _context2.stop();
                              }
                            }
                          }, _callee2);
                        }));

                        return function (_x2) {
                          return _ref2.apply(this, arguments);
                        };
                      }());
                    }
                  } catch (err) {
                    external_loglevel_default.a.info(err, "something went wrong");
                    reject(err);
                    if (bc) bc.close();
                    window.close();
                  }
                }));

              case 1:
              case "end":
                return _context3.stop();
            }
          }
        }, _callee3);
      }));

      function handle() {
        return _handle.apply(this, arguments);
      }

      return handle;
    }()
  }]);

  return RedirectHandler;
}();


// CONCATENATED MODULE: ./src/Popup/index.ts








/***/ }),
/* 46 */
/***/ (function(module, exports) {

module.exports = require("@babel/runtime/helpers/wrapNativeSuper");

/***/ }),
/* 47 */
/***/ (function(module, exports) {

module.exports = require("bowser");

/***/ }),
/* 48 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _Account_IAccountTrackerController__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(29);
/* harmony import */ var _BaseController__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(14);
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "BaseController", function() { return _BaseController__WEBPACK_IMPORTED_MODULE_1__["a"]; });

/* harmony import */ var _Block_BaseBlockTracker__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(30);
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "BaseBlockTracker", function() { return _Block_BaseBlockTracker__WEBPACK_IMPORTED_MODULE_2__["a"]; });

/* harmony import */ var _Block_IBlockTrackerController__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(31);
/* harmony import */ var _createEventEmitterProxy__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(32);
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "createEventEmitterProxy", function() { return _createEventEmitterProxy__WEBPACK_IMPORTED_MODULE_4__["a"]; });

/* harmony import */ var _createSwappableProxy__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(22);
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "createSwappableProxy", function() { return _createSwappableProxy__WEBPACK_IMPORTED_MODULE_5__["a"]; });

/* harmony import */ var _Currency_BaseCurrencyController__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(33);
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "BaseCurrencyController", function() { return _Currency_BaseCurrencyController__WEBPACK_IMPORTED_MODULE_6__["a"]; });

/* harmony import */ var _Currency_ICurrencyController__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(34);
/* harmony import */ var _Embed_BaseEmbedController__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(35);
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "BaseEmbedController", function() { return _Embed_BaseEmbedController__WEBPACK_IMPORTED_MODULE_8__["a"]; });

/* harmony import */ var _Embed_CommunicationMethodMiddleware__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(24);
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "createChangeProviderMiddlewareMiddleware", function() { return _Embed_CommunicationMethodMiddleware__WEBPACK_IMPORTED_MODULE_9__["a"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "createTopupMiddleware", function() { return _Embed_CommunicationMethodMiddleware__WEBPACK_IMPORTED_MODULE_9__["c"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "createCommunicationMiddleware", function() { return _Embed_CommunicationMethodMiddleware__WEBPACK_IMPORTED_MODULE_9__["b"]; });

/* harmony import */ var _Embed_CommunicationWindowManager__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(36);
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "CommunicationWindowManager", function() { return _Embed_CommunicationWindowManager__WEBPACK_IMPORTED_MODULE_10__["a"]; });

/* harmony import */ var _Embed_IEmbedController__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(37);
/* harmony import */ var _Embed_IEmbedController__WEBPACK_IMPORTED_MODULE_11___default = /*#__PURE__*/__webpack_require__.n(_Embed_IEmbedController__WEBPACK_IMPORTED_MODULE_11__);
/* harmony reexport (unknown) */ for(var __WEBPACK_IMPORT_KEY__ in _Embed_IEmbedController__WEBPACK_IMPORTED_MODULE_11__) if(["default","BaseController","createEventEmitterProxy","createSwappableProxy","CommunicationWindowManager","BaseBlockTracker","BaseCurrencyController","BaseEmbedController","createChangeProviderMiddlewareMiddleware","createTopupMiddleware","createCommunicationMiddleware"].indexOf(__WEBPACK_IMPORT_KEY__) < 0) (function(key) { __webpack_require__.d(__webpack_exports__, key, function() { return _Embed_IEmbedController__WEBPACK_IMPORTED_MODULE_11__[key]; }) }(__WEBPACK_IMPORT_KEY__));
/* harmony import */ var _enums__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(2);
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "FEATURES_PROVIDER_CHANGE_WINDOW", function() { return _enums__WEBPACK_IMPORTED_MODULE_12__["u"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "FEATURES_DEFAULT_WALLET_WINDOW", function() { return _enums__WEBPACK_IMPORTED_MODULE_12__["t"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "FEATURES_DEFAULT_POPUP_WINDOW", function() { return _enums__WEBPACK_IMPORTED_MODULE_12__["s"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "FEATURES_CONFIRM_WINDOW", function() { return _enums__WEBPACK_IMPORTED_MODULE_12__["r"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "POPUP_LOADED", function() { return _enums__WEBPACK_IMPORTED_MODULE_12__["v"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "POPUP_RESULT", function() { return _enums__WEBPACK_IMPORTED_MODULE_12__["w"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "SETUP_COMPLETE", function() { return _enums__WEBPACK_IMPORTED_MODULE_12__["z"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ACTIVITY_ACTION_ALL", function() { return _enums__WEBPACK_IMPORTED_MODULE_12__["a"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ACTIVITY_ACTION_SEND", function() { return _enums__WEBPACK_IMPORTED_MODULE_12__["c"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ACTIVITY_ACTION_RECEIVE", function() { return _enums__WEBPACK_IMPORTED_MODULE_12__["b"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ACTIVITY_ACTION_TOPUP", function() { return _enums__WEBPACK_IMPORTED_MODULE_12__["d"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ACTIVITY_PERIOD_ALL", function() { return _enums__WEBPACK_IMPORTED_MODULE_12__["e"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ACTIVITY_PERIOD_WEEK_ONE", function() { return _enums__WEBPACK_IMPORTED_MODULE_12__["h"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ACTIVITY_PERIOD_MONTH_ONE", function() { return _enums__WEBPACK_IMPORTED_MODULE_12__["f"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ACTIVITY_PERIOD_MONTH_SIX", function() { return _enums__WEBPACK_IMPORTED_MODULE_12__["g"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ACTIVITY_STATUS_SUCCESSFUL", function() { return _enums__WEBPACK_IMPORTED_MODULE_12__["l"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ACTIVITY_STATUS_UNSUCCESSFUL", function() { return _enums__WEBPACK_IMPORTED_MODULE_12__["m"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ACTIVITY_STATUS_PENDING", function() { return _enums__WEBPACK_IMPORTED_MODULE_12__["k"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ACTIVITY_STATUS_CANCELLED", function() { return _enums__WEBPACK_IMPORTED_MODULE_12__["i"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ACTIVITY_STATUS_CANCELLING", function() { return _enums__WEBPACK_IMPORTED_MODULE_12__["j"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "COMMUNICATION_NOTIFICATIONS", function() { return _enums__WEBPACK_IMPORTED_MODULE_12__["q"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "COMMUNICATION_JRPC_METHODS", function() { return _enums__WEBPACK_IMPORTED_MODULE_12__["p"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "PROVIDER_JRPC_METHODS", function() { return _enums__WEBPACK_IMPORTED_MODULE_12__["x"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "PROVIDER_NOTIFICATIONS", function() { return _enums__WEBPACK_IMPORTED_MODULE_12__["y"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "BROADCAST_CHANNELS", function() { return _enums__WEBPACK_IMPORTED_MODULE_12__["n"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "BROADCAST_CHANNELS_MSGS", function() { return _enums__WEBPACK_IMPORTED_MODULE_12__["o"]; });

/* harmony import */ var _interfaces__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(25);
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "LOGIN_PROVIDER", function() { return _interfaces__WEBPACK_IMPORTED_MODULE_13__["a"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "PAYMENT_PROVIDER", function() { return _interfaces__WEBPACK_IMPORTED_MODULE_13__["b"]; });

/* harmony import */ var _Keyring_BaseKeyringController__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(38);
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "BaseKeyringController", function() { return _Keyring_BaseKeyringController__WEBPACK_IMPORTED_MODULE_14__["a"]; });

/* harmony import */ var _Keyring_IKeyringController__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(39);
/* harmony import */ var _Network_createFetchMiddleware__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(40);
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "createFetchConfigFromReq", function() { return _Network_createFetchMiddleware__WEBPACK_IMPORTED_MODULE_16__["a"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "createFetchMiddleware", function() { return _Network_createFetchMiddleware__WEBPACK_IMPORTED_MODULE_16__["b"]; });

/* harmony import */ var _Network_createLoggerMiddleware__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(41);
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "createLoggerMiddleware", function() { return _Network_createLoggerMiddleware__WEBPACK_IMPORTED_MODULE_17__["a"]; });

/* harmony import */ var _Network_createOriginMiddleware__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(42);
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "createOriginMiddleware", function() { return _Network_createOriginMiddleware__WEBPACK_IMPORTED_MODULE_18__["a"]; });

/* harmony import */ var _Network_INetworkController__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(23);
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "providerFromEngine", function() { return _Network_INetworkController__WEBPACK_IMPORTED_MODULE_19__["b"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "providerFromMiddleware", function() { return _Network_INetworkController__WEBPACK_IMPORTED_MODULE_19__["c"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "providerAsMiddleware", function() { return _Network_INetworkController__WEBPACK_IMPORTED_MODULE_19__["a"]; });

/* harmony import */ var _Popup_index__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(45);
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "BroadcastChannelHandler", function() { return _Popup_index__WEBPACK_IMPORTED_MODULE_20__["a"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "PopupHandler", function() { return _Popup_index__WEBPACK_IMPORTED_MODULE_20__["b"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "PopupStoreChannel", function() { return _Popup_index__WEBPACK_IMPORTED_MODULE_20__["c"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "PopupWithBcHandler", function() { return _Popup_index__WEBPACK_IMPORTED_MODULE_20__["d"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "RedirectHandler", function() { return _Popup_index__WEBPACK_IMPORTED_MODULE_20__["e"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "StreamWindow", function() { return _Popup_index__WEBPACK_IMPORTED_MODULE_20__["f"]; });

/* harmony import */ var _Preferences_BasePreferencesController__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(43);
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "DEFAULT_PREFERENCES", function() { return _Preferences_BasePreferencesController__WEBPACK_IMPORTED_MODULE_21__["b"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "BasePreferencesController", function() { return _Preferences_BasePreferencesController__WEBPACK_IMPORTED_MODULE_21__["a"]; });

/* harmony import */ var _Preferences_IPreferencesController__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(26);
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ACTIVITY_ACTION", function() { return _Preferences_IPreferencesController__WEBPACK_IMPORTED_MODULE_22__["b"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ACCOUNT_CATEGORY", function() { return _Preferences_IPreferencesController__WEBPACK_IMPORTED_MODULE_22__["a"]; });

/* harmony import */ var _Transaction_BaseTransactionStateController__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(44);
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "BaseTransactionStateManager", function() { return _Transaction_BaseTransactionStateController__WEBPACK_IMPORTED_MODULE_23__["a"]; });

/* harmony import */ var _Transaction_ITransactionController__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(12);
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "TransactionStatus", function() { return _Transaction_ITransactionController__WEBPACK_IMPORTED_MODULE_24__["c"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "TRANSACTION_TYPES", function() { return _Transaction_ITransactionController__WEBPACK_IMPORTED_MODULE_24__["a"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "TX_EVENTS", function() { return _Transaction_ITransactionController__WEBPACK_IMPORTED_MODULE_24__["b"]; });

/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(9);
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "getTxStatusText", function() { return _utils__WEBPACK_IMPORTED_MODULE_25__["j"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "intToHex", function() { return _utils__WEBPACK_IMPORTED_MODULE_25__["m"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "randomId", function() { return _utils__WEBPACK_IMPORTED_MODULE_25__["o"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "padWithZeroes", function() { return _utils__WEBPACK_IMPORTED_MODULE_25__["n"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "concatSig", function() { return _utils__WEBPACK_IMPORTED_MODULE_25__["d"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "timeout", function() { return _utils__WEBPACK_IMPORTED_MODULE_25__["r"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "formatSmallNumbers", function() { return _utils__WEBPACK_IMPORTED_MODULE_25__["f"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "addressSlicer", function() { return _utils__WEBPACK_IMPORTED_MODULE_25__["b"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "significantDigits", function() { return _utils__WEBPACK_IMPORTED_MODULE_25__["q"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "formatDate", function() { return _utils__WEBPACK_IMPORTED_MODULE_25__["e"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "formatTime", function() { return _utils__WEBPACK_IMPORTED_MODULE_25__["g"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "transactionMatchesNetwork", function() { return _utils__WEBPACK_IMPORTED_MODULE_25__["s"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "hashMessage", function() { return _utils__WEBPACK_IMPORTED_MODULE_25__["l"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "signMessage", function() { return _utils__WEBPACK_IMPORTED_MODULE_25__["p"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "getPopupFeatures", function() { return _utils__WEBPACK_IMPORTED_MODULE_25__["i"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "broadcastChannelOptions", function() { return _utils__WEBPACK_IMPORTED_MODULE_25__["c"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "getCustomDeviceInfo", function() { return _utils__WEBPACK_IMPORTED_MODULE_25__["h"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "UserError", function() { return _utils__WEBPACK_IMPORTED_MODULE_25__["a"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "handleRedirectParameters", function() { return _utils__WEBPACK_IMPORTED_MODULE_25__["k"]; });




























/***/ }),
/* 49 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function(global) {/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */
/* eslint-disable no-proto */



var base64 = __webpack_require__(51)
var ieee754 = __webpack_require__(52)
var isArray = __webpack_require__(53)

exports.Buffer = Buffer
exports.SlowBuffer = SlowBuffer
exports.INSPECT_MAX_BYTES = 50

/**
 * If `Buffer.TYPED_ARRAY_SUPPORT`:
 *   === true    Use Uint8Array implementation (fastest)
 *   === false   Use Object implementation (most compatible, even IE6)
 *
 * Browsers that support typed arrays are IE 10+, Firefox 4+, Chrome 7+, Safari 5.1+,
 * Opera 11.6+, iOS 4.2+.
 *
 * Due to various browser bugs, sometimes the Object implementation will be used even
 * when the browser supports typed arrays.
 *
 * Note:
 *
 *   - Firefox 4-29 lacks support for adding new properties to `Uint8Array` instances,
 *     See: https://bugzilla.mozilla.org/show_bug.cgi?id=695438.
 *
 *   - Chrome 9-10 is missing the `TypedArray.prototype.subarray` function.
 *
 *   - IE10 has a broken `TypedArray.prototype.subarray` function which returns arrays of
 *     incorrect length in some situations.

 * We detect these buggy browsers and set `Buffer.TYPED_ARRAY_SUPPORT` to `false` so they
 * get the Object implementation, which is slower but behaves correctly.
 */
Buffer.TYPED_ARRAY_SUPPORT = global.TYPED_ARRAY_SUPPORT !== undefined
  ? global.TYPED_ARRAY_SUPPORT
  : typedArraySupport()

/*
 * Export kMaxLength after typed array support is determined.
 */
exports.kMaxLength = kMaxLength()

function typedArraySupport () {
  try {
    var arr = new Uint8Array(1)
    arr.__proto__ = {__proto__: Uint8Array.prototype, foo: function () { return 42 }}
    return arr.foo() === 42 && // typed array instances can be augmented
        typeof arr.subarray === 'function' && // chrome 9-10 lack `subarray`
        arr.subarray(1, 1).byteLength === 0 // ie10 has broken `subarray`
  } catch (e) {
    return false
  }
}

function kMaxLength () {
  return Buffer.TYPED_ARRAY_SUPPORT
    ? 0x7fffffff
    : 0x3fffffff
}

function createBuffer (that, length) {
  if (kMaxLength() < length) {
    throw new RangeError('Invalid typed array length')
  }
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    // Return an augmented `Uint8Array` instance, for best performance
    that = new Uint8Array(length)
    that.__proto__ = Buffer.prototype
  } else {
    // Fallback: Return an object instance of the Buffer class
    if (that === null) {
      that = new Buffer(length)
    }
    that.length = length
  }

  return that
}

/**
 * The Buffer constructor returns instances of `Uint8Array` that have their
 * prototype changed to `Buffer.prototype`. Furthermore, `Buffer` is a subclass of
 * `Uint8Array`, so the returned instances will have all the node `Buffer` methods
 * and the `Uint8Array` methods. Square bracket notation works as expected -- it
 * returns a single octet.
 *
 * The `Uint8Array` prototype remains unmodified.
 */

function Buffer (arg, encodingOrOffset, length) {
  if (!Buffer.TYPED_ARRAY_SUPPORT && !(this instanceof Buffer)) {
    return new Buffer(arg, encodingOrOffset, length)
  }

  // Common case.
  if (typeof arg === 'number') {
    if (typeof encodingOrOffset === 'string') {
      throw new Error(
        'If encoding is specified then the first argument must be a string'
      )
    }
    return allocUnsafe(this, arg)
  }
  return from(this, arg, encodingOrOffset, length)
}

Buffer.poolSize = 8192 // not used by this implementation

// TODO: Legacy, not needed anymore. Remove in next major version.
Buffer._augment = function (arr) {
  arr.__proto__ = Buffer.prototype
  return arr
}

function from (that, value, encodingOrOffset, length) {
  if (typeof value === 'number') {
    throw new TypeError('"value" argument must not be a number')
  }

  if (typeof ArrayBuffer !== 'undefined' && value instanceof ArrayBuffer) {
    return fromArrayBuffer(that, value, encodingOrOffset, length)
  }

  if (typeof value === 'string') {
    return fromString(that, value, encodingOrOffset)
  }

  return fromObject(that, value)
}

/**
 * Functionally equivalent to Buffer(arg, encoding) but throws a TypeError
 * if value is a number.
 * Buffer.from(str[, encoding])
 * Buffer.from(array)
 * Buffer.from(buffer)
 * Buffer.from(arrayBuffer[, byteOffset[, length]])
 **/
Buffer.from = function (value, encodingOrOffset, length) {
  return from(null, value, encodingOrOffset, length)
}

if (Buffer.TYPED_ARRAY_SUPPORT) {
  Buffer.prototype.__proto__ = Uint8Array.prototype
  Buffer.__proto__ = Uint8Array
  if (typeof Symbol !== 'undefined' && Symbol.species &&
      Buffer[Symbol.species] === Buffer) {
    // Fix subarray() in ES2016. See: https://github.com/feross/buffer/pull/97
    Object.defineProperty(Buffer, Symbol.species, {
      value: null,
      configurable: true
    })
  }
}

function assertSize (size) {
  if (typeof size !== 'number') {
    throw new TypeError('"size" argument must be a number')
  } else if (size < 0) {
    throw new RangeError('"size" argument must not be negative')
  }
}

function alloc (that, size, fill, encoding) {
  assertSize(size)
  if (size <= 0) {
    return createBuffer(that, size)
  }
  if (fill !== undefined) {
    // Only pay attention to encoding if it's a string. This
    // prevents accidentally sending in a number that would
    // be interpretted as a start offset.
    return typeof encoding === 'string'
      ? createBuffer(that, size).fill(fill, encoding)
      : createBuffer(that, size).fill(fill)
  }
  return createBuffer(that, size)
}

/**
 * Creates a new filled Buffer instance.
 * alloc(size[, fill[, encoding]])
 **/
Buffer.alloc = function (size, fill, encoding) {
  return alloc(null, size, fill, encoding)
}

function allocUnsafe (that, size) {
  assertSize(size)
  that = createBuffer(that, size < 0 ? 0 : checked(size) | 0)
  if (!Buffer.TYPED_ARRAY_SUPPORT) {
    for (var i = 0; i < size; ++i) {
      that[i] = 0
    }
  }
  return that
}

/**
 * Equivalent to Buffer(num), by default creates a non-zero-filled Buffer instance.
 * */
Buffer.allocUnsafe = function (size) {
  return allocUnsafe(null, size)
}
/**
 * Equivalent to SlowBuffer(num), by default creates a non-zero-filled Buffer instance.
 */
Buffer.allocUnsafeSlow = function (size) {
  return allocUnsafe(null, size)
}

function fromString (that, string, encoding) {
  if (typeof encoding !== 'string' || encoding === '') {
    encoding = 'utf8'
  }

  if (!Buffer.isEncoding(encoding)) {
    throw new TypeError('"encoding" must be a valid string encoding')
  }

  var length = byteLength(string, encoding) | 0
  that = createBuffer(that, length)

  var actual = that.write(string, encoding)

  if (actual !== length) {
    // Writing a hex string, for example, that contains invalid characters will
    // cause everything after the first invalid character to be ignored. (e.g.
    // 'abxxcd' will be treated as 'ab')
    that = that.slice(0, actual)
  }

  return that
}

function fromArrayLike (that, array) {
  var length = array.length < 0 ? 0 : checked(array.length) | 0
  that = createBuffer(that, length)
  for (var i = 0; i < length; i += 1) {
    that[i] = array[i] & 255
  }
  return that
}

function fromArrayBuffer (that, array, byteOffset, length) {
  array.byteLength // this throws if `array` is not a valid ArrayBuffer

  if (byteOffset < 0 || array.byteLength < byteOffset) {
    throw new RangeError('\'offset\' is out of bounds')
  }

  if (array.byteLength < byteOffset + (length || 0)) {
    throw new RangeError('\'length\' is out of bounds')
  }

  if (byteOffset === undefined && length === undefined) {
    array = new Uint8Array(array)
  } else if (length === undefined) {
    array = new Uint8Array(array, byteOffset)
  } else {
    array = new Uint8Array(array, byteOffset, length)
  }

  if (Buffer.TYPED_ARRAY_SUPPORT) {
    // Return an augmented `Uint8Array` instance, for best performance
    that = array
    that.__proto__ = Buffer.prototype
  } else {
    // Fallback: Return an object instance of the Buffer class
    that = fromArrayLike(that, array)
  }
  return that
}

function fromObject (that, obj) {
  if (Buffer.isBuffer(obj)) {
    var len = checked(obj.length) | 0
    that = createBuffer(that, len)

    if (that.length === 0) {
      return that
    }

    obj.copy(that, 0, 0, len)
    return that
  }

  if (obj) {
    if ((typeof ArrayBuffer !== 'undefined' &&
        obj.buffer instanceof ArrayBuffer) || 'length' in obj) {
      if (typeof obj.length !== 'number' || isnan(obj.length)) {
        return createBuffer(that, 0)
      }
      return fromArrayLike(that, obj)
    }

    if (obj.type === 'Buffer' && isArray(obj.data)) {
      return fromArrayLike(that, obj.data)
    }
  }

  throw new TypeError('First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.')
}

function checked (length) {
  // Note: cannot use `length < kMaxLength()` here because that fails when
  // length is NaN (which is otherwise coerced to zero.)
  if (length >= kMaxLength()) {
    throw new RangeError('Attempt to allocate Buffer larger than maximum ' +
                         'size: 0x' + kMaxLength().toString(16) + ' bytes')
  }
  return length | 0
}

function SlowBuffer (length) {
  if (+length != length) { // eslint-disable-line eqeqeq
    length = 0
  }
  return Buffer.alloc(+length)
}

Buffer.isBuffer = function isBuffer (b) {
  return !!(b != null && b._isBuffer)
}

Buffer.compare = function compare (a, b) {
  if (!Buffer.isBuffer(a) || !Buffer.isBuffer(b)) {
    throw new TypeError('Arguments must be Buffers')
  }

  if (a === b) return 0

  var x = a.length
  var y = b.length

  for (var i = 0, len = Math.min(x, y); i < len; ++i) {
    if (a[i] !== b[i]) {
      x = a[i]
      y = b[i]
      break
    }
  }

  if (x < y) return -1
  if (y < x) return 1
  return 0
}

Buffer.isEncoding = function isEncoding (encoding) {
  switch (String(encoding).toLowerCase()) {
    case 'hex':
    case 'utf8':
    case 'utf-8':
    case 'ascii':
    case 'latin1':
    case 'binary':
    case 'base64':
    case 'ucs2':
    case 'ucs-2':
    case 'utf16le':
    case 'utf-16le':
      return true
    default:
      return false
  }
}

Buffer.concat = function concat (list, length) {
  if (!isArray(list)) {
    throw new TypeError('"list" argument must be an Array of Buffers')
  }

  if (list.length === 0) {
    return Buffer.alloc(0)
  }

  var i
  if (length === undefined) {
    length = 0
    for (i = 0; i < list.length; ++i) {
      length += list[i].length
    }
  }

  var buffer = Buffer.allocUnsafe(length)
  var pos = 0
  for (i = 0; i < list.length; ++i) {
    var buf = list[i]
    if (!Buffer.isBuffer(buf)) {
      throw new TypeError('"list" argument must be an Array of Buffers')
    }
    buf.copy(buffer, pos)
    pos += buf.length
  }
  return buffer
}

function byteLength (string, encoding) {
  if (Buffer.isBuffer(string)) {
    return string.length
  }
  if (typeof ArrayBuffer !== 'undefined' && typeof ArrayBuffer.isView === 'function' &&
      (ArrayBuffer.isView(string) || string instanceof ArrayBuffer)) {
    return string.byteLength
  }
  if (typeof string !== 'string') {
    string = '' + string
  }

  var len = string.length
  if (len === 0) return 0

  // Use a for loop to avoid recursion
  var loweredCase = false
  for (;;) {
    switch (encoding) {
      case 'ascii':
      case 'latin1':
      case 'binary':
        return len
      case 'utf8':
      case 'utf-8':
      case undefined:
        return utf8ToBytes(string).length
      case 'ucs2':
      case 'ucs-2':
      case 'utf16le':
      case 'utf-16le':
        return len * 2
      case 'hex':
        return len >>> 1
      case 'base64':
        return base64ToBytes(string).length
      default:
        if (loweredCase) return utf8ToBytes(string).length // assume utf8
        encoding = ('' + encoding).toLowerCase()
        loweredCase = true
    }
  }
}
Buffer.byteLength = byteLength

function slowToString (encoding, start, end) {
  var loweredCase = false

  // No need to verify that "this.length <= MAX_UINT32" since it's a read-only
  // property of a typed array.

  // This behaves neither like String nor Uint8Array in that we set start/end
  // to their upper/lower bounds if the value passed is out of range.
  // undefined is handled specially as per ECMA-262 6th Edition,
  // Section 13.3.3.7 Runtime Semantics: KeyedBindingInitialization.
  if (start === undefined || start < 0) {
    start = 0
  }
  // Return early if start > this.length. Done here to prevent potential uint32
  // coercion fail below.
  if (start > this.length) {
    return ''
  }

  if (end === undefined || end > this.length) {
    end = this.length
  }

  if (end <= 0) {
    return ''
  }

  // Force coersion to uint32. This will also coerce falsey/NaN values to 0.
  end >>>= 0
  start >>>= 0

  if (end <= start) {
    return ''
  }

  if (!encoding) encoding = 'utf8'

  while (true) {
    switch (encoding) {
      case 'hex':
        return hexSlice(this, start, end)

      case 'utf8':
      case 'utf-8':
        return utf8Slice(this, start, end)

      case 'ascii':
        return asciiSlice(this, start, end)

      case 'latin1':
      case 'binary':
        return latin1Slice(this, start, end)

      case 'base64':
        return base64Slice(this, start, end)

      case 'ucs2':
      case 'ucs-2':
      case 'utf16le':
      case 'utf-16le':
        return utf16leSlice(this, start, end)

      default:
        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)
        encoding = (encoding + '').toLowerCase()
        loweredCase = true
    }
  }
}

// The property is used by `Buffer.isBuffer` and `is-buffer` (in Safari 5-7) to detect
// Buffer instances.
Buffer.prototype._isBuffer = true

function swap (b, n, m) {
  var i = b[n]
  b[n] = b[m]
  b[m] = i
}

Buffer.prototype.swap16 = function swap16 () {
  var len = this.length
  if (len % 2 !== 0) {
    throw new RangeError('Buffer size must be a multiple of 16-bits')
  }
  for (var i = 0; i < len; i += 2) {
    swap(this, i, i + 1)
  }
  return this
}

Buffer.prototype.swap32 = function swap32 () {
  var len = this.length
  if (len % 4 !== 0) {
    throw new RangeError('Buffer size must be a multiple of 32-bits')
  }
  for (var i = 0; i < len; i += 4) {
    swap(this, i, i + 3)
    swap(this, i + 1, i + 2)
  }
  return this
}

Buffer.prototype.swap64 = function swap64 () {
  var len = this.length
  if (len % 8 !== 0) {
    throw new RangeError('Buffer size must be a multiple of 64-bits')
  }
  for (var i = 0; i < len; i += 8) {
    swap(this, i, i + 7)
    swap(this, i + 1, i + 6)
    swap(this, i + 2, i + 5)
    swap(this, i + 3, i + 4)
  }
  return this
}

Buffer.prototype.toString = function toString () {
  var length = this.length | 0
  if (length === 0) return ''
  if (arguments.length === 0) return utf8Slice(this, 0, length)
  return slowToString.apply(this, arguments)
}

Buffer.prototype.equals = function equals (b) {
  if (!Buffer.isBuffer(b)) throw new TypeError('Argument must be a Buffer')
  if (this === b) return true
  return Buffer.compare(this, b) === 0
}

Buffer.prototype.inspect = function inspect () {
  var str = ''
  var max = exports.INSPECT_MAX_BYTES
  if (this.length > 0) {
    str = this.toString('hex', 0, max).match(/.{2}/g).join(' ')
    if (this.length > max) str += ' ... '
  }
  return '<Buffer ' + str + '>'
}

Buffer.prototype.compare = function compare (target, start, end, thisStart, thisEnd) {
  if (!Buffer.isBuffer(target)) {
    throw new TypeError('Argument must be a Buffer')
  }

  if (start === undefined) {
    start = 0
  }
  if (end === undefined) {
    end = target ? target.length : 0
  }
  if (thisStart === undefined) {
    thisStart = 0
  }
  if (thisEnd === undefined) {
    thisEnd = this.length
  }

  if (start < 0 || end > target.length || thisStart < 0 || thisEnd > this.length) {
    throw new RangeError('out of range index')
  }

  if (thisStart >= thisEnd && start >= end) {
    return 0
  }
  if (thisStart >= thisEnd) {
    return -1
  }
  if (start >= end) {
    return 1
  }

  start >>>= 0
  end >>>= 0
  thisStart >>>= 0
  thisEnd >>>= 0

  if (this === target) return 0

  var x = thisEnd - thisStart
  var y = end - start
  var len = Math.min(x, y)

  var thisCopy = this.slice(thisStart, thisEnd)
  var targetCopy = target.slice(start, end)

  for (var i = 0; i < len; ++i) {
    if (thisCopy[i] !== targetCopy[i]) {
      x = thisCopy[i]
      y = targetCopy[i]
      break
    }
  }

  if (x < y) return -1
  if (y < x) return 1
  return 0
}

// Finds either the first index of `val` in `buffer` at offset >= `byteOffset`,
// OR the last index of `val` in `buffer` at offset <= `byteOffset`.
//
// Arguments:
// - buffer - a Buffer to search
// - val - a string, Buffer, or number
// - byteOffset - an index into `buffer`; will be clamped to an int32
// - encoding - an optional encoding, relevant is val is a string
// - dir - true for indexOf, false for lastIndexOf
function bidirectionalIndexOf (buffer, val, byteOffset, encoding, dir) {
  // Empty buffer means no match
  if (buffer.length === 0) return -1

  // Normalize byteOffset
  if (typeof byteOffset === 'string') {
    encoding = byteOffset
    byteOffset = 0
  } else if (byteOffset > 0x7fffffff) {
    byteOffset = 0x7fffffff
  } else if (byteOffset < -0x80000000) {
    byteOffset = -0x80000000
  }
  byteOffset = +byteOffset  // Coerce to Number.
  if (isNaN(byteOffset)) {
    // byteOffset: it it's undefined, null, NaN, "foo", etc, search whole buffer
    byteOffset = dir ? 0 : (buffer.length - 1)
  }

  // Normalize byteOffset: negative offsets start from the end of the buffer
  if (byteOffset < 0) byteOffset = buffer.length + byteOffset
  if (byteOffset >= buffer.length) {
    if (dir) return -1
    else byteOffset = buffer.length - 1
  } else if (byteOffset < 0) {
    if (dir) byteOffset = 0
    else return -1
  }

  // Normalize val
  if (typeof val === 'string') {
    val = Buffer.from(val, encoding)
  }

  // Finally, search either indexOf (if dir is true) or lastIndexOf
  if (Buffer.isBuffer(val)) {
    // Special case: looking for empty string/buffer always fails
    if (val.length === 0) {
      return -1
    }
    return arrayIndexOf(buffer, val, byteOffset, encoding, dir)
  } else if (typeof val === 'number') {
    val = val & 0xFF // Search for a byte value [0-255]
    if (Buffer.TYPED_ARRAY_SUPPORT &&
        typeof Uint8Array.prototype.indexOf === 'function') {
      if (dir) {
        return Uint8Array.prototype.indexOf.call(buffer, val, byteOffset)
      } else {
        return Uint8Array.prototype.lastIndexOf.call(buffer, val, byteOffset)
      }
    }
    return arrayIndexOf(buffer, [ val ], byteOffset, encoding, dir)
  }

  throw new TypeError('val must be string, number or Buffer')
}

function arrayIndexOf (arr, val, byteOffset, encoding, dir) {
  var indexSize = 1
  var arrLength = arr.length
  var valLength = val.length

  if (encoding !== undefined) {
    encoding = String(encoding).toLowerCase()
    if (encoding === 'ucs2' || encoding === 'ucs-2' ||
        encoding === 'utf16le' || encoding === 'utf-16le') {
      if (arr.length < 2 || val.length < 2) {
        return -1
      }
      indexSize = 2
      arrLength /= 2
      valLength /= 2
      byteOffset /= 2
    }
  }

  function read (buf, i) {
    if (indexSize === 1) {
      return buf[i]
    } else {
      return buf.readUInt16BE(i * indexSize)
    }
  }

  var i
  if (dir) {
    var foundIndex = -1
    for (i = byteOffset; i < arrLength; i++) {
      if (read(arr, i) === read(val, foundIndex === -1 ? 0 : i - foundIndex)) {
        if (foundIndex === -1) foundIndex = i
        if (i - foundIndex + 1 === valLength) return foundIndex * indexSize
      } else {
        if (foundIndex !== -1) i -= i - foundIndex
        foundIndex = -1
      }
    }
  } else {
    if (byteOffset + valLength > arrLength) byteOffset = arrLength - valLength
    for (i = byteOffset; i >= 0; i--) {
      var found = true
      for (var j = 0; j < valLength; j++) {
        if (read(arr, i + j) !== read(val, j)) {
          found = false
          break
        }
      }
      if (found) return i
    }
  }

  return -1
}

Buffer.prototype.includes = function includes (val, byteOffset, encoding) {
  return this.indexOf(val, byteOffset, encoding) !== -1
}

Buffer.prototype.indexOf = function indexOf (val, byteOffset, encoding) {
  return bidirectionalIndexOf(this, val, byteOffset, encoding, true)
}

Buffer.prototype.lastIndexOf = function lastIndexOf (val, byteOffset, encoding) {
  return bidirectionalIndexOf(this, val, byteOffset, encoding, false)
}

function hexWrite (buf, string, offset, length) {
  offset = Number(offset) || 0
  var remaining = buf.length - offset
  if (!length) {
    length = remaining
  } else {
    length = Number(length)
    if (length > remaining) {
      length = remaining
    }
  }

  // must be an even number of digits
  var strLen = string.length
  if (strLen % 2 !== 0) throw new TypeError('Invalid hex string')

  if (length > strLen / 2) {
    length = strLen / 2
  }
  for (var i = 0; i < length; ++i) {
    var parsed = parseInt(string.substr(i * 2, 2), 16)
    if (isNaN(parsed)) return i
    buf[offset + i] = parsed
  }
  return i
}

function utf8Write (buf, string, offset, length) {
  return blitBuffer(utf8ToBytes(string, buf.length - offset), buf, offset, length)
}

function asciiWrite (buf, string, offset, length) {
  return blitBuffer(asciiToBytes(string), buf, offset, length)
}

function latin1Write (buf, string, offset, length) {
  return asciiWrite(buf, string, offset, length)
}

function base64Write (buf, string, offset, length) {
  return blitBuffer(base64ToBytes(string), buf, offset, length)
}

function ucs2Write (buf, string, offset, length) {
  return blitBuffer(utf16leToBytes(string, buf.length - offset), buf, offset, length)
}

Buffer.prototype.write = function write (string, offset, length, encoding) {
  // Buffer#write(string)
  if (offset === undefined) {
    encoding = 'utf8'
    length = this.length
    offset = 0
  // Buffer#write(string, encoding)
  } else if (length === undefined && typeof offset === 'string') {
    encoding = offset
    length = this.length
    offset = 0
  // Buffer#write(string, offset[, length][, encoding])
  } else if (isFinite(offset)) {
    offset = offset | 0
    if (isFinite(length)) {
      length = length | 0
      if (encoding === undefined) encoding = 'utf8'
    } else {
      encoding = length
      length = undefined
    }
  // legacy write(string, encoding, offset, length) - remove in v0.13
  } else {
    throw new Error(
      'Buffer.write(string, encoding, offset[, length]) is no longer supported'
    )
  }

  var remaining = this.length - offset
  if (length === undefined || length > remaining) length = remaining

  if ((string.length > 0 && (length < 0 || offset < 0)) || offset > this.length) {
    throw new RangeError('Attempt to write outside buffer bounds')
  }

  if (!encoding) encoding = 'utf8'

  var loweredCase = false
  for (;;) {
    switch (encoding) {
      case 'hex':
        return hexWrite(this, string, offset, length)

      case 'utf8':
      case 'utf-8':
        return utf8Write(this, string, offset, length)

      case 'ascii':
        return asciiWrite(this, string, offset, length)

      case 'latin1':
      case 'binary':
        return latin1Write(this, string, offset, length)

      case 'base64':
        // Warning: maxLength not taken into account in base64Write
        return base64Write(this, string, offset, length)

      case 'ucs2':
      case 'ucs-2':
      case 'utf16le':
      case 'utf-16le':
        return ucs2Write(this, string, offset, length)

      default:
        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)
        encoding = ('' + encoding).toLowerCase()
        loweredCase = true
    }
  }
}

Buffer.prototype.toJSON = function toJSON () {
  return {
    type: 'Buffer',
    data: Array.prototype.slice.call(this._arr || this, 0)
  }
}

function base64Slice (buf, start, end) {
  if (start === 0 && end === buf.length) {
    return base64.fromByteArray(buf)
  } else {
    return base64.fromByteArray(buf.slice(start, end))
  }
}

function utf8Slice (buf, start, end) {
  end = Math.min(buf.length, end)
  var res = []

  var i = start
  while (i < end) {
    var firstByte = buf[i]
    var codePoint = null
    var bytesPerSequence = (firstByte > 0xEF) ? 4
      : (firstByte > 0xDF) ? 3
      : (firstByte > 0xBF) ? 2
      : 1

    if (i + bytesPerSequence <= end) {
      var secondByte, thirdByte, fourthByte, tempCodePoint

      switch (bytesPerSequence) {
        case 1:
          if (firstByte < 0x80) {
            codePoint = firstByte
          }
          break
        case 2:
          secondByte = buf[i + 1]
          if ((secondByte & 0xC0) === 0x80) {
            tempCodePoint = (firstByte & 0x1F) << 0x6 | (secondByte & 0x3F)
            if (tempCodePoint > 0x7F) {
              codePoint = tempCodePoint
            }
          }
          break
        case 3:
          secondByte = buf[i + 1]
          thirdByte = buf[i + 2]
          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80) {
            tempCodePoint = (firstByte & 0xF) << 0xC | (secondByte & 0x3F) << 0x6 | (thirdByte & 0x3F)
            if (tempCodePoint > 0x7FF && (tempCodePoint < 0xD800 || tempCodePoint > 0xDFFF)) {
              codePoint = tempCodePoint
            }
          }
          break
        case 4:
          secondByte = buf[i + 1]
          thirdByte = buf[i + 2]
          fourthByte = buf[i + 3]
          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80 && (fourthByte & 0xC0) === 0x80) {
            tempCodePoint = (firstByte & 0xF) << 0x12 | (secondByte & 0x3F) << 0xC | (thirdByte & 0x3F) << 0x6 | (fourthByte & 0x3F)
            if (tempCodePoint > 0xFFFF && tempCodePoint < 0x110000) {
              codePoint = tempCodePoint
            }
          }
      }
    }

    if (codePoint === null) {
      // we did not generate a valid codePoint so insert a
      // replacement char (U+FFFD) and advance only 1 byte
      codePoint = 0xFFFD
      bytesPerSequence = 1
    } else if (codePoint > 0xFFFF) {
      // encode to utf16 (surrogate pair dance)
      codePoint -= 0x10000
      res.push(codePoint >>> 10 & 0x3FF | 0xD800)
      codePoint = 0xDC00 | codePoint & 0x3FF
    }

    res.push(codePoint)
    i += bytesPerSequence
  }

  return decodeCodePointsArray(res)
}

// Based on http://stackoverflow.com/a/22747272/680742, the browser with
// the lowest limit is Chrome, with 0x10000 args.
// We go 1 magnitude less, for safety
var MAX_ARGUMENTS_LENGTH = 0x1000

function decodeCodePointsArray (codePoints) {
  var len = codePoints.length
  if (len <= MAX_ARGUMENTS_LENGTH) {
    return String.fromCharCode.apply(String, codePoints) // avoid extra slice()
  }

  // Decode in chunks to avoid "call stack size exceeded".
  var res = ''
  var i = 0
  while (i < len) {
    res += String.fromCharCode.apply(
      String,
      codePoints.slice(i, i += MAX_ARGUMENTS_LENGTH)
    )
  }
  return res
}

function asciiSlice (buf, start, end) {
  var ret = ''
  end = Math.min(buf.length, end)

  for (var i = start; i < end; ++i) {
    ret += String.fromCharCode(buf[i] & 0x7F)
  }
  return ret
}

function latin1Slice (buf, start, end) {
  var ret = ''
  end = Math.min(buf.length, end)

  for (var i = start; i < end; ++i) {
    ret += String.fromCharCode(buf[i])
  }
  return ret
}

function hexSlice (buf, start, end) {
  var len = buf.length

  if (!start || start < 0) start = 0
  if (!end || end < 0 || end > len) end = len

  var out = ''
  for (var i = start; i < end; ++i) {
    out += toHex(buf[i])
  }
  return out
}

function utf16leSlice (buf, start, end) {
  var bytes = buf.slice(start, end)
  var res = ''
  for (var i = 0; i < bytes.length; i += 2) {
    res += String.fromCharCode(bytes[i] + bytes[i + 1] * 256)
  }
  return res
}

Buffer.prototype.slice = function slice (start, end) {
  var len = this.length
  start = ~~start
  end = end === undefined ? len : ~~end

  if (start < 0) {
    start += len
    if (start < 0) start = 0
  } else if (start > len) {
    start = len
  }

  if (end < 0) {
    end += len
    if (end < 0) end = 0
  } else if (end > len) {
    end = len
  }

  if (end < start) end = start

  var newBuf
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    newBuf = this.subarray(start, end)
    newBuf.__proto__ = Buffer.prototype
  } else {
    var sliceLen = end - start
    newBuf = new Buffer(sliceLen, undefined)
    for (var i = 0; i < sliceLen; ++i) {
      newBuf[i] = this[i + start]
    }
  }

  return newBuf
}

/*
 * Need to make sure that buffer isn't trying to write out of bounds.
 */
function checkOffset (offset, ext, length) {
  if ((offset % 1) !== 0 || offset < 0) throw new RangeError('offset is not uint')
  if (offset + ext > length) throw new RangeError('Trying to access beyond buffer length')
}

Buffer.prototype.readUIntLE = function readUIntLE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) checkOffset(offset, byteLength, this.length)

  var val = this[offset]
  var mul = 1
  var i = 0
  while (++i < byteLength && (mul *= 0x100)) {
    val += this[offset + i] * mul
  }

  return val
}

Buffer.prototype.readUIntBE = function readUIntBE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) {
    checkOffset(offset, byteLength, this.length)
  }

  var val = this[offset + --byteLength]
  var mul = 1
  while (byteLength > 0 && (mul *= 0x100)) {
    val += this[offset + --byteLength] * mul
  }

  return val
}

Buffer.prototype.readUInt8 = function readUInt8 (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 1, this.length)
  return this[offset]
}

Buffer.prototype.readUInt16LE = function readUInt16LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  return this[offset] | (this[offset + 1] << 8)
}

Buffer.prototype.readUInt16BE = function readUInt16BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  return (this[offset] << 8) | this[offset + 1]
}

Buffer.prototype.readUInt32LE = function readUInt32LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return ((this[offset]) |
      (this[offset + 1] << 8) |
      (this[offset + 2] << 16)) +
      (this[offset + 3] * 0x1000000)
}

Buffer.prototype.readUInt32BE = function readUInt32BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return (this[offset] * 0x1000000) +
    ((this[offset + 1] << 16) |
    (this[offset + 2] << 8) |
    this[offset + 3])
}

Buffer.prototype.readIntLE = function readIntLE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) checkOffset(offset, byteLength, this.length)

  var val = this[offset]
  var mul = 1
  var i = 0
  while (++i < byteLength && (mul *= 0x100)) {
    val += this[offset + i] * mul
  }
  mul *= 0x80

  if (val >= mul) val -= Math.pow(2, 8 * byteLength)

  return val
}

Buffer.prototype.readIntBE = function readIntBE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) checkOffset(offset, byteLength, this.length)

  var i = byteLength
  var mul = 1
  var val = this[offset + --i]
  while (i > 0 && (mul *= 0x100)) {
    val += this[offset + --i] * mul
  }
  mul *= 0x80

  if (val >= mul) val -= Math.pow(2, 8 * byteLength)

  return val
}

Buffer.prototype.readInt8 = function readInt8 (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 1, this.length)
  if (!(this[offset] & 0x80)) return (this[offset])
  return ((0xff - this[offset] + 1) * -1)
}

Buffer.prototype.readInt16LE = function readInt16LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  var val = this[offset] | (this[offset + 1] << 8)
  return (val & 0x8000) ? val | 0xFFFF0000 : val
}

Buffer.prototype.readInt16BE = function readInt16BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  var val = this[offset + 1] | (this[offset] << 8)
  return (val & 0x8000) ? val | 0xFFFF0000 : val
}

Buffer.prototype.readInt32LE = function readInt32LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return (this[offset]) |
    (this[offset + 1] << 8) |
    (this[offset + 2] << 16) |
    (this[offset + 3] << 24)
}

Buffer.prototype.readInt32BE = function readInt32BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return (this[offset] << 24) |
    (this[offset + 1] << 16) |
    (this[offset + 2] << 8) |
    (this[offset + 3])
}

Buffer.prototype.readFloatLE = function readFloatLE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)
  return ieee754.read(this, offset, true, 23, 4)
}

Buffer.prototype.readFloatBE = function readFloatBE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)
  return ieee754.read(this, offset, false, 23, 4)
}

Buffer.prototype.readDoubleLE = function readDoubleLE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 8, this.length)
  return ieee754.read(this, offset, true, 52, 8)
}

Buffer.prototype.readDoubleBE = function readDoubleBE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 8, this.length)
  return ieee754.read(this, offset, false, 52, 8)
}

function checkInt (buf, value, offset, ext, max, min) {
  if (!Buffer.isBuffer(buf)) throw new TypeError('"buffer" argument must be a Buffer instance')
  if (value > max || value < min) throw new RangeError('"value" argument is out of bounds')
  if (offset + ext > buf.length) throw new RangeError('Index out of range')
}

Buffer.prototype.writeUIntLE = function writeUIntLE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) {
    var maxBytes = Math.pow(2, 8 * byteLength) - 1
    checkInt(this, value, offset, byteLength, maxBytes, 0)
  }

  var mul = 1
  var i = 0
  this[offset] = value & 0xFF
  while (++i < byteLength && (mul *= 0x100)) {
    this[offset + i] = (value / mul) & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeUIntBE = function writeUIntBE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) {
    var maxBytes = Math.pow(2, 8 * byteLength) - 1
    checkInt(this, value, offset, byteLength, maxBytes, 0)
  }

  var i = byteLength - 1
  var mul = 1
  this[offset + i] = value & 0xFF
  while (--i >= 0 && (mul *= 0x100)) {
    this[offset + i] = (value / mul) & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeUInt8 = function writeUInt8 (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 1, 0xff, 0)
  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)
  this[offset] = (value & 0xff)
  return offset + 1
}

function objectWriteUInt16 (buf, value, offset, littleEndian) {
  if (value < 0) value = 0xffff + value + 1
  for (var i = 0, j = Math.min(buf.length - offset, 2); i < j; ++i) {
    buf[offset + i] = (value & (0xff << (8 * (littleEndian ? i : 1 - i)))) >>>
      (littleEndian ? i : 1 - i) * 8
  }
}

Buffer.prototype.writeUInt16LE = function writeUInt16LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value & 0xff)
    this[offset + 1] = (value >>> 8)
  } else {
    objectWriteUInt16(this, value, offset, true)
  }
  return offset + 2
}

Buffer.prototype.writeUInt16BE = function writeUInt16BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 8)
    this[offset + 1] = (value & 0xff)
  } else {
    objectWriteUInt16(this, value, offset, false)
  }
  return offset + 2
}

function objectWriteUInt32 (buf, value, offset, littleEndian) {
  if (value < 0) value = 0xffffffff + value + 1
  for (var i = 0, j = Math.min(buf.length - offset, 4); i < j; ++i) {
    buf[offset + i] = (value >>> (littleEndian ? i : 3 - i) * 8) & 0xff
  }
}

Buffer.prototype.writeUInt32LE = function writeUInt32LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset + 3] = (value >>> 24)
    this[offset + 2] = (value >>> 16)
    this[offset + 1] = (value >>> 8)
    this[offset] = (value & 0xff)
  } else {
    objectWriteUInt32(this, value, offset, true)
  }
  return offset + 4
}

Buffer.prototype.writeUInt32BE = function writeUInt32BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 24)
    this[offset + 1] = (value >>> 16)
    this[offset + 2] = (value >>> 8)
    this[offset + 3] = (value & 0xff)
  } else {
    objectWriteUInt32(this, value, offset, false)
  }
  return offset + 4
}

Buffer.prototype.writeIntLE = function writeIntLE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) {
    var limit = Math.pow(2, 8 * byteLength - 1)

    checkInt(this, value, offset, byteLength, limit - 1, -limit)
  }

  var i = 0
  var mul = 1
  var sub = 0
  this[offset] = value & 0xFF
  while (++i < byteLength && (mul *= 0x100)) {
    if (value < 0 && sub === 0 && this[offset + i - 1] !== 0) {
      sub = 1
    }
    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeIntBE = function writeIntBE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) {
    var limit = Math.pow(2, 8 * byteLength - 1)

    checkInt(this, value, offset, byteLength, limit - 1, -limit)
  }

  var i = byteLength - 1
  var mul = 1
  var sub = 0
  this[offset + i] = value & 0xFF
  while (--i >= 0 && (mul *= 0x100)) {
    if (value < 0 && sub === 0 && this[offset + i + 1] !== 0) {
      sub = 1
    }
    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeInt8 = function writeInt8 (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 1, 0x7f, -0x80)
  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)
  if (value < 0) value = 0xff + value + 1
  this[offset] = (value & 0xff)
  return offset + 1
}

Buffer.prototype.writeInt16LE = function writeInt16LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value & 0xff)
    this[offset + 1] = (value >>> 8)
  } else {
    objectWriteUInt16(this, value, offset, true)
  }
  return offset + 2
}

Buffer.prototype.writeInt16BE = function writeInt16BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 8)
    this[offset + 1] = (value & 0xff)
  } else {
    objectWriteUInt16(this, value, offset, false)
  }
  return offset + 2
}

Buffer.prototype.writeInt32LE = function writeInt32LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value & 0xff)
    this[offset + 1] = (value >>> 8)
    this[offset + 2] = (value >>> 16)
    this[offset + 3] = (value >>> 24)
  } else {
    objectWriteUInt32(this, value, offset, true)
  }
  return offset + 4
}

Buffer.prototype.writeInt32BE = function writeInt32BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)
  if (value < 0) value = 0xffffffff + value + 1
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 24)
    this[offset + 1] = (value >>> 16)
    this[offset + 2] = (value >>> 8)
    this[offset + 3] = (value & 0xff)
  } else {
    objectWriteUInt32(this, value, offset, false)
  }
  return offset + 4
}

function checkIEEE754 (buf, value, offset, ext, max, min) {
  if (offset + ext > buf.length) throw new RangeError('Index out of range')
  if (offset < 0) throw new RangeError('Index out of range')
}

function writeFloat (buf, value, offset, littleEndian, noAssert) {
  if (!noAssert) {
    checkIEEE754(buf, value, offset, 4, 3.4028234663852886e+38, -3.4028234663852886e+38)
  }
  ieee754.write(buf, value, offset, littleEndian, 23, 4)
  return offset + 4
}

Buffer.prototype.writeFloatLE = function writeFloatLE (value, offset, noAssert) {
  return writeFloat(this, value, offset, true, noAssert)
}

Buffer.prototype.writeFloatBE = function writeFloatBE (value, offset, noAssert) {
  return writeFloat(this, value, offset, false, noAssert)
}

function writeDouble (buf, value, offset, littleEndian, noAssert) {
  if (!noAssert) {
    checkIEEE754(buf, value, offset, 8, 1.7976931348623157E+308, -1.7976931348623157E+308)
  }
  ieee754.write(buf, value, offset, littleEndian, 52, 8)
  return offset + 8
}

Buffer.prototype.writeDoubleLE = function writeDoubleLE (value, offset, noAssert) {
  return writeDouble(this, value, offset, true, noAssert)
}

Buffer.prototype.writeDoubleBE = function writeDoubleBE (value, offset, noAssert) {
  return writeDouble(this, value, offset, false, noAssert)
}

// copy(targetBuffer, targetStart=0, sourceStart=0, sourceEnd=buffer.length)
Buffer.prototype.copy = function copy (target, targetStart, start, end) {
  if (!start) start = 0
  if (!end && end !== 0) end = this.length
  if (targetStart >= target.length) targetStart = target.length
  if (!targetStart) targetStart = 0
  if (end > 0 && end < start) end = start

  // Copy 0 bytes; we're done
  if (end === start) return 0
  if (target.length === 0 || this.length === 0) return 0

  // Fatal error conditions
  if (targetStart < 0) {
    throw new RangeError('targetStart out of bounds')
  }
  if (start < 0 || start >= this.length) throw new RangeError('sourceStart out of bounds')
  if (end < 0) throw new RangeError('sourceEnd out of bounds')

  // Are we oob?
  if (end > this.length) end = this.length
  if (target.length - targetStart < end - start) {
    end = target.length - targetStart + start
  }

  var len = end - start
  var i

  if (this === target && start < targetStart && targetStart < end) {
    // descending copy from end
    for (i = len - 1; i >= 0; --i) {
      target[i + targetStart] = this[i + start]
    }
  } else if (len < 1000 || !Buffer.TYPED_ARRAY_SUPPORT) {
    // ascending copy from start
    for (i = 0; i < len; ++i) {
      target[i + targetStart] = this[i + start]
    }
  } else {
    Uint8Array.prototype.set.call(
      target,
      this.subarray(start, start + len),
      targetStart
    )
  }

  return len
}

// Usage:
//    buffer.fill(number[, offset[, end]])
//    buffer.fill(buffer[, offset[, end]])
//    buffer.fill(string[, offset[, end]][, encoding])
Buffer.prototype.fill = function fill (val, start, end, encoding) {
  // Handle string cases:
  if (typeof val === 'string') {
    if (typeof start === 'string') {
      encoding = start
      start = 0
      end = this.length
    } else if (typeof end === 'string') {
      encoding = end
      end = this.length
    }
    if (val.length === 1) {
      var code = val.charCodeAt(0)
      if (code < 256) {
        val = code
      }
    }
    if (encoding !== undefined && typeof encoding !== 'string') {
      throw new TypeError('encoding must be a string')
    }
    if (typeof encoding === 'string' && !Buffer.isEncoding(encoding)) {
      throw new TypeError('Unknown encoding: ' + encoding)
    }
  } else if (typeof val === 'number') {
    val = val & 255
  }

  // Invalid ranges are not set to a default, so can range check early.
  if (start < 0 || this.length < start || this.length < end) {
    throw new RangeError('Out of range index')
  }

  if (end <= start) {
    return this
  }

  start = start >>> 0
  end = end === undefined ? this.length : end >>> 0

  if (!val) val = 0

  var i
  if (typeof val === 'number') {
    for (i = start; i < end; ++i) {
      this[i] = val
    }
  } else {
    var bytes = Buffer.isBuffer(val)
      ? val
      : utf8ToBytes(new Buffer(val, encoding).toString())
    var len = bytes.length
    for (i = 0; i < end - start; ++i) {
      this[i + start] = bytes[i % len]
    }
  }

  return this
}

// HELPER FUNCTIONS
// ================

var INVALID_BASE64_RE = /[^+\/0-9A-Za-z-_]/g

function base64clean (str) {
  // Node strips out invalid characters like \n and \t from the string, base64-js does not
  str = stringtrim(str).replace(INVALID_BASE64_RE, '')
  // Node converts strings with length < 2 to ''
  if (str.length < 2) return ''
  // Node allows for non-padded base64 strings (missing trailing ===), base64-js does not
  while (str.length % 4 !== 0) {
    str = str + '='
  }
  return str
}

function stringtrim (str) {
  if (str.trim) return str.trim()
  return str.replace(/^\s+|\s+$/g, '')
}

function toHex (n) {
  if (n < 16) return '0' + n.toString(16)
  return n.toString(16)
}

function utf8ToBytes (string, units) {
  units = units || Infinity
  var codePoint
  var length = string.length
  var leadSurrogate = null
  var bytes = []

  for (var i = 0; i < length; ++i) {
    codePoint = string.charCodeAt(i)

    // is surrogate component
    if (codePoint > 0xD7FF && codePoint < 0xE000) {
      // last char was a lead
      if (!leadSurrogate) {
        // no lead yet
        if (codePoint > 0xDBFF) {
          // unexpected trail
          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
          continue
        } else if (i + 1 === length) {
          // unpaired lead
          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
          continue
        }

        // valid lead
        leadSurrogate = codePoint

        continue
      }

      // 2 leads in a row
      if (codePoint < 0xDC00) {
        if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
        leadSurrogate = codePoint
        continue
      }

      // valid surrogate pair
      codePoint = (leadSurrogate - 0xD800 << 10 | codePoint - 0xDC00) + 0x10000
    } else if (leadSurrogate) {
      // valid bmp char, but last char was a lead
      if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
    }

    leadSurrogate = null

    // encode utf8
    if (codePoint < 0x80) {
      if ((units -= 1) < 0) break
      bytes.push(codePoint)
    } else if (codePoint < 0x800) {
      if ((units -= 2) < 0) break
      bytes.push(
        codePoint >> 0x6 | 0xC0,
        codePoint & 0x3F | 0x80
      )
    } else if (codePoint < 0x10000) {
      if ((units -= 3) < 0) break
      bytes.push(
        codePoint >> 0xC | 0xE0,
        codePoint >> 0x6 & 0x3F | 0x80,
        codePoint & 0x3F | 0x80
      )
    } else if (codePoint < 0x110000) {
      if ((units -= 4) < 0) break
      bytes.push(
        codePoint >> 0x12 | 0xF0,
        codePoint >> 0xC & 0x3F | 0x80,
        codePoint >> 0x6 & 0x3F | 0x80,
        codePoint & 0x3F | 0x80
      )
    } else {
      throw new Error('Invalid code point')
    }
  }

  return bytes
}

function asciiToBytes (str) {
  var byteArray = []
  for (var i = 0; i < str.length; ++i) {
    // Node's code seems to be doing this and not & 0x7F..
    byteArray.push(str.charCodeAt(i) & 0xFF)
  }
  return byteArray
}

function utf16leToBytes (str, units) {
  var c, hi, lo
  var byteArray = []
  for (var i = 0; i < str.length; ++i) {
    if ((units -= 2) < 0) break

    c = str.charCodeAt(i)
    hi = c >> 8
    lo = c % 256
    byteArray.push(lo)
    byteArray.push(hi)
  }

  return byteArray
}

function base64ToBytes (str) {
  return base64.toByteArray(base64clean(str))
}

function blitBuffer (src, dst, offset, length) {
  for (var i = 0; i < length; ++i) {
    if ((i + offset >= dst.length) || (i >= src.length)) break
    dst[i + offset] = src[i]
  }
  return i
}

function isnan (val) {
  return val !== val // eslint-disable-line no-self-compare
}

/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(50)))

/***/ }),
/* 50 */
/***/ (function(module, exports) {

var g;

// This works in non-strict mode
g = (function() {
	return this;
})();

try {
	// This works if eval is allowed (see CSP)
	g = g || new Function("return this")();
} catch (e) {
	// This works if the window reference is available
	if (typeof window === "object") g = window;
}

// g can still be undefined, but nothing to do about it...
// We return undefined, instead of nothing here, so it's
// easier to handle this case. if(!global) { ...}

module.exports = g;


/***/ }),
/* 51 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


exports.byteLength = byteLength
exports.toByteArray = toByteArray
exports.fromByteArray = fromByteArray

var lookup = []
var revLookup = []
var Arr = typeof Uint8Array !== 'undefined' ? Uint8Array : Array

var code = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'
for (var i = 0, len = code.length; i < len; ++i) {
  lookup[i] = code[i]
  revLookup[code.charCodeAt(i)] = i
}

// Support decoding URL-safe base64 strings, as Node.js does.
// See: https://en.wikipedia.org/wiki/Base64#URL_applications
revLookup['-'.charCodeAt(0)] = 62
revLookup['_'.charCodeAt(0)] = 63

function getLens (b64) {
  var len = b64.length

  if (len % 4 > 0) {
    throw new Error('Invalid string. Length must be a multiple of 4')
  }

  // Trim off extra bytes after placeholder bytes are found
  // See: https://github.com/beatgammit/base64-js/issues/42
  var validLen = b64.indexOf('=')
  if (validLen === -1) validLen = len

  var placeHoldersLen = validLen === len
    ? 0
    : 4 - (validLen % 4)

  return [validLen, placeHoldersLen]
}

// base64 is 4/3 + up to two characters of the original data
function byteLength (b64) {
  var lens = getLens(b64)
  var validLen = lens[0]
  var placeHoldersLen = lens[1]
  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen
}

function _byteLength (b64, validLen, placeHoldersLen) {
  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen
}

function toByteArray (b64) {
  var tmp
  var lens = getLens(b64)
  var validLen = lens[0]
  var placeHoldersLen = lens[1]

  var arr = new Arr(_byteLength(b64, validLen, placeHoldersLen))

  var curByte = 0

  // if there are placeholders, only get up to the last complete 4 chars
  var len = placeHoldersLen > 0
    ? validLen - 4
    : validLen

  var i
  for (i = 0; i < len; i += 4) {
    tmp =
      (revLookup[b64.charCodeAt(i)] << 18) |
      (revLookup[b64.charCodeAt(i + 1)] << 12) |
      (revLookup[b64.charCodeAt(i + 2)] << 6) |
      revLookup[b64.charCodeAt(i + 3)]
    arr[curByte++] = (tmp >> 16) & 0xFF
    arr[curByte++] = (tmp >> 8) & 0xFF
    arr[curByte++] = tmp & 0xFF
  }

  if (placeHoldersLen === 2) {
    tmp =
      (revLookup[b64.charCodeAt(i)] << 2) |
      (revLookup[b64.charCodeAt(i + 1)] >> 4)
    arr[curByte++] = tmp & 0xFF
  }

  if (placeHoldersLen === 1) {
    tmp =
      (revLookup[b64.charCodeAt(i)] << 10) |
      (revLookup[b64.charCodeAt(i + 1)] << 4) |
      (revLookup[b64.charCodeAt(i + 2)] >> 2)
    arr[curByte++] = (tmp >> 8) & 0xFF
    arr[curByte++] = tmp & 0xFF
  }

  return arr
}

function tripletToBase64 (num) {
  return lookup[num >> 18 & 0x3F] +
    lookup[num >> 12 & 0x3F] +
    lookup[num >> 6 & 0x3F] +
    lookup[num & 0x3F]
}

function encodeChunk (uint8, start, end) {
  var tmp
  var output = []
  for (var i = start; i < end; i += 3) {
    tmp =
      ((uint8[i] << 16) & 0xFF0000) +
      ((uint8[i + 1] << 8) & 0xFF00) +
      (uint8[i + 2] & 0xFF)
    output.push(tripletToBase64(tmp))
  }
  return output.join('')
}

function fromByteArray (uint8) {
  var tmp
  var len = uint8.length
  var extraBytes = len % 3 // if we have 1 byte left, pad 2 bytes
  var parts = []
  var maxChunkLength = 16383 // must be multiple of 3

  // go through the array every three bytes, we'll deal with trailing stuff later
  for (var i = 0, len2 = len - extraBytes; i < len2; i += maxChunkLength) {
    parts.push(encodeChunk(uint8, i, (i + maxChunkLength) > len2 ? len2 : (i + maxChunkLength)))
  }

  // pad the end with zeros, but make sure to not forget the extra bytes
  if (extraBytes === 1) {
    tmp = uint8[len - 1]
    parts.push(
      lookup[tmp >> 2] +
      lookup[(tmp << 4) & 0x3F] +
      '=='
    )
  } else if (extraBytes === 2) {
    tmp = (uint8[len - 2] << 8) + uint8[len - 1]
    parts.push(
      lookup[tmp >> 10] +
      lookup[(tmp >> 4) & 0x3F] +
      lookup[(tmp << 2) & 0x3F] +
      '='
    )
  }

  return parts.join('')
}


/***/ }),
/* 52 */
/***/ (function(module, exports) {

/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
exports.read = function (buffer, offset, isLE, mLen, nBytes) {
  var e, m
  var eLen = (nBytes * 8) - mLen - 1
  var eMax = (1 << eLen) - 1
  var eBias = eMax >> 1
  var nBits = -7
  var i = isLE ? (nBytes - 1) : 0
  var d = isLE ? -1 : 1
  var s = buffer[offset + i]

  i += d

  e = s & ((1 << (-nBits)) - 1)
  s >>= (-nBits)
  nBits += eLen
  for (; nBits > 0; e = (e * 256) + buffer[offset + i], i += d, nBits -= 8) {}

  m = e & ((1 << (-nBits)) - 1)
  e >>= (-nBits)
  nBits += mLen
  for (; nBits > 0; m = (m * 256) + buffer[offset + i], i += d, nBits -= 8) {}

  if (e === 0) {
    e = 1 - eBias
  } else if (e === eMax) {
    return m ? NaN : ((s ? -1 : 1) * Infinity)
  } else {
    m = m + Math.pow(2, mLen)
    e = e - eBias
  }
  return (s ? -1 : 1) * m * Math.pow(2, e - mLen)
}

exports.write = function (buffer, value, offset, isLE, mLen, nBytes) {
  var e, m, c
  var eLen = (nBytes * 8) - mLen - 1
  var eMax = (1 << eLen) - 1
  var eBias = eMax >> 1
  var rt = (mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0)
  var i = isLE ? 0 : (nBytes - 1)
  var d = isLE ? 1 : -1
  var s = value < 0 || (value === 0 && 1 / value < 0) ? 1 : 0

  value = Math.abs(value)

  if (isNaN(value) || value === Infinity) {
    m = isNaN(value) ? 1 : 0
    e = eMax
  } else {
    e = Math.floor(Math.log(value) / Math.LN2)
    if (value * (c = Math.pow(2, -e)) < 1) {
      e--
      c *= 2
    }
    if (e + eBias >= 1) {
      value += rt / c
    } else {
      value += rt * Math.pow(2, 1 - eBias)
    }
    if (value * c >= 2) {
      e++
      c /= 2
    }

    if (e + eBias >= eMax) {
      m = 0
      e = eMax
    } else if (e + eBias >= 1) {
      m = ((value * c) - 1) * Math.pow(2, mLen)
      e = e + eBias
    } else {
      m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen)
      e = 0
    }
  }

  for (; mLen >= 8; buffer[offset + i] = m & 0xff, i += d, m /= 256, mLen -= 8) {}

  e = (e << mLen) | m
  eLen += mLen
  for (; eLen > 0; buffer[offset + i] = e & 0xff, i += d, e /= 256, eLen -= 8) {}

  buffer[offset + i - d] |= s * 128
}


/***/ }),
/* 53 */
/***/ (function(module, exports) {

var toString = {}.toString;

module.exports = Array.isArray || function (arr) {
  return toString.call(arr) == '[object Array]';
};


/***/ })
/******/ ]);
//# sourceMappingURL=baseControllers.cjs.js.map